<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="https://codefug.github.io/_next/static/media/518331124efecf5c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/images/logos/toss.png"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240731004520.png"/><link rel="preload" as="image" href="/images/2024-09-14/context%20api%EB%A5%BC%20%ED%99%9C%EC%9A%A9%ED%95%9C%20%EB%AA%A8%EB%8B%AC.png"/><link rel="preload" as="image" href="/images/2024-09-14/context%20api%EB%A5%BC%20%ED%99%9C%EC%9A%A9%ED%95%9C%20%EB%AA%A8%EB%8B%AC%20profiler.png"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240828112132.png"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240914114250.png"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240828112816.png"/><link rel="preload" as="image" href="/images/2024-09-14/%EA%B2%8C%EC%8B%9C%EA%B8%80%20%EC%B6%94%EA%B0%80.gif"/><link rel="stylesheet" href="https://codefug.github.io/_next/static/css/2995ecc03dd1487c.css" data-precedence="next"/><link rel="stylesheet" href="https://codefug.github.io/_next/static/css/7b1838e6bdc2260c.css" data-precedence="next"/><link rel="stylesheet" href="https://codefug.github.io/_next/static/css/fc37ac2b1a278e8c.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="https://codefug.github.io/_next/static/chunks/webpack-cb9a9adc3ea1ef6e.js"/><script src="https://codefug.github.io/_next/static/chunks/96e220d1-2531cf7c679f7c43.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/770-52cce3cb203b2422.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/main-app-9f1a6571a5a98ceb.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/299-20a67a2580c87e66.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/971-96e75ab7e09e6508.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/70-d82343500dd0d9ac.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/565-101a78ce724b5236.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/layout-7a37aaf52f8545c9.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/not-found-8b0af7c225bbe321.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/posts/%5Bid%5D/layout-6a37c5d18e0b4ffc.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/posts/%5Bid%5D/page-382b4da1c4390447.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/global-error-e65e17ac78cfa06a.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=undefined" as="script"/><meta name="next-size-adjust" content=""/><title>Codefug Blog</title><meta name="description" content="project experiences and development notes"/><meta property="og:title" content="Codefug Blog"/><meta property="og:description" content="project experiences and development notes"/><meta property="og:url" content="https://codefug-blog.vercel.app"/><meta property="og:image" content="http://localhost:3000/images/main-logo.png"/><meta property="og:image:alt" content="Codefug Blog"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Codefug Blog"/><meta name="twitter:description" content="project experiences and development notes"/><meta name="twitter:image" content="http://localhost:3000/images/main-logo.png"/><meta name="twitter:image:alt" content="Codefug Blog"/><link rel="icon" href="/icon.ico?f00882ffa3186f37" type="image/x-icon" sizes="16x16"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="https://codefug.github.io/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_7ee20e antialiased"><script>((e,t,r,n,i,o,a,s)=>{let l=document.documentElement,u=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&o?i.map(e=>o[e]||e):i;r?(l.classList.remove(...n),l.classList.add(o&&o[t]?o[t]:t)):l.setAttribute(e,t)}),r=t,s&&u.includes(r)&&(l.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=a&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div style="--sidebar-width:16rem;--sidebar-width-icon:3rem" class="group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar"><div class="group peer hidden text-sidebar-foreground md:block" data-state="collapsed" data-collapsible="offcanvas" data-variant="sidebar" data-side="left"><div class="relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-[--sidebar-width-icon]"></div><div class="fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l"><div data-sidebar="sidebar" class="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"><div dir="ltr" class="relative overflow-hidden h-full w-full overflow-y-auto" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" class="h-full w-full rounded-[inherit]" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div data-sidebar="content" class="flex min-h-0 flex-1 flex-col overflow-auto group-data-[collapsible=icon]:overflow-hidden group relative gap-0"><div class="absolute h-[150px] w-full bg-primary"></div><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 mb-2 mt-4 flex justify-center px-4 text-sm font-bold text-gray-400 group-hover:text-white">Codefug</div><div data-sidebar="group-content" class="w-full text-sm flex min-h-full flex-col items-center px-2"><span class="relative flex shrink-0 overflow-hidden rounded-full h-40 w-40"><span class="flex h-full w-full items-center justify-center rounded-full bg-muted group-hover:text-black group-hover:dark:text-white">이승현</span></span><h1 class="mt-4 text-center text-lg font-bold text-gray-400 group-hover:text-black dark:text-gray-500 group-hover:dark:text-white">이승현</h1><p class="text-sm text-gray-400 group-hover:text-black dark:text-gray-500 group-hover:dark:text-white">Web Frontend Developer</p></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«Rbcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">javascript<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«Rbcplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«Rjcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">kkom-kkom<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«Rjcplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«Rrcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">gheuppay<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«Rrcplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«R13cplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">reactdeepdive<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«R13cplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«R1bcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">react<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«R1bcplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«R1jcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">web<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«R1jcplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«R1rcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">nextjs<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«R1rcplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«R23cplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">typescript<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«R23cplb»" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-«R2bcplb»" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">fandomk<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-«R2bcplb»" hidden=""></div></div></div><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-sidebar="group-content" class="w-full text-sm"><ul data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-1"><li data-sidebar="menu-item" class="group/menu-item relative"><a class="text-gray-400 hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm" href="https://www.figma.com/proto/KSWARGDkXi9Wt8ARq2uGCa/leeseounghyun-resume?node-id=401-2&amp;node-type=canvas&amp;t=z2H9bL74afXrrgPS-1&amp;scaling=min-zoom&amp;content-scaling=fixed&amp;page-id=0%3A1" target="_blank" data-sidebar="menu-button" data-size="default" data-active="false">Portfolio</a></li><li data-sidebar="menu-item" class="group/menu-item relative"><a class="text-gray-400 hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm" data-sidebar="menu-button" data-size="default" data-active="false" href="/about">About</a></li><li data-sidebar="menu-item" class="group/menu-item relative"><a class="text-gray-400 hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm" data-sidebar="menu-button" data-size="default" data-active="false" href="/search">Search</a></li></ul></div></div></div><div data-sidebar="footer" class="flex flex-col gap-2 p-2"></div></div></div></div></div></div></div><style>
:root {
  --bprogress-color: #1f1d80;
  --bprogress-height: 4px;
  --bprogress-spinner-size: 18px;
  --bprogress-spinner-animation-duration: 400ms;
  --bprogress-spinner-border-size: 2px;
  --bprogress-box-shadow: 0 0 10px #1f1d80, 0 0 5px #1f1d80;
  --bprogress-z-index: 99999;
  --bprogress-spinner-top: 15px;
  --bprogress-spinner-bottom: auto;
  --bprogress-spinner-right: 15px;
  --bprogress-spinner-left: auto;
}

.bprogress {
  width: 0;
  height: 0;
  pointer-events: none;
  z-index: var(--bprogress-z-index);
}

.bprogress .bar {
  background: var(--bprogress-color);
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
}

/* Fancy blur effect */
.bprogress .peg {
  display: block;
  position: absolute;
  right: 0;
  width: 100px;
  height: 100%;
  box-shadow: var(--bprogress-box-shadow);
  opacity: 1.0;
  transform: rotate(3deg) translate(0px, -4px);
}

/* Remove these to get rid of the spinner */
.bprogress .spinner {
  display: block;
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: var(--bprogress-spinner-top);
  bottom: var(--bprogress-spinner-bottom);
  right: var(--bprogress-spinner-right);
  left: var(--bprogress-spinner-left);
}

.bprogress .spinner-icon {
  width: var(--bprogress-spinner-size);
  height: var(--bprogress-spinner-size);
  box-sizing: border-box;
  border: solid var(--bprogress-spinner-border-size) transparent;
  border-top-color: var(--bprogress-color);
  border-left-color: var(--bprogress-color);
  border-radius: 50%;
  -webkit-animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
  animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
}

.bprogress-custom-parent {
  overflow: hidden;
  position: relative;
}

.bprogress-custom-parent .bprogress .spinner,
.bprogress-custom-parent .bprogress .bar {
  position: absolute;
}

.bprogress .indeterminate {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
  overflow: hidden;
}

.bprogress .indeterminate .inc,
.bprogress .indeterminate .dec {
  position: absolute;
  top: 0;
  height: 100%;
  background-color: var(--bprogress-color);
}

.bprogress .indeterminate .inc {
  animation: bprogress-indeterminate-increase 2s infinite;
}

.bprogress .indeterminate .dec {
  animation: bprogress-indeterminate-decrease 2s 0.5s infinite;
}

@-webkit-keyframes bprogress-spinner {
  0%   { -webkit-transform: rotate(0deg); transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }
}

@keyframes bprogress-spinner {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes bprogress-indeterminate-increase {
  from { left: -5%; width: 5%; }
  to { left: 130%; width: 100%; }
}

@keyframes bprogress-indeterminate-decrease {
  from { left: -80%; width: 80%; }
  to { left: 110%; width: 10%; }
}
</style><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><main class="flex min-h-screen flex-col transition-[width] duration-200 ease-linear w-full"><header class="sticky left-0 right-0 top-0 z-30 transform bg-background transition-transform duration-300 translate-y-0"><div class="flex items-center justify-between gap-6 py-4"><section class="flex items-center gap-4"><div class="ml-2"><button class="flex h-7 w-7 items-center justify-center rounded-md hover:bg-accent hover:text-black hover:dark:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left-open"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path><path d="m14 9 3 3-3 3"></path></svg></button></div><a class="flex flex-shrink-0 items-center gap-2 hover:opacity-95 hover:drop-shadow-lg" href="/"><img alt="logo" loading="lazy" width="28" height="28" decoding="async" data-nimg="1" style="color:transparent" src="/images/main-logo.png"/><div class="hidden whitespace-nowrap text-lg font-bold text-black dark:text-white md:block">Codefug Blog</div></a></section><section class="flex items-center gap-4 text-sm font-semibold md:text-base"><nav class="flex items-center gap-4 text-sm font-semibold md:text-base"><a href="https://www.figma.com/proto/KSWARGDkXi9Wt8ARq2uGCa/leeseounghyun-resume?node-id=401-2&amp;node-type=canvas&amp;t=z2H9bL74afXrrgPS-1&amp;scaling=min-zoom&amp;content-scaling=fixed&amp;page-id=0%3A1" target="_blank" class="text-gray-400 hover:text-black hover:underline hover:drop-shadow-lg dark:hover:text-white">Portfolio</a><a class="text-gray-400 hover:text-black hover:underline hover:drop-shadow-lg dark:hover:text-white" href="/about">About</a><a class="text-gray-400 hover:text-black hover:underline hover:drop-shadow-lg dark:hover:text-white" href="/search"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-5 w-5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></a></nav><button type="button" role="switch" aria-checked="false" data-state="unchecked" value="on" class="peer inline-flex h-7 w-16 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input"><span data-state="unchecked" class="pointer-events-none block h-6 w-6 rounded-full bg-theme-icon bg-center shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-[2.25rem] data-[state=unchecked]:translate-x-0 data-[state=checked]:bg-moon data-[state=unchecked]:bg-sun"></span></button><input type="checkbox" aria-hidden="true" style="transform:translateX(-100%);position:absolute;pointer-events:none;opacity:0;margin:0" tabindex="-1" value="on"/></section></div><div class="h-2 origin-left bg-primary" style="transform:scaleX(0)"></div></header><div class="mx-auto w-full max-w-[1400px] flex-1 px-4"><!--$--><div class="prose mx-auto overflow-auto dark:prose-invert"><section><header class="mb-8"><div class="relative mb-6 h-[300px] w-full overflow-hidden rounded-xl sm:h-[400px] md:h-[450px]"><img alt="(꼼꼼 프로젝트) toss slash 분석, zustand와 연결된 커스텀 overlay 훅 구현" decoding="async" data-nimg="fill" class="object-cover object-center transition-transform duration-500 hover:scale-105" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/images/logos/toss.png"/><div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/70"></div><div class="absolute left-4 top-4 flex flex-wrap gap-2 sm:left-6 sm:top-6"><div class="inline-flex items-center rounded-md border px-2.5 py-0.5 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-white/90 text-xs font-medium text-gray-800 hover:bg-white sm:text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag mr-1 h-3 w-3"><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"></path><circle cx="7.5" cy="7.5" r=".5" fill="currentColor"></circle></svg> <!-- -->kkom-kkom</div></div></div><div class="mb-6 space-y-4"><h1 class="mb-0 text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-50 sm:text-4xl md:text-5xl">(꼼꼼 프로젝트) toss slash 분석, zustand와 연결된 커스텀 overlay 훅 구현</h1><div class="flex items-center justify-end gap-4 text-sm text-gray-600 dark:text-gray-400"><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-days mr-2 h-4 w-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path><path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path><path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path></svg><time dateTime="2024-09-14">2024-09-14</time></div></div><p class="text-lg leading-relaxed text-gray-600 dark:text-gray-300 md:text-xl">stacking context, compound pattern, 전역 상태를 활용한다는 것의 의미, 토스 개발자 실력 흡수하기</p></div><div class="border-b border-gray-200 dark:border-gray-800"></div></header><section class="lg:flex lg:items-baseline"><section class="max-w-full"><h1 id="0"><mark style="background:#FF5582A6">배경</mark></h1>
<p>이번 프로젝트에는 정말 많은 종류의 모달이 존재한다.</p>
<p><img src="/images/2024-09-14/Pasted%20image%2020240731004520.png" alt=""/></p>
<p>심지어 디자인 시안이 아직 다 완성되지 않은 상황이었기에 더 추가될지도 모르는 상황이었다.</p>
<h1 id="1"><mark style="background:#FF5582A6">구현</mark></h1>
<h2 id="2"><mark style="background:#FFB86CA6">상황 분석</mark></h2>
<p>모달들이 전부 조금씩 다르게 생겼으나 공통적으로 존재하는 것들을 생각해보았다.</p>
<ol>
<li>padding과 border-radius</li>
<li>backdrop의 존재</li>
<li>background-color</li>
<li>주제, 설명의 폰트 같은 겹치는 UI 요소들</li>
</ol>
<p>1,2,3 의 경우 &quot;모달&quot; 이라는 컴포넌트를 만들어서 조립할 수 있게 만들어주고</p>
<p>4 의 경우 자주 쓰이는 경우 Compound Pattern으로 묶어서 컴포넌트 간의 결합성을 높히게 되긴 하지만 조립하는 쪽에서 쉽게 할 수 있도록 구현하는게 좋다고 생각하였다.</p>
<p>컴포넌트 자체의 구현 방식은 해결되었고 이제 렌더링은 어떻게 시킬지 생각해야 했다.</p>
<h2 id="3"><mark style="background:#FFB86CA6">렌더링 방법</mark></h2>
<h3 id="4"><mark style="background:#FFF3A3A6">전역 상태 관리</mark></h3>
<p>부끄럽지만 기존에 모달을 구현할 때는 마감 기한에 밀려서 좋은 코드를 생각하지 못했던 것 같다...</p>
<p>아래는 원래 사용하던 방식이다. context api를 활용하여 모달이 열리고 닫히고를 구현해놓은 모달이다.</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// 일종의 팩토리 패턴이다.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Modal</span>(<span class="hljs-params">{ children, button }: <span class="hljs-title class_">ModalProps</span></span>) {
  <span class="hljs-keyword">const</span> [isModalOpen, setIsModalOpen] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> modalRef = useClickOutside&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setIsModalOpen</span>(<span class="hljs-literal">false</span>));

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleOpen</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-title function_">setIsModalOpen</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClose</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-title function_">setIsModalOpen</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModalContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">handleClose</span>, <span class="hljs-attr">isModalOpen</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleOpen}</span>&gt;</span>{button}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
      {isModalOpen &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;fixed inset-0 z-40 flex items-end bg-black bg-opacity-50 md:items-center md:justify-center&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{modalRef}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;bg-background-secondary z-50 w-full rounded-t-xl md:w-[384px] md:rounded-b-xl&quot;</span>
          &gt;</span>
            {children}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ModalContext.Provider</span>&gt;</span></span>
  );
}
</code></pre>
<p>이렇게 context api를 사용한 모달은</p>
<p><img src="/images/2024-09-14/context%20api%EB%A5%BC%20%ED%99%9C%EC%9A%A9%ED%95%9C%20%EB%AA%A8%EB%8B%AC.png" alt=""/></p>
<p>모달을 열었을 때 모달을 여는 버튼도 리렌더링된다.</p>
<p><img src="/images/2024-09-14/context%20api%EB%A5%BC%20%ED%99%9C%EC%9A%A9%ED%95%9C%20%EB%AA%A8%EB%8B%AC%20profiler.png" alt=""/></p>
<p>이는 어쩔수가 없는게 context가 결국 상위 컴포넌트에 있는 상태를 바꾸기 때문</p>
<p>개발자가 편해지긴 하지만 상태를 바꿔서 그 사이의 컴포넌트들이 리렌더링 되는 것을 막을 순 없음 ( 그래서 context api는 전역 상태 관리라기보단 전역 상태 주입이라고도 한다. )</p>
<p>이번 프로젝트에서 전역 상태 관리 라이브러리로 zustand을 세팅했으니 우선 이를 활용해서 만들어 보자 하고 고민을 시작했다.</p>
<h3 id="5"><mark style="background:#FFF3A3A6">toss slash</mark></h3>
<p>그러던 중 toss의 오픈 소스 라이브러리에 overlay를 다루는 훅이 있는 것을 발견했다.</p>
<p>overlay란 위에 까는 것을 의미하며 여기서는 화면 위에 화면을 올리는 것을 말한다.</p>
<p>즉, 모달 뿐만 아니라 사이드바, 토스트 등 존재하는 화면 위에 있는 컴포넌트도 overlay라고 한다.</p>
<h4 id="6"><mark style="background:#BBFABBA6">useOverlay 상세 분석</mark></h4>
<p><a href="https://github.com/toss/slash/blob/main/packages/react/use-overlay/src/useOverlay.ko.md">https://github.com/toss/slash/blob/main/packages/react/use-overlay/src/useOverlay.ko.md</a></p>
<h5 id="7"><mark style="background:#ABF7F7A6">OverlayProvider</mark></h5>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// OverlayProvider.tsx</span>
<span class="hljs-comment">/** <span class="hljs-doctag">@tossdocs</span>-ignore */</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, {
  createContext,
  <span class="hljs-title class_">PropsWithChildren</span>,
  <span class="hljs-title class_">ReactNode</span>,
  useCallback,
  useMemo,
  useState,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-comment">// context api로 저장</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">OverlayContext</span> = createContext&lt;{
  <span class="hljs-comment">// 마운트 되는지 안되는지 확인하는 context</span>
  <span class="hljs-title function_">mount</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">element</span>: <span class="hljs-title class_">ReactNode</span>): <span class="hljs-built_in">void</span>;
  <span class="hljs-title function_">unmount</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span>;
} | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
<span class="hljs-comment">// 배포 단계에서는</span>
<span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&quot;production&quot;</span>) {
  <span class="hljs-comment">// displayName을 설정</span>
  <span class="hljs-title class_">OverlayContext</span>.<span class="hljs-property">displayName</span> = <span class="hljs-string">&quot;OverlayContext&quot;</span>;
}

<span class="hljs-comment">// children을 받는 Provider 생성</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">OverlayProvider</span>(<span class="hljs-params">{ children }: <span class="hljs-title class_">PropsWithChildren</span></span>) {
  <span class="hljs-comment">// id와 컴포넌트를 저장하는 state 생성</span>
  <span class="hljs-keyword">const</span> [overlayById, setOverlayById] = useState&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">ReactNode</span>&gt;&gt;(
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
  );

  <span class="hljs-comment">// mount 함수 생성</span>
  <span class="hljs-keyword">const</span> mount = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">element</span>: <span class="hljs-title class_">ReactNode</span></span>) =&gt;</span> {
    <span class="hljs-comment">// mount를 계속 호출하지 않고 처음 마운트 될때만 호출 (useCallback)</span>
    <span class="hljs-title function_">setOverlayById</span>(<span class="hljs-function">(<span class="hljs-params">overlayById</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> cloned = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(overlayById);
      cloned.<span class="hljs-title function_">set</span>(id, element);
      <span class="hljs-keyword">return</span> cloned;
    });
  }, []);

  <span class="hljs-comment">// unmount 함수 생성</span>
  <span class="hljs-keyword">const</span> unmount = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
    <span class="hljs-comment">// unmount를 계속 호출하지 않고 처음 언마운트 될때만 호출 (useCallback)</span>
    <span class="hljs-title function_">setOverlayById</span>(<span class="hljs-function">(<span class="hljs-params">overlayById</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> cloned = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(overlayById);
      cloned.<span class="hljs-title function_">delete</span>(id);
      <span class="hljs-keyword">return</span> cloned;
    });
  }, []);

  <span class="hljs-comment">// context에 mount, unmount를 저장</span>
  <span class="hljs-keyword">const</span> context = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> ({ mount, unmount }), [mount, unmount]);

  <span class="hljs-comment">// context를 Context API를 활용해서 아래로 내리고 id와 element를 사용해서 컴포넌트를 렌더링</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OverlayContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{context}</span>&gt;</span>
      {children}
      {[...overlayById.entries()].map(([id, element]) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">React.Fragment</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>&gt;</span>{element}<span class="hljs-tag">&lt;/<span class="hljs-name">React.Fragment</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">OverlayContext.Provider</span>&gt;</span></span>
  );
}
</code></pre>
<p>OverlayProvider의 역할</p>
<ol>
<li>컴포넌트를 저장하는 상태를 갖고 context api로 바꿀 수 있게 전역으로 내려준다.</li>
<li>상태를 이용해서 컴포넌트를 열어놓는다. (비어져 있을 때는 열려있어도 아무것도 보이지 않는다.)</li>
</ol>
<blockquote>
<p>2024-11-29 추가</p>
<p>위 코드를 보면 <code>overlayById</code> 라는 상태에 <code>id:string</code>과 <code>element:ReactNode</code>를 <code>Map</code>의 요소로 넣어둔 후 <code>Provider</code> 내부에서 쓰는 것을 볼 수 있다.</p>
<p>이때 <code>Provider</code> 내부에서 <code>Fragment</code>의 <code>children</code>으로 <code>element:ReactNode</code>를 사용하는 것을 볼 수 있는데 이는 <code>element:ReactNode</code>가 <code>createElement(tag, props, ...children)</code> 이라는 함수이기 때문이다. ( 정확히는 <code>JSX.Element</code>이고 <code>ReactNode</code>는 <code>string, number</code> 등을 포함하는 좀 더 큰 개념이다. )</p>
<p>실제 <code>&lt;ComponentName/&gt;</code> 같은 <code>JSX.Element</code>은 <code>React</code> 내부적으로 <code>createElement</code> 함수의 실행으로 바뀌어서 JS 객체를 반환하고 더 나아가 이를 Fiber, Fiber Tree로 만든다.</p>
<p>우린 이 중간 단계를 직접 사용한 것이다. 그래서 overlayById 상태의 element를 컴포넌트를 사용하는 것처럼 <code>&lt;element key={id}/&gt;</code>로 사용할 수 없고 <code>children</code>으로써 사용해야 한다.</p>
</blockquote>
<h5 id="8"><mark style="background:#ABF7F7A6">useOverlay</mark></h5>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { useContext, useEffect, useMemo, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OverlayContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./OverlayProvider&quot;</span>;
<span class="hljs-comment">/** <span class="hljs-doctag">@tossdocs</span>-ignore */</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OverlayController</span>, <span class="hljs-title class_">OverlayControlRef</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./OverlayController&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CreateOverlayElement</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./types&quot;</span>;

<span class="hljs-keyword">let</span> elementId = <span class="hljs-number">1</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Options</span> {
  <span class="hljs-attr">exitOnUnmount</span>?: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useOverlay</span>(<span class="hljs-params">{ exitOnUnmount = <span class="hljs-literal">true</span> }: <span class="hljs-title class_">Options</span> = {}</span>) {
  <span class="hljs-comment">// overlayContext를 가져옴 (mount, unmount가 있음)</span>
  <span class="hljs-keyword">const</span> context = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">OverlayContext</span>);

  <span class="hljs-comment">// context가 없으면 에러 발생 (Provider 내부에서만 사용 가능)</span>
  <span class="hljs-keyword">if</span> (context == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;useOverlay is only available within OverlayProvider.&quot;</span>);
  }

  <span class="hljs-comment">// 비구조 할당으로 mount, unmount를 분리</span>
  <span class="hljs-keyword">const</span> { mount, unmount } = context;
  <span class="hljs-comment">// id를 저장하는 state 생성</span>
  <span class="hljs-keyword">const</span> [id] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">String</span>(elementId++));

  <span class="hljs-comment">// overlayRef를 생성, useImperativeHandle을 사용하여 close 함수를 제공</span>
  <span class="hljs-keyword">const</span> overlayRef = useRef&lt;<span class="hljs-title class_">OverlayControlRef</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">//  exitOnUnmount가 true일 때, 컴포넌트가 언마운트 될 때 unmount 실행</span>
    <span class="hljs-comment">//  exitOnUnmount가 false일 때, 컴포넌트가 언마운트 될 때 unmount 실행하지 않음, 직접 exit(unmount)를 호출해야 함</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (exitOnUnmount) {
        <span class="hljs-title function_">unmount</span>(id);
      }
    };
  }, [exitOnUnmount, id, unmount]);

  <span class="hljs-comment">// useMemo를 사용하여 객체를 캐싱</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useMemo</span>(
    <span class="hljs-function">() =&gt;</span> ({
      <span class="hljs-comment">// open, close, exit 함수를 반환</span>
      <span class="hljs-comment">// open: overlayElement를 받아서 mount 실행</span>
      <span class="hljs-comment">// close: overlayRef.current?.close() 실행</span>
      <span class="hljs-comment">// exit: unmount 실행</span>
      <span class="hljs-attr">open</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">overlayElement</span>: <span class="hljs-title class_">CreateOverlayElement</span></span>) =&gt;</span> {
        <span class="hljs-title function_">mount</span>(
          id,
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OverlayController</span>
            // <span class="hljs-attr">NOTE:</span> <span class="hljs-attr">state</span> <span class="hljs-attr">should</span> <span class="hljs-attr">be</span> <span class="hljs-attr">reset</span> <span class="hljs-attr">every</span> <span class="hljs-attr">time</span> <span class="hljs-attr">we</span> <span class="hljs-attr">open</span> <span class="hljs-attr">an</span> <span class="hljs-attr">overlay</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{Date.now()}</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{overlayRef}</span>
            <span class="hljs-attr">overlayElement</span>=<span class="hljs-string">{overlayElement}</span>
            <span class="hljs-attr">onExit</span>=<span class="hljs-string">{()</span> =&gt;</span> {
              unmount(id);
            }}
          /&gt;</span>,
        );
      },
      <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> {
        overlayRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">close</span>();
      },
      <span class="hljs-attr">exit</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">unmount</span>(id);
      },
    }),
    [id, mount, unmount],
  );
}
</code></pre>
<p>useOverlay의 역할</p>
<ol>
<li>context를 읽고 mount, unmount할 수 있는 함수 제공 (여기서 mount와 unmount는 메모리에 담는 것(전역 상태))</li>
<li>context 내부적으로 사용할 id 생성, 주입</li>
</ol>
<h5 id="9"><mark style="background:#ABF7F7A6">OverlayController</mark></h5>
<pre><code class="hljs language-tsx"><span class="hljs-comment">/** <span class="hljs-doctag">@tossdocs</span>-ignore */</span>
<span class="hljs-keyword">import</span> {
  forwardRef,
  <span class="hljs-title class_">Ref</span>,
  useCallback,
  useEffect,
  useImperativeHandle,
  useState,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CreateOverlayElement</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./types&quot;</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Props</span> {
  <span class="hljs-comment">// 결과물</span>
  <span class="hljs-attr">overlayElement</span>: <span class="hljs-title class_">CreateOverlayElement</span>;
  <span class="hljs-attr">onExit</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OverlayControlRef</span> {
  <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">OverlayController</span> = <span class="hljs-title function_">forwardRef</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">OverlayController</span>(<span class="hljs-params">
  { overlayElement: OverlayElement, onExit }: <span class="hljs-title class_">Props</span>,
  <span class="hljs-attr">ref</span>: <span class="hljs-title class_">Ref</span>&lt;<span class="hljs-title class_">OverlayControlRef</span>&gt;,
</span>) {
  <span class="hljs-comment">// 메모리가 아닌 실제 DOM에 렌더링되는지 여부</span>
  <span class="hljs-keyword">const</span> [isOpenOverlay, setIsOpenOverlay] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// DOM에서 Overlay를 닫는 함수</span>
  <span class="hljs-keyword">const</span> handleOverlayClose = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setIsOpenOverlay</span>(<span class="hljs-literal">false</span>), []);

  <span class="hljs-comment">// ref로 전달된 객체에 close 함수를 추가</span>
  <span class="hljs-title function_">useImperativeHandle</span>(ref, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">close</span>: handleOverlayClose };
  }, [handleOverlayClose]);

  <span class="hljs-comment">// 컴포넌트가 마운트되면 Overlay를 열기</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> requestAnimationFrame이 없으면 가끔 Open 애니메이션이 실행되지 않는다.</span>
    <span class="hljs-comment">// 브라우저에 다음 리페인트 전에 콜백 함수 호출을 가능하게 하는 메소드</span>
    <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">setIsOpenOverlay</span>(<span class="hljs-literal">true</span>);
    });
  }, []);

  <span class="hljs-comment">// OverlayElement를 렌더링</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OverlayElement</span>
      <span class="hljs-attr">isOpen</span>=<span class="hljs-string">{isOpenOverlay}</span>
      <span class="hljs-attr">close</span>=<span class="hljs-string">{handleOverlayClose}</span>
      <span class="hljs-attr">exit</span>=<span class="hljs-string">{onExit}</span>
    /&gt;</span></span>
  );
});
</code></pre>
<p>OverlayController의 역할</p>
<ol>
<li>실제 DOM에 Element를 렌더링</li>
<li>리페인트 전에 함수를 호출해서 애니메이션 처리 (requestAnimationFrame은 마이크로 큐처럼 본인의 큐를 갖고 실행되기 때문에 리페인트 전에 함수를 실행시킬 수 있다.)</li>
<li>useOverlay의 open으로 모달을 끄는 handler 올리기</li>
<li>Element 내리기</li>
</ol>
<h5 id="10"><mark style="background:#ABF7F7A6">전체 구조도</mark></h5>
<p>종합적으로 구조도를 구려보면 다음과 같다.</p>
<p><img src="/images/2024-09-14/Pasted%20image%2020240828112132.png" alt=""/></p>
<p>이를 통해 해결되는 점은</p>
<ol>
<li>z-index가 쌓임맥락으로 묻혀지지 않도록 영향이 가지않는 main 아래에 모달이 정의된다.</li>
<li>컴포넌트에서 모달 컴포넌트를 직접 주입할 수 있다.</li>
<li>같은 페이지에서 여러 모달이 나올 수 있고 동시에도 있을 수 있다.</li>
</ol>
<blockquote>
<p><strong>쌓임 맥락</strong>(stacking context)은 가상의 Z축을 사용한 HTML 요소의 3차원 개념화입니다. Z축은 사용자 기준이며, 사용자는 뷰포트 혹은 웹페이지를 바라보고 있을 것으로 가정합니다. 각각의 HTML 요소는 자신의 속성에 따른 우선순위를 사용해 3차원 공간을 차지합니다.
<img src="/images/2024-09-14/Pasted%20image%2020240914114250.png" alt=""/>
어렵게 되어 있지만 쉽게 말하자면 z-index는 부모의 z-index를 이길 수 없다는 것이다. 자신이 z-index: 6이더라도 부모가 4라면 부모 단에 있는 4보다 높은 요소들을 z-index로 이길 수 없다.
(<code>DIV #4는 z-index:6이지만 z-index:5인 DIV #1보다 뒤에 있다.</code>)</p>
</blockquote>
<h3 id="11"><mark style="background:#FFF3A3A6">프로젝트에 맞게 개선</mark></h3>
<p>분석이 끝난 후 관련된 공부를 다 한 나는 강해진 느낌이 들었다. 하핳..</p>
<p>프로젝트를 위해서 useOverlay에서 개선할 점을 생각해보니 다음과 같았다.</p>
<ol>
<li>전역 상태 주입에서 전역 상태 관리로 교체하는 것이 리렌더링 문제에서 벗어날 수 있다. 이번 프로젝트에서 전역 상태는 zustand를 사용하고 있기에 zustand로 깎아내는 작업이 필요하다.</li>
<li>slash의 라이브러리는 이전에 구현된 라이브러리 같았다. (React를 import 받고 있었음.) 현재 기준으로 어느정도 리팩토링을 하게 되면 가독성을 늘릴 수 있을 것이다. 간단하게는 컴포넌트의 id를 받는 부분에서 전역 변수를 지정해서 id를 넣어주고 있었는데 이는 react에서 id를 만들 때 쓰라고 만든 훅인 <code>useId</code>를 사용하여 리팩토링할 수 있는 식이다.</li>
<li>OverlayController 단은 마운트, 언마운트 관련해서 애니메이션 처리 (Framer-Motion의 AnimatePresense 같은)를 위해 exit, close로 따로 분리되어 있는데 이는 가독성을 해친다고 생각했다. 훅에 넣지 말고 모달, 사이드바 같은 컴포넌트를 만드는 부분에서 애니메이션 처리를 할 때 상태를 하나 만들어서 처리해도 된다고 생각했다. 기존 라이브러리에서도 이 부분 때문에 주석이 길게 되어 있는 것을 확인할 수 있었는데 개인적으로는 주석 없이도 잘 읽히는 코드가 더 좋은 것 같다. 우리 프로젝트에서는 마운트, 언마운트 시의 애니메이션에 큰 비중을 두지 않았기 때문에 들어내기로 했다.</li>
</ol>
<h4 id="12"><mark style="background:#BBFABBA6">useCustomOverlay 구조도</mark></h4>
<p><img src="/images/2024-09-14/Pasted%20image%2020240828112816.png" alt=""/></p>
<h5 id="13"><mark style="background:#ABF7F7A6">OverlayStore</mark></h5>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ReactNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { devtools } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand/middleware&quot;</span>;
<span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand/vanilla&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">OverlayState</span> = {
  <span class="hljs-title class_">ElementsInMemory</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">ReactNode</span>&gt;;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">OverlayActions</span> = {
  <span class="hljs-attr">mount</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">element</span>: <span class="hljs-title class_">ReactNode</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">unmount</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">OverlayStore</span> = <span class="hljs-title class_">OverlayState</span> &amp; <span class="hljs-title class_">OverlayActions</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> initOverlayStore = (): <span class="hljs-function"><span class="hljs-params">OverlayState</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> { <span class="hljs-title class_">ElementsInMemory</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>() };
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">defaultInitState</span>: <span class="hljs-title class_">OverlayState</span> = {
  <span class="hljs-title class_">ElementsInMemory</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createOverlayStore</span> = (<span class="hljs-params">
  <span class="hljs-attr">initState</span>: <span class="hljs-title class_">OverlayState</span> = defaultInitState,
</span>) =&gt; {
  <span class="hljs-keyword">return</span> createStore&lt;<span class="hljs-title class_">OverlayStore</span>&gt;()(
    <span class="hljs-title function_">devtools</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
      ...initState,
      <span class="hljs-attr">mount</span>: <span class="hljs-function">(<span class="hljs-params">id, element</span>) =&gt;</span> {
        <span class="hljs-title function_">set</span>(
          <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
            state.<span class="hljs-property">ElementsInMemory</span>.<span class="hljs-title function_">set</span>(id, element);
            <span class="hljs-keyword">return</span> { <span class="hljs-title class_">ElementsInMemory</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(state.<span class="hljs-property">ElementsInMemory</span>) };
          },
          <span class="hljs-literal">undefined</span>,
          <span class="hljs-string">&quot;mount&quot;</span>,
        );
      },
      <span class="hljs-attr">unmount</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
        <span class="hljs-title function_">set</span>(
          <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
            state.<span class="hljs-property">ElementsInMemory</span>.<span class="hljs-title function_">delete</span>(id);
            <span class="hljs-keyword">return</span> { <span class="hljs-title class_">ElementsInMemory</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(state.<span class="hljs-property">ElementsInMemory</span>) };
          },
          <span class="hljs-literal">undefined</span>,
          <span class="hljs-string">&quot;unmount&quot;</span>,
        );
      },
    })),
  );
};
</code></pre>
<p>zustand store 방식으로 함으로써 mount, unmount 관련된 로직을 store에 숨길수 있게 되었다. (로직 분리 굳)</p>
<h6 id="14"><mark style="background:#ADCCFFA6">트러블 슈팅</mark></h6>
<p>짧은 트러블 슈팅으로는 zustand에서는 shallow equal을 사용하여 상태의 변화를 감지하는데 delete만 지워서 리렌더링이 막 일어나게 되었었다.</p>
<p>데이터 변경시 return으로 새로운 Map을 넣어줘야 리렌더링이 정상적으로 일어난다.</p>
<h5 id="15"><mark style="background:#ABF7F7A6">OverlayStoreProvider</mark></h5>
<pre><code class="hljs language-ts"><span class="hljs-string">&quot;use client&quot;</span>;

<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">OverlayStore</span>,
  createOverlayStore,
  initOverlayStore,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/modal-store&quot;</span>;
<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">Fragment</span>,
  <span class="hljs-title class_">PropsWithChildren</span>,
  createContext,
  useContext,
  useRef,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { useStoreWithEqualityFn } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;zustand/traditional&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">OverlayStoreApi</span> = <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> createOverlayStore&gt;;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">OverlayStoreContext</span> = createContext&lt;<span class="hljs-title class_">OverlayStoreApi</span> | <span class="hljs-literal">undefined</span>&gt;(
  <span class="hljs-literal">undefined</span>,
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">OverlayStoreProvider</span> = (<span class="hljs-params">{ children }: <span class="hljs-title class_">PropsWithChildren</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> storeRef = useRef&lt;<span class="hljs-title class_">OverlayStoreApi</span>&gt;();
  <span class="hljs-keyword">if</span> (!storeRef.<span class="hljs-property">current</span>) {
    storeRef.<span class="hljs-property">current</span> = <span class="hljs-title function_">createOverlayStore</span>(<span class="hljs-title function_">initOverlayStore</span>());
  }
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OverlayStoreContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{storeRef.current}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">OverlayStoreContext.Provider</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">OverlayProvider</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">ElementsInMemory</span> = <span class="hljs-title function_">useOverlayStore</span>(<span class="hljs-function">(<span class="hljs-params">store</span>) =&gt;</span> store.<span class="hljs-property">ElementsInMemory</span>);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {[...ElementsInMemory.entries()].map(([id, element]) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Fragment</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>&gt;</span>{element}<span class="hljs-tag">&lt;/<span class="hljs-name">Fragment</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useOverlayStore = &lt;T,&gt;(
  <span class="hljs-attr">selector</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">store</span>: <span class="hljs-title class_">OverlayStore</span></span>) =&gt;</span> T,
): <span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> overlayStoreContext = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">OverlayStoreContext</span>);

  <span class="hljs-keyword">if</span> (!overlayStoreContext) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`useModalStore must be used within ModalStoreProvider`</span>);
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useStoreWithEqualityFn</span>(overlayStoreContext, selector);
};
</code></pre>
<p>OverlayStore와 연결된 컴포넌트이다. 쌓임 맥락을 해결하기 위해서 main 아래에 놓아야한다.</p>
<p>Map의 entries로 Map을 전개해서 안에 있는 컴포넌트들을 꺼내주는데 순차적으로 렌더링되기 때문에 뒤에 구현되는 컴포넌트가 쌓임 맥락에서 이기게 되어 덮어써지게 된다.</p>
<h5 id="16"><mark style="background:#ABF7F7A6">useCustomOverlay</mark></h5>
<pre><code class="hljs language-ts"><span class="hljs-string">&quot;use client&quot;</span>;

<span class="hljs-keyword">import</span> { useOverlayStore } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/providers/modal-store-provider&quot;</span>;
<span class="hljs-keyword">import</span> { useId, useMemo } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CreateOverlayElement</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./types&quot;</span>;

<span class="hljs-comment">/**
 * Zustand와 결합하여 루트 아래에 컴포넌트를 렌더링하는 훅입니다.
 * close를 prop으로 받는 컴포넌트를 렌더링합니다.
 * Modal 컴포넌트와 같이 close 함수를 prop으로 받는 컴포넌트를 만들어서 넣어주시면 됩니다.
 * 해당 컴포넌트는 루트 아래로 띄워주기만 합니다. 
 * 
 * 모달 안에 다른 CustomOverlay를 만들어서 모달을 하나 더 띄우셔도 됩니다. 
 * 단,useOutSideClick은 따로 처리해주셔야 합니다.
 * 
 * <span class="hljs-doctag">@author</span> 이승현
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">overlayElement</span>
 * <span class="hljs-doctag">@returns</span> 루트 아래에 해당 컴포넌트가 렌더링됩니다.
 *  const overlay1 = useCustomOverlay(({ close }) =&gt; (
    &lt;Modal close={close}&gt;
      &lt;Modal.HeaderWithClose /&gt;
      &lt;Modal.Title&gt;제목&lt;/Modal.Title&gt;
      &lt;Modal.Description&gt;난 예시다.&lt;/Modal.Description&gt;
      &lt;Modal.Description&gt;해냈다.&lt;/Modal.Description&gt;
    &lt;/Modal&gt;
  ));
  return (
    &lt;button onClick={overlay1.open}&gt;overlay1에 넣은 컴포넌트를 여는 버튼/button&gt;
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useCustomOverlay</span>(<span class="hljs-params"><span class="hljs-attr">overlayElement</span>: <span class="hljs-title class_">CreateOverlayElement</span></span>) {
  <span class="hljs-comment">// useId로 고유한 id를 생성</span>
  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">useId</span>();
  <span class="hljs-keyword">const</span> mount = <span class="hljs-title function_">useOverlayStore</span>(<span class="hljs-function">(<span class="hljs-params">store</span>) =&gt;</span> store.<span class="hljs-property">mount</span>);
  <span class="hljs-keyword">const</span> unmount = <span class="hljs-title function_">useOverlayStore</span>(<span class="hljs-function">(<span class="hljs-params">store</span>) =&gt;</span> store.<span class="hljs-property">unmount</span>);

  <span class="hljs-comment">// useMemo를 사용하여 객체를 캐싱</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useMemo</span>(
    <span class="hljs-function">() =&gt;</span> ({
      <span class="hljs-attr">open</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">mount</span>(id, <span class="hljs-title function_">overlayElement</span>({ <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">unmount</span>(id) }));
      },
      <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">unmount</span>(id);
      },
    }),
    [id, mount, unmount, overlayElement],
  );
}
</code></pre>
<p>구현하면서 제일 맘에 들었던 useCustomOverlay이다.</p>
<p>useId를 이용해서 id가 고유값을 갖도록 처리했으며 호출할 때 컴포넌트를 들고 호출하게 해서 사용하는 단에서는</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> modalSendEmailOverlay = <span class="hljs-title function_">useCustomOverlay</span>(<span class="hljs-function">(<span class="hljs-params">{ close }</span>) =&gt;</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModalSendEmail</span> <span class="hljs-attr">close</span>=<span class="hljs-string">{close}</span> /&gt;</span></span>
  ));
 <span class="hljs-comment">//...</span>
onClick={modalSendEmailOverlay.<span class="hljs-property">open</span>}    
</code></pre>
<p>open이라는 메소드만 사용하면 렌더링시킬 수 있도록 하였다.</p>
<p>이제 동료 개발자는 세가지 과정만 거치면 오버레이를 관리할 수 있게 된 것이다.</p>
<ol>
<li>화면을 띄울 컴포넌트 조립 (오버레이를 닫는 close라는 프롭을 가져야 한다.)</li>
<li>useCustomOverlay에 담음</li>
<li>인스턴스.open</li>
</ol>
<p>이로써 모달뿐만 아니라 사이드바, 토스트에도 넣을 수 있는 만능 훅을 구현했다!!!!!</p>
<blockquote>
<p>++ 2024-11-29</p>
<p>돌이켜보면 이 방식은 <code>useOverlay</code>의 기능을 너무 많이 줄인 방식이다.</p>
<p>toss의 useOverlay에서는 <code>Promise</code>를 활용해서 모달을 여는 함수가 아닌 특정 동작을 하는 핸들링 함수로 모달을 동시에 핸들링할 수 있다.</p>
<pre><code class="hljs language-jsx"><span class="hljs-comment">// purchase 모달을 여는 함수가 아닌 purchase라는 동작을 관리하는 함수</span>
<span class="hljs-keyword">const</span> handlePurchase = <span class="hljs-title function_">useCallback</span>(<span class="hljs-title function_">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> isOk = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    overlay.<span class="hljs-title function_">open</span>(<span class="hljs-function">(<span class="hljs-params">{ close, isOpen }</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PurchaseModal</span>
        <span class="hljs-attr">handleCancel</span>=<span class="hljs-string">{()</span> =&gt;</span> {
          resolve(false);
          close();
        }}
        handleConfirm={() =&gt; {
          resolve(true);
          close();
        }}
        isOpen={isOpen}
      /&gt;</span>
    ));
  });

  <span class="hljs-keyword">if</span> (isOk) {
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;결제가 완료되었습니다.&quot;</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;결제가 취소되었습니다.&quot;</span>);
  }
}, [overlay]);
</code></pre>
<p>이는 선언적으로 프로그래밍을 할 수 있게 하여 가독성이나 확장성 측면에서 훨씬 좋은 방식이다. 이는 프로덕트가 커질 수록 더 빛을 낼 것이다.</p>
</blockquote>
<h2 id="17"><mark style="background:#FFB86CA6">Compound Pattern + useCustomOverlay 예제 (공통 모달 컴포넌트)</mark></h2>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ModalContextType</span> {
  <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">ModalContext</span> = createContext&lt;<span class="hljs-title class_">ModalContextType</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ModalProps</span> {
  <span class="hljs-attr">closeOnFocusOut</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">children</span>: <span class="hljs-title class_">ReactNode</span>;
  <span class="hljs-attr">className</span>?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/**
 * 모달 컴포넌트
 *
 * <span class="hljs-doctag">@description</span> 컴파운드 패턴으로 만들어졌으며 useCustomOverlay의 인수로써 함께 사용하시면 됩니다.
 * 각 요소들은 margin이 정해져 있지 않습니다. className으로 지정해서 조합해서 사용하시면 됩니다.
 *
 * <span class="hljs-doctag">@author</span> 이승현
 * <span class="hljs-doctag">@param</span> close 모달을 끄는 함수
 * <span class="hljs-doctag">@param</span> children 모달 내부
 * <span class="hljs-doctag">@param</span> closeOnFocusOut 화면 밖 클릭시 모달을 끄는 여부
 * <span class="hljs-doctag">@example</span>
 * ```tsx
  export function ModalWarning({ handleConfirm, close }: ModalWarningProps) {
    const handleClick = async () =&gt; {
      await handleConfirm();
      close();
    };
    return (
      &lt;Modal close={close} closeOnFocusOut&gt;
        &lt;header className=&quot;flex justify-center pb-4 pt-6&quot;&gt;
          &lt;Alert width={24} height={24} /&gt;
        &lt;/header&gt;
        &lt;div className=&quot;mx-12 text-center md:mx-9&quot;&gt;
          &lt;Modal.Title className=&quot;mb-2 text-slate-50 md:text-text-primary&quot;&gt;
            회원 탈퇴를 진행하시겠어요?
          &lt;/Modal.Title&gt;
          &lt;Modal.Description className=&quot;mb-4&quot;&gt;
            그룹장에 있는 모든 그룹은 삭제되고, 모든 그룹에서 나가집니다.
          &lt;/Modal.Description&gt;
          &lt;Modal.TwoButtonSection
            closeBtnStyle=&quot;outlined_secondary&quot;
            confirmBtnStyle=&quot;danger&quot;
            buttonDescription=&quot;회원 탈퇴&quot;
            onClick={handleClick}
            close={close}
          /&gt;
        &lt;/div&gt;
      &lt;/Modal&gt;
    );
  }
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Modal</span>(<span class="hljs-params">{
  children,
  close,
  closeOnFocusOut,
  className,
}: <span class="hljs-title class_">ModalProps</span></span>) {
  <span class="hljs-keyword">const</span> modalRef = <span class="hljs-title function_">useClickOutside</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">close</span>();
  });

  <span class="hljs-keyword">return</span> (
    <span class="hljs-comment">// eslint-disable-next-line react/jsx-no-constructed-context-values</span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModalContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">close</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{cn(overlayVariants())}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">motion.div</span>
          <span class="hljs-attr">animate</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">opacity:</span> <span class="hljs-attr">1</span>, <span class="hljs-attr">y:</span> <span class="hljs-attr">0</span> }}
          <span class="hljs-attr">initial</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">opacity:</span> <span class="hljs-attr">0</span>, <span class="hljs-attr">y:</span> <span class="hljs-attr">100</span> }}
          <span class="hljs-attr">transition</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">duration:</span> <span class="hljs-attr">0.1</span> }}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{cn(modalVariants({</span> <span class="hljs-attr">className</span> }))}
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{</span>
            <span class="hljs-attr">closeOnFocusOut</span>
              ? (<span class="hljs-attr">modalRef</span> <span class="hljs-attr">as</span> <span class="hljs-attr">LegacyRef</span>&lt;<span class="hljs-attr">HTMLDivElement</span>&gt;</span> | undefined)
              : null
          }
        &gt;
          {children}
        <span class="hljs-tag">&lt;/<span class="hljs-name">motion.div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ModalContext.Provider</span>&gt;</span>
  );
}
//...
export function useModal() {
  const context = useContext(ModalContext);

  if (!context) {
    throw new Error(&quot;useModal must be used within a ModalProvider&quot;);
  }

  return context;
}
//...
function HeaderWithClose({ className }: HeaderWithCloseProps) {
  const { close } = useModal();
  return (
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{headerWithCloseVariants({</span> <span class="hljs-attr">className</span> })}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{close}</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">&quot;닫기&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CloseButton</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;rounded-xl duration-100 hover:scale-105&quot;</span>
          <span class="hljs-attr">width</span>=<span class="hljs-string">{24}</span>
          <span class="hljs-attr">height</span>=<span class="hljs-string">{24}</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
  );
}
HeaderWithClose.displayName = &quot;Modal.HeaderWithClose&quot;;
</span></code></pre>
<p>useCustomOverlay 분석에서 이야기 했듯이 마운트, 언마운트 관련 애니메이션 처리는 컴포넌트 내부에 구현되어져 있는 것을 확인할 수 있다.</p>
<p>이번 프로젝트에서는 비슷한 내부 요소를 가진 모달이 다양하게 있기 때문에 compound pattern으로 구성 요소들도 구현하였다.</p>
<blockquote>
<p>compound pattern이란 프론트엔드 환경에서 사용되는 디자인 패턴 중에 하나로,
context api를 이용해서 내부 상태가 구현된 하나의 컴포넌트만 가져와서 프로퍼티 안에 있는 컴포넌트를 활용, 마치 조립하듯이 다양한 컴포넌트를 구현할 수 있는 패턴입니다.
단, 트리 쉐이킹이 불가능하다는 단점도 갖고 있어 사용하는데 주의가 필요합니다.</p>
</blockquote>
<pre><code class="hljs language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HandleArticleModal</span>(<span class="hljs-params">{
  close,
  onSubmit,
  defaultContent,
  defaultImage,
  defaultTitle,
}: <span class="hljs-title class_">HandleArticleModalProps</span></span>) {
  <span class="hljs-keyword">const</span> { handleNext, handlePrev, isNext } = <span class="hljs-title function_">useNextPage</span>();
  <span class="hljs-keyword">const</span> [imageFile, setImageFile] = useState&lt;<span class="hljs-title class_">File</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleImageFile = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">selectedImageFile</span>: <span class="hljs-title class_">File</span> | <span class="hljs-literal">null</span></span>) =&gt;</span> {
    <span class="hljs-title function_">setImageFile</span>(selectedImageFile);
  }, []);

  <span class="hljs-title function_">usePreventScroll</span>();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span> <span class="hljs-attr">close</span>=<span class="hljs-string">{close}</span> <span class="hljs-attr">closeOnFocusOut</span>=<span class="hljs-string">{false}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Modal.HeaderWithClose</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;fixed right-7 top-7&quot;</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;relative&quot;</span>&gt;</span>
        {isNext ? (
          <span class="hljs-tag">&lt;<span class="hljs-name">ArticleForm</span>
            <span class="hljs-attr">file</span>=<span class="hljs-string">{imageFile}</span>
            <span class="hljs-attr">handlePrev</span>=<span class="hljs-string">{handlePrev}</span>
            <span class="hljs-attr">handlePost</span>=<span class="hljs-string">{onSubmit}</span>
            <span class="hljs-attr">defaultContent</span>=<span class="hljs-string">{defaultContent}</span>
            <span class="hljs-attr">defaultTitle</span>=<span class="hljs-string">{defaultTitle}</span>
            <span class="hljs-attr">defaultImage</span>=<span class="hljs-string">{defaultImage}</span>
            <span class="hljs-attr">close</span>=<span class="hljs-string">{close}</span>
          /&gt;</span>
        ) : (
          <span class="hljs-tag">&lt;<span class="hljs-name">FileDragDown</span>
            <span class="hljs-attr">file</span>=<span class="hljs-string">{imageFile}</span>
            <span class="hljs-attr">onSelect</span>=<span class="hljs-string">{handleImageFile}</span>
            <span class="hljs-attr">defaultPreview</span>=<span class="hljs-string">{defaultImage}</span>
            <span class="hljs-attr">handleNext</span>=<span class="hljs-string">{handleNext}</span>
          /&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span></span>
  );
}
</code></pre>
<p>이를 활용한 모달 조립 예시이다. 조립하는 쪽에서는 모달을 구현하는 내부 로직, 스타일을 알 필요 없이 Modal안에 컴포넌트와 필요한 로직을 넣기만 하면 구현되는 것을 확인할 수 있다.</p>
<p><img src="/images/2024-09-14/%EA%B2%8C%EC%8B%9C%EA%B8%80%20%EC%B6%94%EA%B0%80.gif" alt=""/></p>
<h1 id="18"><mark style="background:#FF5582A6">후기</mark></h1>
<p>좋은 문제 상황을 만나서 이번에 toss slash의 훅을 분석하는 시간을 가질 수 있게 되었다.</p>
<p>requestAnimateFrame이나 useImperative 훅 등 분석하지 않았다면 몰랐을 지식들을 많이 알게된 경험이었다.</p>
<p>이번 useOverlay는 다른 오픈 소스 라이브러리에 비하면 작은 크기이지만</p>
<p>추후에 좋은 문제를 만나면 이제 두려움 없이 커다란 오픈 소스라도 분석할 수 있을 것 같다.</p>
<p>더 성장해보자</p>
<p><a href="https://github.com/772-company/kkom-kkom/pull/80">https://github.com/772-company/kkom-kkom/pull/80</a></p>
<blockquote>
<p>꼼꼼 프로젝트 진행 중에 겪은 경험들입니다. 오늘도 많이 성장한 것 같아요!</p>
<p>읽어주셔서 감사합니다! 지켜봐주세요!</p>
<p>감사합니다.</p>
</blockquote></section></section></section><!--$--><!--/$--><!--$--><!--/$--><section></section></div><!--/$--></div><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-arrow-up fixed bottom-5 right-5 h-8 w-8 opacity-50 hover:cursor-pointer hover:opacity-100"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4"></path><path d="M12 16V8"></path></svg><footer class="mt-6 border-t bg-background py-6"><div class="container mx-auto px-4"><div class="flex flex-col items-center justify-center gap-4"><div class="flex items-center justify-center gap-4"><div class="flex space-x-4"><a target="_blank" rel="noopener noreferrer" class="text-muted-foreground transition-colors hover:text-foreground" href="mailto:robot9917@gmail.com"><img alt="Email" loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="transition-transform hover:scale-110" style="color:transparent" src="/icons/email.svg"/><span class="sr-only">GitHub</span></a></div><div class="flex space-x-4"><a target="_blank" rel="noopener noreferrer" class="text-muted-foreground transition-colors hover:text-foreground" href="https://github.com/codefug"><img alt="GitHub" loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="transition-transform hover:scale-110" style="color:transparent" src="/icons/github.svg"/><span class="sr-only">GitHub</span></a></div></div><p class="text-sm text-muted-foreground">© <!-- -->2025<!-- --> CodeFug Blog</p></div></div></footer></main></div><script src="https://codefug.github.io/_next/static/chunks/webpack-cb9a9adc3ea1ef6e.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[6424,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"565\",\"static/chunks/565-101a78ce724b5236.js\",\"177\",\"static/chunks/app/layout-7a37aaf52f8545c9.js\"],\"GoogleTagManager\"]\n3:I[9229,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"565\",\"static/chunks/565-101a78ce724b5236.js\",\"177\",\"static/chunks/app/layout-7a37aaf52f8545c9.js\"],\"default\"]\n4:I[2943,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"565\",\"static/chunks/565-101a78ce724b5236.js\",\"177\",\"static/chunks/app/layout-7a37aaf52f8545c9.js\"],\"SidebarProvider\"]\n5:I[6226,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"565\",\"static/chunks/565-101a78ce724b5236.js\",\"177\",\"static/chunks/app/layout-7a37aaf52f8545c9.js\"],\"default\"]\n6:I[323,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"565\",\"static/chunks/565-101a78ce724b5236.js\",\"177\",\"static/chunks/app/layout-7a37aaf52f8545c9.js\"],\"default\"]\n7:I[831,[],\"\"]\n8:I[8307,[],\"\"]\n9:I[70,[\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"345\",\"static/chunks/app/not-found-8b0af7c225bbe321.js\"],\"\"]\na:I[8092,[\"507\",\"static/chunks/app/posts/%5Bid%5D/layout-6a37c5d18e0b4ffc.js\"],\"default\"]\nc:I[9757,[],\"MetadataBoundary\"]\ne:I[9757,[],\"OutletBoundary\"]\n11:I[8475,[],\"AsyncMetadataOutlet\"]\n13:I[4299,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-382b4da1c4390447.js\"],\"Image\"]\n14:I[9757,[],\"ViewportBoundary\"]\n16:I[7882,[\"219\",\"static/chunks/app/global-error-e65e17ac78cfa06a.js\"],\"default\"]\n:HL[\"https://codefug.github.io/_next/static/media/518331"])</script><script>self.__next_f.push([1,"124efecf5c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"https://codefug.github.io/_next/static/css/2995ecc03dd1487c.css\",\"style\"]\n:HL[\"https://codefug.github.io/_next/static/css/7b1838e6bdc2260c.css\",\"style\"]\n:HL[\"https://codefug.github.io/_next/static/css/fc37ac2b1a278e8c.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"jE_YBf2d-CJ65i1rfRwt9\",\"p\":\"https://codefug.github.io\",\"c\":[\"\",\"posts\",\"2024-09-14-1\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2024-09-14-1\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://codefug.github.io/_next/static/css/2995ecc03dd1487c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"https://codefug.github.io/_next/static/css/7b1838e6bdc2260c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"$L2\",null,{\"gtmId\":\"$undefined\"}],[\"$\",\"body\",null,{\"className\":\"__className_7ee20e antialiased\",\"children\":[\"$\",\"$L3\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L4\",null,{\"defaultOpen\":false,\"children\":[[\"$\",\"$L5\",null,{\"totalFrontMatterList\":[{\"id\":\"2024-11-10\",\"title\":\"Asynchronous JavaScript\",\"excerpt\":\"microtask queue, macrotask queue, call stack, web api와 관련된 비동기 동작 방식, 비동기 관련 역사와 비동기 코드의 다양한 활용법들을 알아보자.\",\"date\":\"2024-11-10\",\"categories\":[\"javascript\"],\"header\":{\"teaser\":\"/images/logos/JS.svg\"}},{\"id\":\"2024-09-14-4\",\"title\":\"(꼼꼼 프로젝트) streaming 방식의 tanstack query\",\"excerpt\":\"infinite scroll, optimistic update 그리고 streaming 방식이 결합된 쿼리 처리 ( useSuspenseQuery, useSuspenseInfiniteQuery )\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/tanstackQuery.png\"}},{\"id\":\"2024-09-14-3\",\"title\":\"(꼼꼼 프로젝트) 클라이언트와 서버 둘다 호환되는 fetch 구현\",\"excerpt\":\"서버 액션을 활용한 refresh token rotation, 커링 함수를 이용한 리팩토링\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/fetch.png\"}},{\"id\":\"2024-09-14-2\",\"title\":\"(꼼꼼 프로젝트) startTransition, progress bar 구현에 대한 고민\",\"excerpt\":\"progress bar 로직 연구하기(startTransition), next-nprogress-bar\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/nprogress.png\"}},{\"id\":\"2024-09-14-1\",\"title\":\"(꼼꼼 프로젝트) toss slash 분석, zustand와 연결된 커스텀 overlay 훅 구현\",\"excerpt\":\"stacking context, compound pattern, 전역 상태를 활용한다는 것의 의미, 토스 개발자 실력 흡수하기\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/toss.png\"}},{\"id\":\"2024-09-11\",\"title\":\"(꼼꼼 프로젝트) 공통 버튼 컴포넌트의 종류를 쉽게 관리하고 누구나 쉽게 확인할 수 있게 하는 방법\",\"excerpt\":\"tailwind로 조건부 처리를 간편하게 하는 방법, 비개발자도 스타일을 쉽게 확인할 수 있도록 storybook 연동\",\"date\":\"2024-09-11\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/storybook.png\"}},{\"id\":\"2024-07-22-2\",\"title\":\"(급페이 프로젝트) 개발환경에만 집중하기 위한 여정\",\"excerpt\":\"접근 제한을 위한 미들웨어 처리, vercel CLI을 이용한 organization 무료 자동 배포, 프리뷰\",\"date\":\"2024-07-22\",\"categories\":[\"gheuppay\"],\"header\":{\"teaser\":\"/images/logos/vercel.png\"}},{\"id\":\"2024-07-22-1\",\"title\":\"(급페이 프로젝트) 알림창 무한 스크롤을 위한 여정 (mock fetching을 위한 MSW 도입기)\",\"excerpt\":\"msw를 활용해서 프론트엔드 개발이 다 되어있지 않은 상태에서도 무한 스크롤 구현을 확인할 수 있게 되었습니다.\",\"date\":\"2024-07-22\",\"categories\":[\"gheuppay\"],\"header\":{\"teaser\":\"/images/logos/msw.png\"}},{\"id\":\"2024-07-21\",\"title\":\"(급페이 프로젝트) 카드 렌더링을 최적화하여 UX를 향상시키기 위한 머나먼 여정\",\"excerpt\":\"server component 설계를 이용한 suspense 적극 활용, 이를 위해서 next cookie를 사용하면서 겪은 문제들을 적은 글입니다.\",\"date\":\"2024-07-21\",\"categories\":[\"gheuppay\"],\"header\":{\"teaser\":\"/images/logos/next-cookie.png\"}},{\"id\":\"2024-06-18\",\"title\":\"React Testing\",\"excerpt\":\"React Testing Library, Vitest, Jest\",\"date\":\"2024-06-18\",\"categories\":[\"reactdeepdive\"],\"header\":{\"teaser\":\"/images/logos/reactdeepdive.jpg\"}},{\"id\":\"2024-06-17\",\"title\":\"로그인 구현 (zustand, zod + react-hook-form, RTR)\",\"excerpt\":\"zustand를 이용한 로그인 상태 전역 관리, zod를 이용한 간단한 스키마 전개, react-hook-form을 이용한 간단한 validation, axios를 이용한 간단한 api 요청 처리\",\"date\":\"2024-06-17\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/zod.png\"}},{\"id\":\"2024-06-15\",\"title\":\"Dev tool\",\"excerpt\":\"리액트 과거, 현재, 미래\",\"date\":\"2024-06-15\",\"categories\":[\"web\"],\"header\":{\"teaser\":\"/images/logos/reactdeepdive.jpg\"}},{\"id\":\"2024-06-14\",\"title\":\"마이그레이션 중 발생한 Vite 환경 변수 처리\",\"excerpt\":\"Vite_ENV\",\"date\":\"2024-06-14\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/react.png\"}},{\"id\":\"2024-06-10\",\"title\":\"React Debugging\",\"excerpt\":\"react-dev-tools 정리, 실습\",\"date\":\"2024-06-10\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/react.png\"}},{\"id\":\"2024-06-08\",\"title\":\"자잘한 Next.js 트러블 슈팅들\",\"excerpt\":\"react-responsive를 사용하지 못하는 상황, dotenv 사용시 문제 발생\",\"date\":\"2024-06-08\",\"categories\":[\"nextjs\"],\"header\":{\"teaser\":\"/images/logos/Nextjs.png\"}},{\"id\":\"2024-05-31\",\"title\":\"Next는 왜 쓸까\",\"excerpt\":\"CSR SSG SSR\",\"date\":\"2024-05-31\",\"categories\":[\"nextjs\"],\"header\":{\"teaser\":\"/images/logos/Nextjs.png\"}},{\"id\":\"2024-05-23\",\"title\":\"리액트는 왜 쓸까\",\"excerpt\":\"리액트 과거, 현재, 미래\",\"date\":\"2024-05-23\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/reactdeepdive.jpg\"}},{\"id\":\"2024-05-22\",\"title\":\"TS는 왜 쓸까 (위대한 TS)\",\"excerpt\":\"JS를 완벽하게 하기 위한 여정\",\"date\":\"2024-05-22\",\"categories\":[\"typescript\"],\"header\":{\"teaser\":\"/images/logos/TS.png\"}},{\"id\":\"2024-05-20\",\"title\":\"Fandom-k 프로젝트 회고3\",\"excerpt\":\"Github Actions, 최종 결과\",\"date\":\"2024-05-20\",\"categories\":[\"fandomk\"],\"header\":{\"teaser\":\"/images/logos/githubActions.png\"}},{\"id\":\"2024-05-19\",\"title\":\"Fandom-k 프로젝트 회고2\",\"excerpt\":\"fetch, scroll to Top, infinite scroll 라이브러리 제거\",\"date\":\"2024-05-19\",\"categories\":[\"fandomk\"],\"header\":{\"teaser\":\"/images/logos/fetch.png\"}},{\"id\":\"2024-05-18\",\"title\":\"Fandom-k 프로젝트 회고1\",\"excerpt\":\"팀 프로젝트 세팅, infinite scroll, skeleton\",\"date\":\"2024-05-18\",\"categories\":[\"fandomk\"],\"header\":{\"teaser\":\"/images/logos/infinite-scroll.png\"}}]}],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h2\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"잘못된 페이지에요!\"}],[\"$\",\"$L9\",null,{\"href\":\"/\",\"children\":\"홈으로 돌아가기\"}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]}]}]]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"2024-09-14-1\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://codefug.github.io/_next/static/css/fc37ac2b1a278e8c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"prose mx-auto overflow-auto dark:prose-invert\",\"children\":[[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"$La\",null,{}]]}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$Lb\",[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null,[\"$\",\"$Le\",null,{\"children\":[\"$Lf\",\"$L10\",[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]]}]]}],{},null,false]},null,false]},null,false]},[[\"$\",\"div\",\"l\",{\"className\":\"flex h-full items-center justify-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"scale-[1.15] animate-pulse transition-transform\",\"children\":[\"$\",\"$L13\",null,{\"src\":\"/images/main-logo.png\",\"alt\":\"로딩 중...\",\"width\":120,\"height\":120,\"className\":\"drop-shadow-lg\"}]}],[\"$\",\"p\",null,{\"className\":\"mt-6 animate-pulse text-lg font-bold text-gray-600\",\"children\":\"Codefug Blog\"}]]}]}],[],[]],false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"7oqWHn-ZxSwBt1joAyrOm\",{\"children\":[[\"$\",\"$L14\",null,{\"children\":\"$L15\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$16\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"17:\"$Sreact.suspense\"\n18:I[8475,[],\"AsyncMetadata\"]\nd:[\"$\",\"$17\",null,{\"fallback\":null,\"children\":[\"$\",\"$L18\",null,{\"promise\":\"$@19\"}]}]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nf:null\n"])</script><script>self.__next_f.push([1,"19:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Codefug Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"project experiences and development notes\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"Codefug Blog\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"project experiences and development notes\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:url\",\"content\":\"https://codefug-blog.vercel.app\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:image\",\"content\":\"http://localhost:3000/images/main-logo.png\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image:alt\",\"content\":\"Codefug Blog\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:title\",\"content\":\"Codefug Blog\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:description\",\"content\":\"project experiences and development notes\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:image\",\"content\":\"http://localhost:3000/images/main-logo.png\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:image:alt\",\"content\":\"Codefug Blog\"}],[\"$\",\"link\",\"13\",{\"rel\":\"icon\",\"href\":\"/icon.ico?f00882ffa3186f37\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]],\"error\":null,\"digest\":\"$undefined\"}\n12:{\"metadata\":\"$19:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"1a:I[2464,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-382b4da1c4390447.js\"],\"GtmPageView\"]\n1b:I[9792,[\"299\",\"static/chunks/299-20a67a2580c87e66.js\",\"971\",\"static/chunks/971-96e75ab7e09e6508.js\",\"70\",\"static/chunks/70-d82343500dd0d9ac.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-382b4da1c4390447.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"b:[\"$\",\"section\",null,{\"children\":[[\"$\",\"$L1a\",null,{\"slug\":\"2024-09-14-1\"}],[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"relative mb-6 h-[300px] w-full overflow-hidden rounded-xl sm:h-[400px] md:h-[450px]\",\"children\":[[\"$\",\"$L13\",null,{\"src\":\"/images/logos/toss.png\",\"alt\":\"(꼼꼼 프로젝트) toss slash 분석, zustand와 연결된 커스텀 overlay 훅 구현\",\"fill\":true,\"sizes\":\"(max-width: 768px) 100vw, 1200px\",\"priority\":true,\"className\":\"object-cover object-center transition-transform duration-500 hover:scale-105\"}],[\"$\",\"div\",null,{\"className\":\"absolute inset-0 bg-gradient-to-b from-transparent to-black/70\"}],[\"$\",\"div\",null,{\"className\":\"absolute left-4 top-4 flex flex-wrap gap-2 sm:left-6 sm:top-6\",\"children\":[[\"$\",\"div\",\"kkom-kkom\",{\"className\":\"inline-flex items-center rounded-md border px-2.5 py-0.5 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-white/90 text-xs font-medium text-gray-800 hover:bg-white sm:text-sm\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-tag mr-1 h-3 w-3\",\"children\":[[\"$\",\"path\",\"vktsd0\",{\"d\":\"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z\"}],[\"$\",\"circle\",\"kqv944\",{\"cx\":\"7.5\",\"cy\":\"7.5\",\"r\":\".5\",\"fill\":\"currentColor\"}],\"$undefined\"]}],\" \",\"kkom-kkom\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-6 space-y-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-0 text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-50 sm:text-4xl md:text-5xl\",\"children\":\"(꼼꼼 프로젝트) toss slash 분석, zustand와 연결된 커스텀 overlay 훅 구현\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center justify-end gap-4 text-sm text-gray-600 dark:text-gray-400\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-calendar-days mr-2 h-4 w-4\",\"children\":[[\"$\",\"path\",\"1cmpym\",{\"d\":\"M8 2v4\"}],[\"$\",\"path\",\"4m81vk\",{\"d\":\"M16 2v4\"}],[\"$\",\"rect\",\"1hopcy\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"4\",\"rx\":\"2\"}],[\"$\",\"path\",\"8toen8\",{\"d\":\"M3 10h18\"}],[\"$\",\"path\",\"6423bh\",{\"d\":\"M8 14h.01\"}],[\"$\",\"path\",\"1etili\",{\"d\":\"M12 14h.01\"}],[\"$\",\"path\",\"1gbofw\",{\"d\":\"M16 14h.01\"}],[\"$\",\"path\",\"lrp35t\",{\"d\":\"M8 18h.01\"}],[\"$\",\"path\",\"mhygvu\",{\"d\":\"M12 18h.01\"}],[\"$\",\"path\",\"kzsmim\",{\"d\":\"M16 18h.01\"}],\"$undefined\"]}],[\"$\",\"time\",null,{\"dateTime\":\"2024-09-14\",\"children\":\"2024-09-14\"}]]}]}],[\"$\",\"p\",null,{\"className\":\"text-lg leading-relaxed text-gray-600 dark:text-gray-300 md:text-xl\",\"children\":\"stacking context, compound pattern, 전역 상태를 활용한다는 것의 의미, 토스 개발자 실력 흡수하기\"}]]}],[\"$\",\"div\",null,{\"className\":\"border-b border-gray-200 dark:border-gray-800\"}]]}],[\"$\",\"section\",null,{\"className\":\"lg:flex lg:items-baseline\",\"children\":[[\"$\",\"$L1b\",null,{}],[\"$\",\"section\",null,{\"className\":\"max-w-full\",\"children\":[[\"$\",\"h1\",null,{\"id\":0,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FF5582A6\"},\"children\":\"배경\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이번 프로젝트에는 정말 많은 종류의 모달이 존재한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240731004520.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"심지어 디자인 시안이 아직 다 완성되지 않은 상황이었기에 더 추가될지도 모르는 상황이었다.\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":1,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FF5582A6\"},\"children\":\"구현\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":2,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FFB86CA6\"},\"children\":\"상황 분석\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"모달들이 전부 조금씩 다르게 생겼으나 공통적으로 존재하는 것들을 생각해보았다.\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"padding과 border-radius\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"backdrop의 존재\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"background-color\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"주제, 설명의 폰트 같은 겹치는 UI 요소들\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"1,2,3 의 경우 \\\"모달\\\" 이라는 컴포넌트를 만들어서 조립할 수 있게 만들어주고\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"4 의 경우 자주 쓰이는 경우 Compound Pattern으로 묶어서 컴포넌트 간의 결합성을 높히게 되긴 하지만 조립하는 쪽에서 쉽게 할 수 있도록 구현하는게 좋다고 생각하였다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"컴포넌트 자체의 구현 방식은 해결되었고 이제 렌더링은 어떻게 시킬지 생각해야 했다.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":3,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FFB86CA6\"},\"children\":\"렌더링 방법\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":4,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FFF3A3A6\"},\"children\":\"전역 상태 관리\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"부끄럽지만 기존에 모달을 구현할 때는 마감 기한에 밀려서 좋은 코드를 생각하지 못했던 것 같다...\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"아래는 원래 사용하던 방식이다. context api를 활용하여 모달이 열리고 닫히고를 구현해놓은 모달이다.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 일종의 팩토리 패턴이다.\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"Modal\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{ children, button }: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ModalProps\"}]]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" [isModalOpen, setIsModalOpen] = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useState\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"false\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" modalRef = useClickOutside\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"HTMLDivElement\"}],\"\u003e(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setIsModalOpen\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"false\"}],\"));\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"handleOpen\"}],\" = (\",[\"$\",\"span\",null,{\"className\":\"hljs-params\"}],\") =\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setIsModalOpen\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"true\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"handleClose\"}],\" = (\",[\"$\",\"span\",null,{\"className\":\"hljs-params\"}],\") =\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setIsModalOpen\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"false\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ModalContext.Provider\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"value\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handleClose\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"isModalOpen\"}],\" }}\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"section\"}],\"\u003e\"]}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onClick\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handleOpen}\"}],\"\u003e\"]}],\"{button}\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\"\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"section\"}],\"\u003e\"]}],\"\\n      {isModalOpen \u0026\u0026 (\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"fixed inset-0 z-40 flex items-end bg-black bg-opacity-50 md:items-center md:justify-center\\\"\"}],\"\u003e\"]}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"ref\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{modalRef}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"bg-background-secondary z-50 w-full rounded-t-xl md:w-[384px] md:rounded-b-xl\\\"\"}],\"\\n          \u003e\"]}],\"\\n            {children}\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\"\u003e\"]}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\"\u003e\"]}],\"\\n      )}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ModalContext.Provider\"}],\"\u003e\"]}]]}],\"\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이렇게 context api를 사용한 모달은\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/context%20api%EB%A5%BC%20%ED%99%9C%EC%9A%A9%ED%95%9C%20%EB%AA%A8%EB%8B%AC.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"모달을 열었을 때 모달을 여는 버튼도 리렌더링된다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/context%20api%EB%A5%BC%20%ED%99%9C%EC%9A%A9%ED%95%9C%20%EB%AA%A8%EB%8B%AC%20profiler.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이는 어쩔수가 없는게 context가 결국 상위 컴포넌트에 있는 상태를 바꾸기 때문\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"개발자가 편해지긴 하지만 상태를 바꿔서 그 사이의 컴포넌트들이 리렌더링 되는 것을 막을 순 없음 ( 그래서 context api는 전역 상태 관리라기보단 전역 상태 주입이라고도 한다. )\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이번 프로젝트에서 전역 상태 관리 라이브러리로 zustand을 세팅했으니 우선 이를 활용해서 만들어 보자 하고 고민을 시작했다.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":5,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FFF3A3A6\"},\"children\":\"toss slash\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"그러던 중 toss의 오픈 소스 라이브러리에 overlay를 다루는 훅이 있는 것을 발견했다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"overlay란 위에 까는 것을 의미하며 여기서는 화면 위에 화면을 올리는 것을 말한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"즉, 모달 뿐만 아니라 사이드바, 토스트 등 존재하는 화면 위에 있는 컴포넌트도 overlay라고 한다.\"}],\"\\n\",[\"$\",\"h4\",null,{\"id\":6,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#BBFABBA6\"},\"children\":\"useOverlay 상세 분석\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/toss/slash/blob/main/packages/react/use-overlay/src/useOverlay.ko.md\",\"children\":\"https://github.com/toss/slash/blob/main/packages/react/use-overlay/src/useOverlay.ko.md\"}]}],\"\\n\",[\"$\",\"h5\",null,{\"id\":7,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"OverlayProvider\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// OverlayProvider.tsx\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"/** \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@tossdocs\"}],\"-ignore */\"]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"React\"}],\", {\\n  createContext,\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"PropsWithChildren\"}],\",\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\",\\n  useCallback,\\n  useMemo,\\n  useState,\\n} \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// context api로 저장\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayContext\"}],\" = createContext\u003c{\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 마운트 되는지 안되는지 확인하는 context\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"mount\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"element\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\"): \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"unmount\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\"): \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n} | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\"\u003e(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\");\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 배포 단계에서는\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (process.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"env\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"NODE_ENV\"}],\" !== \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"production\\\"\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// displayName을 설정\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayContext\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"displayName\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"OverlayContext\\\"\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// children을 받는 Provider 생성\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"OverlayProvider\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{ children }: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"PropsWithChildren\"}]]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// id와 컴포넌트를 저장하는 state 생성\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" [overlayById, setOverlayById] = useState\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\"\u003e\u003e(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"(),\\n  );\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// mount 함수 생성\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" mount = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"element\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}]]}],\") =\u003e\"]}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// mount를 계속 호출하지 않고 처음 마운트 될때만 호출 (useCallback)\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setOverlayById\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"overlayById\"}],\") =\u003e\"]}],\" {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" cloned = \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"(overlayById);\\n      cloned.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}],\"(id, element);\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" cloned;\\n    });\\n  }, []);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// unmount 함수 생성\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" unmount = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}]]}],\") =\u003e\"]}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// unmount를 계속 호출하지 않고 처음 언마운트 될때만 호출 (useCallback)\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setOverlayById\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"overlayById\"}],\") =\u003e\"]}],\" {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" cloned = \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"(overlayById);\\n      cloned.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"delete\"}],\"(id);\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" cloned;\\n    });\\n  }, []);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// context에 mount, unmount를 저장\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" context = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useMemo\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" ({ mount, unmount }), [mount, unmount]);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// context를 Context API를 활용해서 아래로 내리고 id와 element를 사용해서 컴포넌트를 렌더링\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"OverlayContext.Provider\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"value\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{context}\"}],\"\u003e\"]}],\"\\n      {children}\\n      {[...overlayById.entries()].map(([id, element]) =\u003e (\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"React.Fragment\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"key\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{id}\"}],\"\u003e\"]}],\"{element}\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"React.Fragment\"}],\"\u003e\"]}],\"\\n      ))}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"OverlayContext.Provider\"}],\"\u003e\"]}]]}],\"\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"OverlayProvider의 역할\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"컴포넌트를 저장하는 상태를 갖고 context api로 바꿀 수 있게 전역으로 내려준다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"상태를 이용해서 컴포넌트를 열어놓는다. (비어져 있을 때는 열려있어도 아무것도 보이지 않는다.)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"2024-11-29 추가\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"위 코드를 보면 \",[\"$\",\"code\",null,{\"children\":\"overlayById\"}],\" 라는 상태에 \",[\"$\",\"code\",null,{\"children\":\"id:string\"}],\"과 \",[\"$\",\"code\",null,{\"children\":\"element:ReactNode\"}],\"를 \",[\"$\",\"code\",null,{\"children\":\"Map\"}],\"의 요소로 넣어둔 후 \",[\"$\",\"code\",null,{\"children\":\"Provider\"}],\" 내부에서 쓰는 것을 볼 수 있다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"이때 \",[\"$\",\"code\",null,{\"children\":\"Provider\"}],\" 내부에서 \",[\"$\",\"code\",null,{\"children\":\"Fragment\"}],\"의 \",[\"$\",\"code\",null,{\"children\":\"children\"}],\"으로 \",[\"$\",\"code\",null,{\"children\":\"element:ReactNode\"}],\"를 사용하는 것을 볼 수 있는데 이는 \",[\"$\",\"code\",null,{\"children\":\"element:ReactNode\"}],\"가 \",[\"$\",\"code\",null,{\"children\":\"createElement(tag, props, ...children)\"}],\" 이라는 함수이기 때문이다. ( 정확히는 \",[\"$\",\"code\",null,{\"children\":\"JSX.Element\"}],\"이고 \",[\"$\",\"code\",null,{\"children\":\"ReactNode\"}],\"는 \",[\"$\",\"code\",null,{\"children\":\"string, number\"}],\" 등을 포함하는 좀 더 큰 개념이다. )\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"실제 \",[\"$\",\"code\",null,{\"children\":\"\u003cComponentName/\u003e\"}],\" 같은 \",[\"$\",\"code\",null,{\"children\":\"JSX.Element\"}],\"은 \",[\"$\",\"code\",null,{\"children\":\"React\"}],\" 내부적으로 \",[\"$\",\"code\",null,{\"children\":\"createElement\"}],\" 함수의 실행으로 바뀌어서 JS 객체를 반환하고 더 나아가 이를 Fiber, Fiber Tree로 만든다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"우린 이 중간 단계를 직접 사용한 것이다. 그래서 overlayById 상태의 element를 컴포넌트를 사용하는 것처럼 \",[\"$\",\"code\",null,{\"children\":\"\u003celement key={id}/\u003e\"}],\"로 사용할 수 없고 \",[\"$\",\"code\",null,{\"children\":\"children\"}],\"으로써 사용해야 한다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h5\",null,{\"id\":8,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"useOverlay\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useContext, useEffect, useMemo, useRef, useState } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayContext\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./OverlayProvider\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"/** \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@tossdocs\"}],\"-ignore */\"]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayController\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayControlRef\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./OverlayController\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"CreateOverlayElement\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./types\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}],\" elementId = \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Options\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"exitOnUnmount\"}],\"?: \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"boolean\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useOverlay\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{ exitOnUnmount = \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"true\"}],\" }: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Options\"}],\" = {}\"]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// overlayContext를 가져옴 (mount, unmount가 있음)\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" context = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useContext\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayContext\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// context가 없으면 에러 발생 (Provider 내부에서만 사용 가능)\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (context == \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"throw\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Error\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"useOverlay is only available within OverlayProvider.\\\"\"}],\");\\n  }\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 비구조 할당으로 mount, unmount를 분리\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" { mount, unmount } = context;\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// id를 저장하는 state 생성\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" [id] = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useState\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"String\"}],\"(elementId++));\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// overlayRef를 생성, useImperativeHandle을 사용하여 close 함수를 제공\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" overlayRef = useRef\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayControlRef\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\"\u003e(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//  exitOnUnmount가 true일 때, 컴포넌트가 언마운트 될 때 unmount 실행\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//  exitOnUnmount가 false일 때, 컴포넌트가 언마운트 될 때 unmount 실행하지 않음, 직접 exit(unmount)를 호출해야 함\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (exitOnUnmount) {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"unmount\"}],\"(id);\\n      }\\n    };\\n  }, [exitOnUnmount, id, unmount]);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useMemo를 사용하여 객체를 캐싱\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useMemo\"}],\"(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" ({\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// open, close, exit 함수를 반환\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// open: overlayElement를 받아서 mount 실행\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// close: overlayRef.current?.close() 실행\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// exit: unmount 실행\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"open\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"overlayElement\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"CreateOverlayElement\"}]]}],\") =\u003e\"]}],\" {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"mount\"}],\"(\\n          id,\\n          \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"OverlayController\"}],\"\\n            // \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"NOTE:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"state\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"should\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"be\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"reset\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"every\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"time\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"we\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"open\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"an\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"overlay\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"key\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{Date.now()}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"ref\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{overlayRef}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"overlayElement\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{overlayElement}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onExit\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{()\"}],\" =\u003e\"]}],\" {\\n              unmount(id);\\n            }}\\n          /\u003e\"]}],\",\\n        );\\n      },\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n        overlayRef.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"current\"}],\"?.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"close\"}],\"();\\n      },\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"exit\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"unmount\"}],\"(id);\\n      },\\n    }),\\n    [id, mount, unmount],\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"useOverlay의 역할\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"context를 읽고 mount, unmount할 수 있는 함수 제공 (여기서 mount와 unmount는 메모리에 담는 것(전역 상태))\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"context 내부적으로 사용할 id 생성, 주입\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h5\",null,{\"id\":9,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"OverlayController\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"/** \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@tossdocs\"}],\"-ignore */\"]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" {\\n  forwardRef,\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Ref\"}],\",\\n  useCallback,\\n  useEffect,\\n  useImperativeHandle,\\n  useState,\\n} \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"CreateOverlayElement\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./types\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Props\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 결과물\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"overlayElement\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"CreateOverlayElement\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onExit\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayControlRef\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayController\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"forwardRef\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"OverlayController\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"\\n  { overlayElement: OverlayElement, onExit }: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Props\"}],\",\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"ref\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Ref\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayControlRef\"}],\"\u003e,\\n\"]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 메모리가 아닌 실제 DOM에 렌더링되는지 여부\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" [isOpenOverlay, setIsOpenOverlay] = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useState\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"false\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// DOM에서 Overlay를 닫는 함수\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" handleOverlayClose = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setIsOpenOverlay\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"false\"}],\"), []);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// ref로 전달된 객체에 close 함수를 추가\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useImperativeHandle\"}],\"(ref, \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": handleOverlayClose };\\n  }, [handleOverlayClose]);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 컴포넌트가 마운트되면 Overlay를 열기\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"// \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"NOTE:\"}],\" requestAnimationFrame이 없으면 가끔 Open 애니메이션이 실행되지 않는다.\"]}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 브라우저에 다음 리페인트 전에 콜백 함수 호출을 가능하게 하는 메소드\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"requestAnimationFrame\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setIsOpenOverlay\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"true\"}],\");\\n    });\\n  }, []);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// OverlayElement를 렌더링\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"OverlayElement\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"isOpen\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{isOpenOverlay}\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handleOverlayClose}\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"exit\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{onExit}\"}],\"\\n    /\u003e\"]}]}],\"\\n  );\\n});\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"OverlayController의 역할\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"실제 DOM에 Element를 렌더링\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"리페인트 전에 함수를 호출해서 애니메이션 처리 (requestAnimationFrame은 마이크로 큐처럼 본인의 큐를 갖고 실행되기 때문에 리페인트 전에 함수를 실행시킬 수 있다.)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"useOverlay의 open으로 모달을 끄는 handler 올리기\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Element 내리기\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h5\",null,{\"id\":10,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"전체 구조도\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"종합적으로 구조도를 구려보면 다음과 같다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240828112132.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이를 통해 해결되는 점은\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"z-index가 쌓임맥락으로 묻혀지지 않도록 영향이 가지않는 main 아래에 모달이 정의된다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"컴포넌트에서 모달 컴포넌트를 직접 주입할 수 있다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"같은 페이지에서 여러 모달이 나올 수 있고 동시에도 있을 수 있다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"쌓임 맥락\"}],\"(stacking context)은 가상의 Z축을 사용한 HTML 요소의 3차원 개념화입니다. Z축은 사용자 기준이며, 사용자는 뷰포트 혹은 웹페이지를 바라보고 있을 것으로 가정합니다. 각각의 HTML 요소는 자신의 속성에 따른 우선순위를 사용해 3차원 공간을 차지합니다.\\n\",[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240914114250.png\",\"alt\":\"\"}],\"\\n어렵게 되어 있지만 쉽게 말하자면 z-index는 부모의 z-index를 이길 수 없다는 것이다. 자신이 z-index: 6이더라도 부모가 4라면 부모 단에 있는 4보다 높은 요소들을 z-index로 이길 수 없다.\\n(\",[\"$\",\"code\",null,{\"children\":\"DIV #4는 z-index:6이지만 z-index:5인 DIV #1보다 뒤에 있다.\"}],\")\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":11,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FFF3A3A6\"},\"children\":\"프로젝트에 맞게 개선\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"분석이 끝난 후 관련된 공부를 다 한 나는 강해진 느낌이 들었다. 하핳..\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"프로젝트를 위해서 useOverlay에서 개선할 점을 생각해보니 다음과 같았다.\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"전역 상태 주입에서 전역 상태 관리로 교체하는 것이 리렌더링 문제에서 벗어날 수 있다. 이번 프로젝트에서 전역 상태는 zustand를 사용하고 있기에 zustand로 깎아내는 작업이 필요하다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"slash의 라이브러리는 이전에 구현된 라이브러리 같았다. (React를 import 받고 있었음.) 현재 기준으로 어느정도 리팩토링을 하게 되면 가독성을 늘릴 수 있을 것이다. 간단하게는 컴포넌트의 id를 받는 부분에서 전역 변수를 지정해서 id를 넣어주고 있었는데 이는 react에서 id를 만들 때 쓰라고 만든 훅인 \",[\"$\",\"code\",null,{\"children\":\"useId\"}],\"를 사용하여 리팩토링할 수 있는 식이다.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"OverlayController 단은 마운트, 언마운트 관련해서 애니메이션 처리 (Framer-Motion의 AnimatePresense 같은)를 위해 exit, close로 따로 분리되어 있는데 이는 가독성을 해친다고 생각했다. 훅에 넣지 말고 모달, 사이드바 같은 컴포넌트를 만드는 부분에서 애니메이션 처리를 할 때 상태를 하나 만들어서 처리해도 된다고 생각했다. 기존 라이브러리에서도 이 부분 때문에 주석이 길게 되어 있는 것을 확인할 수 있었는데 개인적으로는 주석 없이도 잘 읽히는 코드가 더 좋은 것 같다. 우리 프로젝트에서는 마운트, 언마운트 시의 애니메이션에 큰 비중을 두지 않았기 때문에 들어내기로 했다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h4\",null,{\"id\":12,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#BBFABBA6\"},\"children\":\"useCustomOverlay 구조도\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240828112816.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"h5\",null,{\"id\":13,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"OverlayStore\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { devtools } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"zustand/middleware\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { createStore } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"zustand/vanilla\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayState\"}],\" = {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ElementsInMemory\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\"\u003e;\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayActions\"}],\" = {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"mount\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"element\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}]]}],\") =\u003e\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"unmount\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}]]}],\") =\u003e\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStore\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayState\"}],\" \u0026 \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayActions\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" initOverlayStore = (): \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"OverlayState\"}],\" =\u003e\"]}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ElementsInMemory\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"() };\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"defaultInitState\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayState\"}],\" = {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ElementsInMemory\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"(),\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createOverlayStore\"}],\" = (\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"initState\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayState\"}],\" = defaultInitState,\\n\"]}],\") =\u003e {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" createStore\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStore\"}],\"\u003e()(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"devtools\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"set\"}],\") =\u003e\"]}],\" ({\\n      ...initState,\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"mount\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"id, element\"}],\") =\u003e\"]}],\" {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}],\"(\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"state\"}],\") =\u003e\"]}],\" {\\n            state.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"ElementsInMemory\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}],\"(id, element);\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ElementsInMemory\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"(state.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"ElementsInMemory\"}],\") };\\n          },\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"undefined\"}],\",\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"mount\\\"\"}],\",\\n        );\\n      },\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"unmount\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"id\"}],\") =\u003e\"]}],\" {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}],\"(\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"state\"}],\") =\u003e\"]}],\" {\\n            state.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"ElementsInMemory\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"delete\"}],\"(id);\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ElementsInMemory\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Map\"}],\"(state.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"ElementsInMemory\"}],\") };\\n          },\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"undefined\"}],\",\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"unmount\\\"\"}],\",\\n        );\\n      },\\n    })),\\n  );\\n};\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"zustand store 방식으로 함으로써 mount, unmount 관련된 로직을 store에 숨길수 있게 되었다. (로직 분리 굳)\"}],\"\\n\",[\"$\",\"h6\",null,{\"id\":14,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ADCCFFA6\"},\"children\":\"트러블 슈팅\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"짧은 트러블 슈팅으로는 zustand에서는 shallow equal을 사용하여 상태의 변화를 감지하는데 delete만 지워서 리렌더링이 막 일어나게 되었었다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"데이터 변경시 return으로 새로운 Map을 넣어줘야 리렌더링이 정상적으로 일어난다.\"}],\"\\n\",[\"$\",\"h5\",null,{\"id\":15,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"OverlayStoreProvider\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStore\"}],\",\\n  createOverlayStore,\\n  initOverlayStore,\\n} \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"@/stores/modal-store\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Fragment\"}],\",\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"PropsWithChildren\"}],\",\\n  createContext,\\n  useContext,\\n  useRef,\\n} \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useStoreWithEqualityFn } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"zustand/traditional\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStoreApi\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReturnType\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"typeof\"}],\" createOverlayStore\u003e;\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStoreContext\"}],\" = createContext\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStoreApi\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"undefined\"}],\"\u003e(\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"undefined\"}],\",\\n);\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"OverlayStoreProvider\"}],\" = (\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{ children }: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"PropsWithChildren\"}]]}],\") =\u003e {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" storeRef = useRef\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStoreApi\"}],\"\u003e();\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (!storeRef.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"current\"}],\") {\\n    storeRef.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"current\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"createOverlayStore\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"initOverlayStore\"}],\"());\\n  }\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"OverlayStoreContext.Provider\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"value\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{storeRef.current}\"}],\"\u003e\"]}],\"\\n      {children}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"OverlayStoreContext.Provider\"}],\"\u003e\"]}]]}],\"\\n  );\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"OverlayProvider\"}],\" = (\",[\"$\",\"span\",null,{\"className\":\"hljs-params\"}],\") =\u003e {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ElementsInMemory\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useOverlayStore\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"store\"}],\") =\u003e\"]}],\" store.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"ElementsInMemory\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":\"\u003c\u003e\"}],\"\\n      {[...ElementsInMemory.entries()].map(([id, element]) =\u003e (\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Fragment\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"key\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{id}\"}],\"\u003e\"]}],\"{element}\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Fragment\"}],\"\u003e\"]}],\"\\n      ))}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":\"\u003c/\u003e\"}]]}],\"\\n  );\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" useOverlayStore = \u003cT,\u003e(\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"selector\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"store\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStore\"}]]}],\") =\u003e\"]}],\" T,\\n): \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"T\"}],\" =\u003e\"]}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" overlayStoreContext = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useContext\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"OverlayStoreContext\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (!overlayStoreContext) {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"throw\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Error\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"`useModalStore must be used within ModalStoreProvider`\"}],\");\\n  }\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useStoreWithEqualityFn\"}],\"(overlayStoreContext, selector);\\n};\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"OverlayStore와 연결된 컴포넌트이다. 쌓임 맥락을 해결하기 위해서 main 아래에 놓아야한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Map의 entries로 Map을 전개해서 안에 있는 컴포넌트들을 꺼내주는데 순차적으로 렌더링되기 때문에 뒤에 구현되는 컴포넌트가 쌓임 맥락에서 이기게 되어 덮어써지게 된다.\"}],\"\\n\",[\"$\",\"h5\",null,{\"id\":16,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#ABF7F7A6\"},\"children\":\"useCustomOverlay\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useOverlayStore } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"@/providers/modal-store-provider\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useId, useMemo } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"CreateOverlayElement\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./types\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"/**\\n * Zustand와 결합하여 루트 아래에 컴포넌트를 렌더링하는 훅입니다.\\n * close를 prop으로 받는 컴포넌트를 렌더링합니다.\\n * Modal 컴포넌트와 같이 close 함수를 prop으로 받는 컴포넌트를 만들어서 넣어주시면 됩니다.\\n * 해당 컴포넌트는 루트 아래로 띄워주기만 합니다. \\n * \\n * 모달 안에 다른 CustomOverlay를 만들어서 모달을 하나 더 띄우셔도 됩니다. \\n * 단,useOutSideClick은 따로 처리해주셔야 합니다.\\n * \\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@author\"}],\" 이승현\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@param\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-variable\",\"children\":\"overlayElement\"}],\"\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@returns\"}],\" 루트 아래에 해당 컴포넌트가 렌더링됩니다.\\n *  const overlay1 = useCustomOverlay(({ close }) =\u003e (\\n    \u003cModal close={close}\u003e\\n      \u003cModal.HeaderWithClose /\u003e\\n      \u003cModal.Title\u003e제목\u003c/Modal.Title\u003e\\n      \u003cModal.Description\u003e난 예시다.\u003c/Modal.Description\u003e\\n      \u003cModal.Description\u003e해냈다.\u003c/Modal.Description\u003e\\n    \u003c/Modal\u003e\\n  ));\\n  return (\\n    \u003cbutton onClick={overlay1.open}\u003eoverlay1에 넣은 컴포넌트를 여는 버튼/button\u003e\\n */\"]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCustomOverlay\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"overlayElement\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"CreateOverlayElement\"}]]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useId로 고유한 id를 생성\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" id = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useId\"}],\"();\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" mount = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useOverlayStore\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"store\"}],\") =\u003e\"]}],\" store.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"mount\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" unmount = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useOverlayStore\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"store\"}],\") =\u003e\"]}],\" store.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"unmount\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useMemo를 사용하여 객체를 캐싱\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useMemo\"}],\"(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" ({\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"open\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"mount\"}],\"(id, \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"overlayElement\"}],\"({ \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"unmount\"}],\"(id) }));\\n      },\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"unmount\"}],\"(id);\\n      },\\n    }),\\n    [id, mount, unmount, overlayElement],\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"구현하면서 제일 맘에 들었던 useCustomOverlay이다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"useId를 이용해서 id가 고유값을 갖도록 처리했으며 호출할 때 컴포넌트를 들고 호출하게 해서 사용하는 단에서는\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" modalSendEmailOverlay = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCustomOverlay\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"{ close }\"}],\") =\u003e\"]}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ModalSendEmail\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{close}\"}],\" /\u003e\"]}]}],\"\\n  ));\\n \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//...\"}],\"\\nonClick={modalSendEmailOverlay.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"open\"}],\"}    \\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"open이라는 메소드만 사용하면 렌더링시킬 수 있도록 하였다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이제 동료 개발자는 세가지 과정만 거치면 오버레이를 관리할 수 있게 된 것이다.\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"화면을 띄울 컴포넌트 조립 (오버레이를 닫는 close라는 프롭을 가져야 한다.)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"useCustomOverlay에 담음\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"인스턴스.open\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이로써 모달뿐만 아니라 사이드바, 토스트에도 넣을 수 있는 만능 훅을 구현했다!!!!!\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"++ 2024-11-29\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"돌이켜보면 이 방식은 \",[\"$\",\"code\",null,{\"children\":\"useOverlay\"}],\"의 기능을 너무 많이 줄인 방식이다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"toss의 useOverlay에서는 \",[\"$\",\"code\",null,{\"children\":\"Promise\"}],\"를 활용해서 모달을 여는 함수가 아닌 특정 동작을 하는 핸들링 함수로 모달을 동시에 핸들링할 수 있다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-jsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// purchase 모달을 여는 함수가 아닌 purchase라는 동작을 관리하는 함수\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" handlePurchase = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"async\"}],\" () =\u003e {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" isOk = \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Promise\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"resolve\"}],\") =\u003e\"]}],\" {\\n    overlay.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"open\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"{ close, isOpen }\"}],\") =\u003e\"]}],\" (\\n      \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"PurchaseModal\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handleCancel\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{()\"}],\" =\u003e\"]}],\" {\\n          resolve(false);\\n          close();\\n        }}\\n        handleConfirm={() =\u003e {\\n          resolve(true);\\n          close();\\n        }}\\n        isOpen={isOpen}\\n      /\u003e\"]}],\"\\n    ));\\n  });\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (isOk) {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"alert\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"결제가 완료되었습니다.\\\"\"}],\");\\n  } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"alert\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"결제가 취소되었습니다.\\\"\"}],\");\\n  }\\n}, [overlay]);\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이는 선언적으로 프로그래밍을 할 수 있게 하여 가독성이나 확장성 측면에서 훨씬 좋은 방식이다. 이는 프로덕트가 커질 수록 더 빛을 낼 것이다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":17,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FFB86CA6\"},\"children\":\"Compound Pattern + useCustomOverlay 예제 (공통 모달 컴포넌트)\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ModalContextType\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ModalContext\"}],\" = createContext\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ModalContextType\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\"\u003e(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\");\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ModalProps\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"closeOnFocusOut\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"boolean\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"children\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\";\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"?: \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"/**\\n * 모달 컴포넌트\\n *\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@description\"}],\" 컴파운드 패턴으로 만들어졌으며 useCustomOverlay의 인수로써 함께 사용하시면 됩니다.\\n * 각 요소들은 margin이 정해져 있지 않습니다. className으로 지정해서 조합해서 사용하시면 됩니다.\\n *\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@author\"}],\" 이승현\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@param\"}],\" close 모달을 끄는 함수\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@param\"}],\" children 모달 내부\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@param\"}],\" closeOnFocusOut 화면 밖 클릭시 모달을 끄는 여부\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@example\"}],\"\\n * ```tsx\\n  export function ModalWarning({ handleConfirm, close }: ModalWarningProps) {\\n    const handleClick = async () =\u003e {\\n      await handleConfirm();\\n      close();\\n    };\\n    return (\\n      \u003cModal close={close} closeOnFocusOut\u003e\\n        \u003cheader className=\\\"flex justify-center pb-4 pt-6\\\"\u003e\\n          \u003cAlert width={24} height={24} /\u003e\\n        \u003c/header\u003e\\n        \u003cdiv className=\\\"mx-12 text-center md:mx-9\\\"\u003e\\n          \u003cModal.Title className=\\\"mb-2 text-slate-50 md:text-text-primary\\\"\u003e\\n            회원 탈퇴를 진행하시겠어요?\\n          \u003c/Modal.Title\u003e\\n          \u003cModal.Description className=\\\"mb-4\\\"\u003e\\n            그룹장에 있는 모든 그룹은 삭제되고, 모든 그룹에서 나가집니다.\\n          \u003c/Modal.Description\u003e\\n          \u003cModal.TwoButtonSection\\n            closeBtnStyle=\\\"outlined_secondary\\\"\\n            confirmBtnStyle=\\\"danger\\\"\\n            buttonDescription=\\\"회원 탈퇴\\\"\\n            onClick={handleClick}\\n            close={close}\\n          /\u003e\\n        \u003c/div\u003e\\n      \u003c/Modal\u003e\\n    );\\n  }\\n */\"]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"Modal\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{\\n  children,\\n  close,\\n  closeOnFocusOut,\\n  className,\\n}: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ModalProps\"}]]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" modalRef = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useClickOutside\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"close\"}],\"();\\n  });\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// eslint-disable-next-line react/jsx-no-constructed-context-values\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ModalContext.Provider\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"value\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\" }}\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"section\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{cn(overlayVariants())}\"}],\"\u003e\"]}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"motion.div\"}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"animate\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"opacity:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"1\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"y:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"0\"}],\" }}\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"initial\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"opacity:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"0\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"y:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"100\"}],\" }}\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"transition\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"duration:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"0.1\"}],\" }}\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{cn(modalVariants({\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\" }))}\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"ref\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"closeOnFocusOut\"}],\"\\n              ? (\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"modalRef\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"as\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"LegacyRef\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"HTMLDivElement\"}],\"\u003e\"]}],\" | undefined)\\n              : null\\n          }\\n        \u003e\\n          {children}\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"motion.div\"}],\"\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"section\"}],\"\u003e\"]}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ModalContext.Provider\"}],\"\u003e\"]}],\"\\n  );\\n}\\n//...\\nexport function useModal() {\\n  const context = useContext(ModalContext);\\n\\n  if (!context) {\\n    throw new Error(\\\"useModal must be used within a ModalProvider\\\");\\n  }\\n\\n  return context;\\n}\\n//...\\nfunction HeaderWithClose({ className }: HeaderWithCloseProps) {\\n  const { close } = useModal();\\n  return (\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"header\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{headerWithCloseVariants({\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\" })}\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"button\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"button\\\"\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onClick\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{close}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"aria-label\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"닫기\\\"\"}],\"\u003e\"]}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"CloseButton\"}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"rounded-xl duration-100 hover:scale-105\\\"\"}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"width\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{24}\"}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"height\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{24}\"}],\"\\n        /\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"button\"}],\"\u003e\"]}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"header\"}],\"\u003e\"]}],\"\\n  );\\n}\\nHeaderWithClose.displayName = \\\"Modal.HeaderWithClose\\\";\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"useCustomOverlay 분석에서 이야기 했듯이 마운트, 언마운트 관련 애니메이션 처리는 컴포넌트 내부에 구현되어져 있는 것을 확인할 수 있다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이번 프로젝트에서는 비슷한 내부 요소를 가진 모달이 다양하게 있기 때문에 compound pattern으로 구성 요소들도 구현하였다.\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"compound pattern이란 프론트엔드 환경에서 사용되는 디자인 패턴 중에 하나로,\\ncontext api를 이용해서 내부 상태가 구현된 하나의 컴포넌트만 가져와서 프로퍼티 안에 있는 컴포넌트를 활용, 마치 조립하듯이 다양한 컴포넌트를 구현할 수 있는 패턴입니다.\\n단, 트리 쉐이킹이 불가능하다는 단점도 갖고 있어 사용하는데 주의가 필요합니다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"HandleArticleModal\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{\\n  close,\\n  onSubmit,\\n  defaultContent,\\n  defaultImage,\\n  defaultTitle,\\n}: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"HandleArticleModalProps\"}]]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" { handleNext, handlePrev, isNext } = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useNextPage\"}],\"();\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" [imageFile, setImageFile] = useState\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"File\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\"\u003e(\",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\");\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" handleImageFile = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"selectedImageFile\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"File\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}]]}],\") =\u003e\"]}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setImageFile\"}],\"(selectedImageFile);\\n  }, []);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"usePreventScroll\"}],\"();\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Modal\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{close}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"closeOnFocusOut\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{false}\"}],\"\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Modal.HeaderWithClose\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"fixed right-7 top-7\\\"\"}],\" /\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"section\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"relative\\\"\"}],\"\u003e\"]}],\"\\n        {isNext ? (\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ArticleForm\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"file\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{imageFile}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handlePrev\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handlePrev}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handlePost\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{onSubmit}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"defaultContent\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{defaultContent}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"defaultTitle\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{defaultTitle}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"defaultImage\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{defaultImage}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"close\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{close}\"}],\"\\n          /\u003e\"]}],\"\\n        ) : (\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"FileDragDown\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"file\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{imageFile}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onSelect\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handleImageFile}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"defaultPreview\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{defaultImage}\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handleNext\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handleNext}\"}],\"\\n          /\u003e\"]}],\"\\n        )}\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"section\"}],\"\u003e\"]}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Modal\"}],\"\u003e\"]}]]}],\"\\n  );\\n}\\n\"]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이를 활용한 모달 조립 예시이다. 조립하는 쪽에서는 모달을 구현하는 내부 로직, 스타일을 알 필요 없이 Modal안에 컴포넌트와 필요한 로직을 넣기만 하면 구현되는 것을 확인할 수 있다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/%EA%B2%8C%EC%8B%9C%EA%B8%80%20%EC%B6%94%EA%B0%80.gif\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":18,\"children\":[\"$\",\"mark\",null,{\"style\":{\"background\":\"#FF5582A6\"},\"children\":\"후기\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"좋은 문제 상황을 만나서 이번에 toss slash의 훅을 분석하는 시간을 가질 수 있게 되었다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"requestAnimateFrame이나 useImperative 훅 등 분석하지 않았다면 몰랐을 지식들을 많이 알게된 경험이었다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이번 useOverlay는 다른 오픈 소스 라이브러리에 비하면 작은 크기이지만\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"추후에 좋은 문제를 만나면 이제 두려움 없이 커다란 오픈 소스라도 분석할 수 있을 것 같다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"더 성장해보자\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/772-company/kkom-kkom/pull/80\",\"children\":\"https://github.com/772-company/kkom-kkom/pull/80\"}]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"꼼꼼 프로젝트 진행 중에 겪은 경험들입니다. 오늘도 많이 성장한 것 같아요!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"읽어주셔서 감사합니다! 지켜봐주세요!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"감사합니다.\"}],\"\\n\"]}]]}]]}]]}]\n"])</script></body></html>