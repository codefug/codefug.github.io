<!DOCTYPE html><!--SidpDY09K3KAz3NqdkUP0--><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="https://codefug.github.io/_next/static/media/518331124efecf5c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/images/logos/nprogress.png"/><link rel="preload" as="image" href="/images/2024-09-14/progressbar%20%EC%98%88%EC%8B%9C.gif"/><link rel="preload" as="image" href="/images/2024-09-14/progress%20bar%20%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81%20%EC%97%90%EB%9F%AC.gif"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240818002733.png"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240828114258.png"/><link rel="preload" as="image" href="/images/2024-09-14/Pasted%20image%2020240914151931.png"/><link rel="preload" as="image" href="/images/2024-09-14/progressbar%EA%B2%8C%EC%8B%9C%ED%8C%90.gif"/><link rel="stylesheet" href="https://codefug.github.io/_next/static/css/96413cdc35608d81.css" data-precedence="next"/><link rel="stylesheet" href="https://codefug.github.io/_next/static/css/0944061766e538e2.css" data-precedence="next"/><link rel="stylesheet" href="https://codefug.github.io/_next/static/css/fc37ac2b1a278e8c.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="https://codefug.github.io/_next/static/chunks/webpack-37cc78a9711b1295.js"/><script src="https://codefug.github.io/_next/static/chunks/157b3f09-27b3f30b77a87c7b.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/304-95bcc6403960523e.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/main-app-9e55846899bf6ca1.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/487-d14c2623a9f3fdfd.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/45-a3006a7b4d051491.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/762-fb8a01463e9bf4fd.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/464-cfefa5bf5f0e766b.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/559-04b70e00e58d5c4b.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/layout-ab4602898f2b74c8.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/global-error-b0d0eb5f8d1d5f85.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/not-found-8cae470c11fa9853.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/posts/%5Bid%5D/layout-09cee8bbecb3ba10.js" async=""></script><script src="https://codefug.github.io/_next/static/chunks/app/posts/%5Bid%5D/page-9b07e941c08849ec.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=undefined" as="script"/><meta name="next-size-adjust" content=""/><title>Codefug Blog</title><meta name="description" content="프로젝트 경험과 개발 노트를 공유하는 블로그"/><meta name="author" content="Codefug"/><meta name="keywords" content="개발,프로그래밍,React,Next.js,JavaScript,TypeScript,블로그"/><meta name="creator" content="Codefug"/><meta name="publisher" content="Codefug"/><meta property="og:title" content="Codefug Blog"/><meta property="og:description" content="project experiences and development notes"/><meta property="og:url" content="https://codefug-blog.vercel.app"/><meta property="og:image" content="https://codefug.github.io/images/main-logo.png"/><meta property="og:image:alt" content="Codefug Blog"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Codefug Blog"/><meta name="twitter:description" content="project experiences and development notes"/><meta name="twitter:image" content="https://codefug.github.io/images/main-logo.png"/><meta name="twitter:image:alt" content="Codefug Blog"/><link rel="icon" href="/icon.ico?f00882ffa3186f37" type="image/x-icon" sizes="16x16"/><script src="https://codefug.github.io/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_75a1fa antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div style="--sidebar-width:16rem;--sidebar-width-icon:3rem" class="group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar"><div class="group peer hidden text-sidebar-foreground md:block" data-state="collapsed" data-collapsible="offcanvas" data-variant="sidebar" data-side="left"><div class="relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-[--sidebar-width-icon]"></div><div class="fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l"><div data-sidebar="sidebar" class="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"><div data-sidebar="content" class="flex min-h-0 flex-1 flex-col overflow-auto group-data-[collapsible=icon]:overflow-hidden group relative gap-0" style="scrollbar-width:none"><div class="absolute h-[150px] w-full bg-primary"></div><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 mb-2 mt-4 flex justify-center px-4 text-sm font-bold text-gray-400 group-hover:text-white">Codefug</div><div data-sidebar="group-content" class="w-full text-sm flex min-h-full flex-col items-center px-2"><span class="relative flex shrink-0 overflow-hidden rounded-full h-40 w-40"><span class="flex h-full w-full items-center justify-center rounded-full bg-muted group-hover:text-black group-hover:dark:text-white">이승현</span></span><h1 class="mt-4 text-center text-lg font-bold text-gray-400 group-hover:text-black dark:text-gray-500 group-hover:dark:text-white">이승현</h1><p class="text-sm text-gray-400 group-hover:text-black dark:text-gray-500 group-hover:dark:text-white">Web Frontend Developer</p></div></div><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><section><div data-sidebar="group-label" class="flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0">Computer Science</div><div data-sidebar="group-content" class="w-full text-sm"><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_omplb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">data-structure<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_omplb_" hidden=""></div></div></div></div></section><section><div data-sidebar="group-label" class="flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0">Project</div><div data-sidebar="group-content" class="w-full text-sm"><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_p6plb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">kkom-kkom<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_p6plb_" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_196plb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">gheuppay<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_196plb_" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_1p6plb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">fandomk<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_1p6plb_" hidden=""></div></div></div></div></section><section><div data-sidebar="group-label" class="flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0">Web</div><div data-sidebar="group-content" class="w-full text-sm"><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_pmplb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">web<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_pmplb_" hidden=""></div></div></div></div></section><section><div data-sidebar="group-label" class="flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0">language</div><div data-sidebar="group-content" class="w-full text-sm"><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_q6plb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">javascript<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_q6plb_" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_1a6plb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">typescript<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_1a6plb_" hidden=""></div></div></div></div></section><section><div data-sidebar="group-label" class="flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0">FE</div><div data-sidebar="group-content" class="w-full text-sm"><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_qmplb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">react<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_qmplb_" hidden=""></div></div></div><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_1amplb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">nextjs<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_1amplb_" hidden=""></div></div></div></div></section><section><div data-sidebar="group-label" class="flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0">Book</div><div data-sidebar="group-content" class="w-full text-sm"><div data-state="closed" class="group/collapsible"><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><button type="button" aria-controls="radix-_R_r6plb_" aria-expanded="false" data-state="closed" data-sidebar="group-label" class="h-8 shrink-0 items-center rounded-md px-2 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 flex justify-center text-sm font-bold text-gray-400 hover:bg-accent hover:text-black hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white">reactdeepdive<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down ml-auto transition-transform group-data-[state=open]/collapsible:rotate-180"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_r6plb_" hidden=""></div></div></div></div></section></div><div data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-sidebar="group-content" class="w-full text-sm"><ul data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-1"><li data-sidebar="menu-item" class="group/menu-item relative"><a class="text-gray-400 hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm" target="_blank" data-sidebar="menu-button" data-size="default" data-active="false" href="https://www.figma.com/proto/KSWARGDkXi9Wt8ARq2uGCa/leeseounghyun-resume?node-id=401-2&amp;node-type=canvas&amp;t=z2H9bL74afXrrgPS-1&amp;scaling=min-zoom&amp;content-scaling=fixed&amp;page-id=0%3A1">Resume</a></li><li data-sidebar="menu-item" class="group/menu-item relative"><a class="text-gray-400 hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm" target="_self" data-sidebar="menu-button" data-size="default" data-active="false" href="/portfolio">Portfolio</a></li><li data-sidebar="menu-item" class="group/menu-item relative"><a class="text-gray-400 hover:underline hover:drop-shadow-lg group-hover:text-black hover:dark:text-white group-hover:dark:text-white peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-none ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground h-8 text-sm" target="_self" data-sidebar="menu-button" data-size="default" data-active="false" href="/search">Search</a></li></ul></div></div></div><div data-sidebar="footer" class="flex flex-col gap-2 p-2"></div></div></div></div><main id="main-content" class="flex min-h-screen flex-col transition-[width] duration-200 ease-linear w-full"><header class="sticky left-0 right-0 top-0 z-30 transform bg-background transition-transform duration-300 translate-y-0"><div class="flex items-center justify-between gap-6 py-4"><section class="flex items-center gap-4"><div class="ml-2"><button class="flex h-7 w-7 items-center justify-center rounded-md hover:bg-accent hover:text-black hover:dark:text-white" aria-label="사이드바 열기/닫기" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left-open"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path><path d="m14 9 3 3-3 3"></path></svg></button></div><a class="flex flex-shrink-0 items-center gap-2 hover:opacity-95 hover:drop-shadow-lg" href="/"><img alt="Codefug Blog 로고" loading="lazy" width="28" height="28" decoding="async" data-nimg="1" style="color:transparent" src="/images/main-logo.png"/><div class="hidden whitespace-nowrap text-lg font-bold text-black dark:text-white md:block">Codefug Blog</div></a></section><section class="flex items-center gap-4 text-sm font-semibold md:text-base"><nav class="flex items-center gap-4 text-sm font-semibold md:text-base"><a target="_blank" class="text-gray-600 hover:text-black hover:underline hover:drop-shadow-lg dark:text-gray-300 dark:hover:text-white" aria-label="이력서 보기 (새 탭에서 열림)" rel="noopener noreferrer" href="https://www.figma.com/proto/KSWARGDkXi9Wt8ARq2uGCa/leeseounghyun-resume?node-id=401-2&amp;node-type=canvas&amp;t=z2H9bL74afXrrgPS-1&amp;scaling=min-zoom&amp;content-scaling=fixed&amp;page-id=0%3A1">Resume</a><a target="_self" class="text-gray-600 hover:text-black hover:underline hover:drop-shadow-lg dark:text-gray-300 dark:hover:text-white" aria-label="포트폴리오 페이지로 이동" rel="noopener noreferrer" href="/portfolio">Portfolio</a><a target="_self" class="text-gray-600 hover:text-black hover:underline hover:drop-shadow-lg dark:text-gray-300 dark:hover:text-white" aria-label="검색 페이지로 이동" rel="noopener noreferrer" href="/search"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-5 w-5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></a></nav><button type="button" role="switch" aria-checked="false" data-state="unchecked" value="on" class="peer inline-flex h-7 w-16 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input" aria-label="테마 전환"><span data-state="unchecked" class="pointer-events-none block h-6 w-6 rounded-full bg-theme-icon bg-center shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-[2.25rem] data-[state=unchecked]:translate-x-0 data-[state=checked]:bg-moon data-[state=unchecked]:bg-sun"></span></button><input type="checkbox" aria-hidden="true" style="transform:translateX(-100%);position:absolute;pointer-events:none;opacity:0;margin:0" tabindex="-1" value="on"/></section></div><div class="h-2 origin-left bg-primary" style="transform:scaleX(0)"></div></header><div class="mx-auto w-full max-w-[1400px] flex-1 px-4"><!--$?--><template id="B:0"></template><div class="flex h-full items-center justify-center"><div class="flex flex-col items-center"><div class="scale-[1.15] animate-pulse transition-transform"><img alt="로딩 중..." loading="lazy" width="120" height="120" decoding="async" data-nimg="1" class="drop-shadow-lg" style="color:transparent" src="/images/main-logo.png"/></div><p class="mt-6 animate-pulse text-lg font-bold text-gray-600">Codefug Blog</p></div></div><!--/$--></div><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-arrow-up fixed bottom-5 right-5 h-8 w-8 opacity-50 hover:cursor-pointer hover:opacity-100"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4"></path><path d="M12 16V8"></path></svg><footer class="mt-6 border-t bg-background py-6"><div class="container mx-auto px-4"><div class="flex flex-col items-center justify-center gap-4"><div class="flex items-center justify-center gap-4"><div class="flex space-x-4"><a target="_blank" rel="noopener noreferrer" class="text-muted-foreground transition-colors hover:text-foreground" href="mailto:robot9917@gmail.com"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 -2.5 20 20" fill="#000" class="transition-transform hover:scale-110"><path fill="current" fill-rule="evenodd" d="M10 12.474 0 3.649V15h20V3.649zm.001-2.662L0 .981V0h20v.981z"></path></svg><span class="sr-only">Email</span></a></div><div class="flex space-x-4"><a target="_blank" rel="noopener noreferrer" class="text-muted-foreground transition-colors hover:text-foreground" href="https://github.com/codefug"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="32" height="32" viewBox="0 0 291.32 291.32" fill="#000" class="transition-transform hover:scale-110"><path fill="current" d="M145.66 0C65.219 0 0 65.219 0 145.66c0 80.45 65.219 145.66 145.66 145.66s145.66-65.21 145.66-145.66C291.319 65.219 226.1 0 145.66 0m40.802 256.625c-.838-11.398-1.775-25.518-1.83-31.235-.364-4.388-.838-15.549-11.434-22.677 42.068-3.523 62.087-26.774 63.526-57.499 1.202-17.497-5.754-32.883-18.107-45.3.628-13.282-.401-29.023-1.256-35.941-9.486-2.731-31.608 8.949-37.79 13.947-13.037-5.062-44.945-6.837-64.336 0-13.747-9.668-29.396-15.64-37.926-13.974-7.875 17.452-2.813 33.948-1.275 35.914-10.142 9.268-24.289 20.675-20.447 44.572 6.163 35.04 30.816 53.94 70.508 58.564-8.466 1.73-9.896 8.048-10.606 10.788-26.656 10.997-34.275-6.791-37.644-11.425-11.188-13.847-21.23-9.832-21.849-9.614-.601.218-1.056 1.092-.992 1.511.564 2.986 6.655 6.018 6.955 6.263 8.257 6.154 11.316 17.27 13.2 20.438 11.844 19.473 39.374 11.398 39.638 11.562.018 1.702-.191 16.032-.355 27.184C64.245 245.992 27.311 200.2 27.311 145.66c0-65.365 52.984-118.348 118.348-118.348S264.008 80.295 264.008 145.66c0 51.008-32.318 94.332-77.546 110.965"></path></svg><span class="sr-only">GitHub</span></a></div></div><p class="text-sm text-muted-foreground">© <!-- -->2025<!-- --> CodeFug Blog</p></div></div></footer></main></div><script>requestAnimationFrame(function(){$RT=performance.now()});</script><script src="https://codefug.github.io/_next/static/chunks/webpack-37cc78a9711b1295.js" id="_R_" async=""></script><div hidden id="S:0"><div class="prose mx-auto mb-10 overflow-auto dark:prose-invert"><section><header class="mb-8"><div class="relative mb-6 h-[300px] w-full overflow-hidden rounded-xl sm:h-[400px] md:h-[450px]"><img alt="(꼼꼼 프로젝트) startTransition, progress bar 구현에 대한 고민" decoding="async" data-nimg="fill" class="object-cover object-center transition-transform duration-500 hover:scale-105" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/images/logos/nprogress.png"/><div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/70"></div><div class="absolute left-4 top-4 flex flex-wrap gap-2 sm:left-6 sm:top-6"><div class="inline-flex items-center rounded-md border px-2.5 py-0.5 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-white/90 text-xs font-medium text-gray-800 hover:bg-white sm:text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag mr-1 h-3 w-3"><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"></path><circle cx="7.5" cy="7.5" r=".5" fill="currentColor"></circle></svg> <!-- -->kkom-kkom</div></div></div><div class="mb-6 space-y-4"><h1 class="mb-0 text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-50 sm:text-4xl md:text-5xl">(꼼꼼 프로젝트) startTransition, progress bar 구현에 대한 고민</h1><div class="flex items-center justify-end gap-4 text-sm text-gray-600 dark:text-gray-400"><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-days mr-2 h-4 w-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path><path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path><path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path></svg><time dateTime="2024-09-14">2024-09-14</time></div></div><p class="text-lg leading-relaxed text-gray-600 dark:text-gray-300 md:text-xl">progress bar 로직 연구하기(startTransition), next-nprogress-bar</p></div><div class="border-b border-gray-200 dark:border-gray-800"></div></header><section class="lg:flex lg:items-baseline"><section class="max-w-full"><h1 id="0" class="hltr-red">배경</h1>
<p><img src="/images/2024-09-14/progressbar%20%EC%98%88%EC%8B%9C.gif" alt=""/></p>
<p>위의 사진은 Next.js로 만든 코드잇 사이트이다.</p>
<p>Link 컴포넌트인 탭 요소를 누르면 주소가 바뀌면서 progress bar가 동작하는 것을 확인할 수 있다.</p>
<p>꼼꼼 프로젝트는 Next.js로 만들어졌기 때문에 url이 변경되면서 렌더링이 일어나는 경우가 많다. (searchParams와 관련된 렌더링도 많다.)</p>
<p>이때 progress bar를 추가하면 UX가 크게 향상될 것이라고 생각하고 고민을 시작했다.</p>
<h1 id="1" class="hltr-red">구현</h1>
<p>Next는 router event를 외부에 노출시키지 않아서 페이지 바꿀 때 로딩 생기는 걸 구현하는게 매우 어렵다.</p>
<p>이를 해결한 간단한 라이브러리도 찾았으나 실제 동작 과정을 알고 싶어서 실제로 구현된 코드를 위주로 연구를 시작했다.</p>
<h2 id="2" class="hltr-orange">코드 분석</h2>
<p><a href="https://buildui.com/posts/global-progress-in-nextjs">https://buildui.com/posts/global-progress-in-nextjs</a></p>
<p>위의 포스팅을 분석해보았다.</p>
<h3 id="3" class="hltr-yellow">layout.tsx</h3>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// layout.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ReactNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ProgressBarLink</span>, <span class="hljs-title class_">ProgressBar</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./progress-bar&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Layout</span>(<span class="hljs-params">{ children }: { children: ReactNode }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ProgressBar</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;fixed top-0 h-1 bg-sky-500&quot;</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;border-b border-gray-700&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;m-4 flex gap-4&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ProgressBarLink</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/demo-1&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">ProgressBarLink</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ProgressBarLink</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/demo-1/posts/1&quot;</span>&gt;</span>Post 1<span class="hljs-tag">&lt;/<span class="hljs-name">ProgressBarLink</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ProgressBarLink</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/demo-1/posts/2&quot;</span>&gt;</span>Post 2<span class="hljs-tag">&lt;/<span class="hljs-name">ProgressBarLink</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ProgressBarLink</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/demo-1/posts/3&quot;</span>&gt;</span>Post 3<span class="hljs-tag">&lt;/<span class="hljs-name">ProgressBarLink</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;m-4&quot;</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ProgressBar</span>&gt;</span></span>
    &lt;/div&gt;
  );
}
</code></pre>
<h3 id="4" class="hltr-yellow">progress-bar</h3>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// progress-bar</span>
<span class="hljs-string">&quot;use client&quot;</span>;

<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">AnimatePresence</span>,
  motion,
  useMotionTemplate,
  useSpring,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;framer-motion&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Link</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/link&quot;</span>;
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/navigation&quot;</span>;
<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">ComponentProps</span>,
  <span class="hljs-title class_">ReactNode</span>,
  createContext,
  startTransition,
  useContext,
  useEffect,
  useRef,
  useState,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-comment">// createContext로 전역 상태 지정</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ProgressBarContext</span> = createContext&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> useProgress&gt; | <span class="hljs-literal">null</span>&gt;(
  <span class="hljs-literal">null</span>,
);

<span class="hljs-comment">// useProgressBar 라는 훅으로 useProgress와 연결해서 사용하고자 함.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useProgressBar</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">let</span> progress = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ProgressBarContext</span>);
  <span class="hljs-keyword">if</span> (progress === <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Need to be inside provider&quot;</span>);
  }

  <span class="hljs-keyword">return</span> progress;
}

<span class="hljs-comment">// Progress Bar 컴포넌트 그 자체</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProgressBar</span>(<span class="hljs-params">{
  className,
  children,
}: {
  className: <span class="hljs-built_in">string</span>;
  children: ReactNode;
}</span>) {
  <span class="hljs-comment">// useProgress 사용</span>
  <span class="hljs-keyword">let</span> progress = <span class="hljs-title function_">useProgress</span>();
  <span class="hljs-comment">// useMotionTemplate: 여러 motion value를 하나의 motion value로 만드는 훅</span>
  <span class="hljs-comment">// 여기서는 width: ~% 이런식으로 길어지게 만들어 놓음. 내부적으로 progress.value가 100이 되면 complete임</span>
  <span class="hljs-keyword">let</span> width = useMotionTemplate<span class="hljs-string">`<span class="hljs-subst">${progress.value}</span>%`</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ProgressBarContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{progress}</span>&gt;</span>
      // 존재하는 모든 노드의 애니메이션이 완료되면 progress.reset //
      AnimatePresence가 progress.state가 complete된걸 감지해서 exit 애니메이션을
      실행시킬 수 있게 해주고 // 이후에 reset 함수가 실행된다.
      <span class="hljs-tag">&lt;<span class="hljs-name">AnimatePresence</span> <span class="hljs-attr">onExitComplete</span>=<span class="hljs-string">{progress.reset}</span>&gt;</span>
        // 마운트시키는 상태를 progress에서 가져옴
        {progress.state !== &quot;complete&quot; &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">motion.div</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width</span> }}
            <span class="hljs-attr">exit</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">opacity:</span> <span class="hljs-attr">0</span> }}
            <span class="hljs-attr">className</span>=<span class="hljs-string">{className}</span>
          /&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">AnimatePresence</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ProgressBarContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ProgressBar와 연동될 링크 컴포넌트</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProgressBarLink</span>(<span class="hljs-params">{
  href,
  children,
  ...rest
}: <span class="hljs-title class_">ComponentProps</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Link</span>&gt;</span>) {
  <span class="hljs-comment">// useProgress를 context에서 꺼낸다.</span>
  <span class="hljs-keyword">let</span> progress = <span class="hljs-title function_">useProgressBar</span>();
  <span class="hljs-keyword">let</span> router = <span class="hljs-title function_">useRouter</span>();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span>
      <span class="hljs-attr">href</span>=<span class="hljs-string">{href}</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> {
        // 기본 동작을 삭제한다.
        e.preventDefault();
        // progress를 in-progress 상태로 만듬.
        progress.start();
        startTransition(() =&gt; {
          // router.push를 가장 나중 렌더링으로 바꾼다. 중간에 다른거 누르면 즉시 취소될 수 있다.
          router.push(href.toString());
          // router.push는 void가 리턴값이며 함수가 진행중인지 알 수 있는 방법이 없다. 이를 위해 transition을 사용한다.
          // startTransition은 내부의 함수들이 UI 렌더링 없이 한번에 업데이트 되게 해준다.
          // 이를 통해 router.push와 progress.done은 한번에 업데이트 되게 된다.

          // 클릭시 progress.start라는 상태 변화는 바로 일어나지만 progress.done이라는 상태 변화는 router.push가 끝나야 진행된다.
          // 상태 계의 async라고 보면 될 것 같다.

          // push가 끝나면 done으로 progress를 끝낸다. (initial이거나 in-progress면 complete으로 만듬.)
          progress.done();
        });
      }}
      {...rest}
    &gt;
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// useProgress (본체)</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useProgress</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// 현재 상태</span>
  <span class="hljs-keyword">const</span> [state, setState] = useState&lt;
    <span class="hljs-string">&quot;initial&quot;</span> | <span class="hljs-string">&quot;in-progress&quot;</span> | <span class="hljs-string">&quot;completing&quot;</span> | <span class="hljs-string">&quot;complete&quot;</span>
  &gt;(<span class="hljs-string">&quot;initial&quot;</span>);

  <span class="hljs-comment">// Spring으로 애니메이션 value 넣음.</span>
  <span class="hljs-keyword">let</span> value = <span class="hljs-title function_">useSpring</span>(<span class="hljs-number">0</span>, {
    <span class="hljs-comment">// 반대쪽에 가해지는 힘</span>
    <span class="hljs-attr">damping</span>: <span class="hljs-number">25</span>,
    <span class="hljs-comment">// 무기력해지는 정도</span>
    <span class="hljs-attr">mass</span>: <span class="hljs-number">0.5</span>,
    <span class="hljs-comment">// sudden movement 정도</span>
    <span class="hljs-attr">stiffness</span>: <span class="hljs-number">300</span>,
    <span class="hljs-comment">// 거리가 이것보다 낮아지면 애니메이션을 끝낸다.</span>
    <span class="hljs-attr">restDelta</span>: <span class="hljs-number">0.1</span>,
  });

  <span class="hljs-comment">// interval로 콜백함수를 실행시켜주는 훅</span>
  <span class="hljs-title function_">useInterval</span>(
    <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// progress를 시작하는데 bar가 complete 상태면 reset부터 한다.</span>
      <span class="hljs-keyword">if</span> (value.<span class="hljs-title function_">get</span>() === <span class="hljs-number">100</span>) {
        <span class="hljs-comment">// motionValue를 0으로 만들어서 멈춘다.</span>
        value.<span class="hljs-title function_">jump</span>(<span class="hljs-number">0</span>);
      }

      <span class="hljs-comment">// motionValue를 가져와서</span>
      <span class="hljs-keyword">let</span> current = value.<span class="hljs-title function_">get</span>();

      <span class="hljs-comment">// 바뀌는 정도인듯?</span>
      <span class="hljs-keyword">let</span> diff;

      <span class="hljs-comment">// 0이면 한번에 15움직이고</span>
      <span class="hljs-keyword">if</span> (current === <span class="hljs-number">0</span>) {
        diff = <span class="hljs-number">15</span>;
        <span class="hljs-comment">// 50 이하일때는 빠르게 움직이고</span>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current &lt; <span class="hljs-number">50</span>) {
        diff = <span class="hljs-title function_">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);
        <span class="hljs-comment">// 초과하면 1 ~ 5까지 움직인다.</span>
      } <span class="hljs-keyword">else</span> {
        diff = <span class="hljs-title function_">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>);
      }

      <span class="hljs-comment">// motionValue에 추가 (최대 99)</span>
      value.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(current + diff, <span class="hljs-number">99</span>));
    },
    <span class="hljs-comment">// in-progress 상태이면 delay (시간텀) 을 750 (0.75s) 아니면 없앰</span>
    state === <span class="hljs-string">&quot;in-progress&quot;</span> ? <span class="hljs-number">750</span> : <span class="hljs-literal">null</span>,
  );

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// initia이면 0으로</span>
    <span class="hljs-keyword">if</span> (state === <span class="hljs-string">&quot;initial&quot;</span>) {
      value.<span class="hljs-title function_">jump</span>(<span class="hljs-number">0</span>);
      <span class="hljs-comment">// completing이면 100으로 간다.</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state === <span class="hljs-string">&quot;completing&quot;</span>) {
      value.<span class="hljs-title function_">set</span>(<span class="hljs-number">100</span>);
    }

    <span class="hljs-comment">// value가 변화할 때 latest가 100이면 complete 상태로 만든다.</span>
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;change&quot;</span>, <span class="hljs-function">(<span class="hljs-params">latest</span>) =&gt;</span> {
      <span class="hljs-comment">// on 이벤트는 motionValue를 가져올 수 있다. lastest가 motionValue임</span>
      <span class="hljs-keyword">if</span> (latest === <span class="hljs-number">100</span>) {
        <span class="hljs-title function_">setState</span>(<span class="hljs-string">&quot;complete&quot;</span>);
      }
    });
    <span class="hljs-comment">// value, state, 컴포넌트 언마운트 시마다 value.on 이라는 이벤트 핸들러는 사라진다.</span>
  }, [value, state]);

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">reset</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// initial로 만듬</span>
    <span class="hljs-title function_">setState</span>(<span class="hljs-string">&quot;initial&quot;</span>);
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">start</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// start로 만듬</span>
    <span class="hljs-title function_">setState</span>(<span class="hljs-string">&quot;in-progress&quot;</span>);
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">done</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// initial이거나 in-progress면 completing아니면 원상태로 돌리는 함수</span>
    <span class="hljs-title function_">setState</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span>
      state === <span class="hljs-string">&quot;initial&quot;</span> || state === <span class="hljs-string">&quot;in-progress&quot;</span> ? <span class="hljs-string">&quot;completing&quot;</span> : state,
    );
  }
  <span class="hljs-keyword">return</span> { state, value, start, done, reset };
}

<span class="hljs-comment">// 랜덤하게 max와 min 사이에서 양수 하나를 꺼내는 함수</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">rand</span>(<span class="hljs-params"><span class="hljs-attr">min</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">max</span>: <span class="hljs-built_in">number</span></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (max - min + <span class="hljs-number">1</span>)) + min;
}

<span class="hljs-comment">// useInterval: callback과 delay를 받으면 interval을 주는 함수</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useInterval</span>(<span class="hljs-params"><span class="hljs-attr">callback</span>: () =&gt; <span class="hljs-built_in">void</span>, <span class="hljs-attr">delay</span>: <span class="hljs-built_in">number</span> | <span class="hljs-literal">null</span></span>) {
  <span class="hljs-comment">// callback을 저장하는 클로저</span>
  <span class="hljs-keyword">const</span> savedCallback = <span class="hljs-title function_">useRef</span>(callback);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// callback을 변경하는 함수</span>
    savedCallback.<span class="hljs-property">current</span> = callback;
  }, [callback]);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ref에 담긴 callback 실행하는 함수</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">tick</span>(<span class="hljs-params"></span>) {
      savedCallback.<span class="hljs-title function_">current</span>();
    }

    <span class="hljs-keyword">if</span> (delay !== <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// 일단 실행</span>
      <span class="hljs-title function_">tick</span>();

      <span class="hljs-comment">// 타이머 켜라</span>
      <span class="hljs-keyword">let</span> id = <span class="hljs-built_in">setInterval</span>(tick, delay);
      <span class="hljs-comment">// 언마운트 될 때 타이머 지워라</span>
      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(id);
    }
  }, [delay]);
}
</code></pre>
<h3 id="5" class="hltr-yellow">분석 결과</h3>
<p>굉장히 복잡한 코드가 나왔지만 결론적으로는 progress bar가 실제 로딩 퍼센트와 관련이 없어도 된다는 아이디어로 시작되는 것 같다.</p>
<ol>
<li>progress bar는 동작시 바로 15로 간다.</li>
<li>이후 progress bar는 15 부터 99까지 랜덤으로 채워진다.</li>
<li>99가 되었을 때 startTransition을 이용해서 router.push와 progress bar의 언마운트가 동시에 된다.</li>
<li>progress bar의 언마운트 시에 Framer-Motion의 AnimatePresense를 이용해서 언마운트되더라도 컴포넌트가 애니메이션 종료까지 남아있게 된다. &gt; 부드러운 언마운트가 이루어 진다.</li>
</ol>
<p>여기서 startTransition을 이용한 동시성 렌더링으로 progress bar가 언마운트 되는 로직을 router.push와 함께 넣어둔 부분이 굉장히 인상 깊었다.</p>
<p>분석은 끝났으니 이제 활용할 방법을 찾아보자.</p>
<p>우리 프로젝트를 리팩토링할만한 것들은 다음과 같다.</p>
<ol>
<li>우리 만의 LinkButton이 있기 때문에 Link를 따로 만들지 않고 훅에서 로직을 받아와서 내려주는 방식으로 리팩토링이 쉽게 해줘야 한다. =&gt; 훅으로 따로 생성, 내부 로직은 감춤</li>
<li>useReducer를 이용해서 state 관리를 가독성 있게 하자.</li>
</ol>
<h2 id="6" class="hltr-orange">리팩토링 결과</h2>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { rand } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/utils/get-rand&quot;</span>;
<span class="hljs-keyword">import</span> { useSpring } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;framer-motion&quot;</span>;
<span class="hljs-keyword">import</span> { startTransition, useEffect, useReducer, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-keyword">import</span> useInterval <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./use-interval&quot;</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">StateType</span> = <span class="hljs-string">&quot;initial&quot;</span> | <span class="hljs-string">&quot;in-progress&quot;</span> | <span class="hljs-string">&quot;completing&quot;</span> | <span class="hljs-string">&quot;complete&quot;</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ActionType</span> =
  | { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;start&quot;</span> }
  | { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;done&quot;</span> }
  | { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;reset&quot;</span> }
  | { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;complete&quot;</span> };

<span class="hljs-keyword">function</span> <span class="hljs-title function_">reducer</span>(<span class="hljs-params"><span class="hljs-attr">state</span>: <span class="hljs-title class_">StateType</span>, <span class="hljs-attr">action</span>: <span class="hljs-title class_">ActionType</span></span>): <span class="hljs-title class_">StateType</span> {
  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;start&quot;</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;in-progress&quot;</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;done&quot;</span>:
      <span class="hljs-keyword">return</span> state === <span class="hljs-string">&quot;initial&quot;</span> || state === <span class="hljs-string">&quot;in-progress&quot;</span>
        ? <span class="hljs-string">&quot;completing&quot;</span>
        : state;
    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;reset&quot;</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;initial&quot;</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;complete&quot;</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;complete&quot;</span>;
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Unhandled action type&quot;</span>);
  }
}

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@author</span> 이승현
 * <span class="hljs-doctag">@description</span>
 * progress 내부 로직이 담긴 훅입니다.
 *
 * progress bar와 같이 표시해주는 컴포넌트(view)를 만드시려면 state, value, reset 를 사용하시면 됩니다.
 * 자세한 구현 사항은 progress bar를 참고해주세요
 *
 * progress bar와 같은 컴포넌트와 연결되어 있는 컴포넌트를 만드시고 싶으시면 이 훅이 아닌 &quot;useProgressBar&quot;의
 * progress 함수를 사용하시면 됩니다.
 *
 * <span class="hljs-doctag">@example</span>
 * export function ProgressBar({
  className,
  children,
}: {
  className: string;
  children: ReactNode;
}) {
  // useProgress 사용
  let progress = useProgress();
  // useMotionTemplate: 여러 motion value를 하나의 motion value로 만드는 훅
  // 여기서는 width: ~% 이런식으로 길어지게 만들어 놓음. 내부적으로 progress.value가 100이 되면 complete임
  let width = useMotionTemplate`${progress.value}%`;

  return (
    &lt;ProgressBarContext.Provider value={progress}&gt;
      &lt;AnimatePresence onExitComplete={progress.reset}&gt;
        {progress.state !== &quot;complete&quot; &amp;&amp; (
          &lt;motion.div
            style={{ width }}
            exit={{ opacity: 0 }}
            className={className}
          /&gt;
        )}
      &lt;/AnimatePresence&gt;
      {children}
    &lt;/ProgressBarContext.Provider&gt;
  );
}
 *
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useProgress</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// 현재 상태</span>
  <span class="hljs-keyword">const</span> [state, dispatch] = <span class="hljs-title function_">useReducer</span>(reducer, <span class="hljs-string">&quot;initial&quot;</span>);

  <span class="hljs-comment">// Spring으로 애니메이션 value 넣음.</span>
  <span class="hljs-keyword">let</span> value = <span class="hljs-title function_">useSpring</span>(<span class="hljs-number">0</span>, {
    <span class="hljs-comment">// 반대쪽에 가해지는 힘</span>
    <span class="hljs-attr">damping</span>: <span class="hljs-number">25</span>,
    <span class="hljs-comment">// 무기력해지는 정도</span>
    <span class="hljs-attr">mass</span>: <span class="hljs-number">0.5</span>,
    <span class="hljs-comment">// sudden movement 정도</span>
    <span class="hljs-attr">stiffness</span>: <span class="hljs-number">300</span>,
    <span class="hljs-comment">// 거리가 이것보다 낮아지면 애니메이션을 끝낸다.</span>
    <span class="hljs-attr">restDelta</span>: <span class="hljs-number">0.1</span>,
  });

  <span class="hljs-comment">// interval로 콜백함수를 실행시켜주는 훅</span>
  <span class="hljs-title function_">useInterval</span>(
    <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// progress를 시작하는데 bar가 complete 상태면 reset부터 한다.</span>
      <span class="hljs-keyword">if</span> (value.<span class="hljs-title function_">get</span>() === <span class="hljs-number">100</span>) {
        <span class="hljs-comment">// motionValue를 0으로 만들어서 멈춘다.</span>
        value.<span class="hljs-title function_">jump</span>(<span class="hljs-number">0</span>);
      }
      <span class="hljs-comment">// motionValue를 가져와서</span>
      <span class="hljs-keyword">let</span> current = value.<span class="hljs-title function_">get</span>();
      <span class="hljs-comment">// 바뀌는 정도인듯?</span>
      <span class="hljs-keyword">let</span> diff;
      <span class="hljs-comment">// 0이면 한번에 15움직이고</span>
      <span class="hljs-keyword">if</span> (current === <span class="hljs-number">0</span>) {
        diff = <span class="hljs-number">15</span>;
        <span class="hljs-comment">// 50 이하일때는 빠르게 움직이고</span>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current &lt; <span class="hljs-number">50</span>) {
        diff = <span class="hljs-title function_">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);
        <span class="hljs-comment">// 초과하면 1 ~ 5까지 움직인다.</span>
      } <span class="hljs-keyword">else</span> {
        diff = <span class="hljs-title function_">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>);
      }
      <span class="hljs-comment">// motionValue에 추가 (최대 99)</span>
      value.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(current + diff, <span class="hljs-number">99</span>));
    },
    <span class="hljs-comment">// in-progress 상태이면 delay (시간텀) 을 750 (0.75s) 아니면 없앰</span>
    state === <span class="hljs-string">&quot;in-progress&quot;</span> ? <span class="hljs-number">750</span> : <span class="hljs-literal">null</span>,
  );

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> unsubscribe = value.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;change&quot;</span>, <span class="hljs-function">(<span class="hljs-params">latest</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (latest === <span class="hljs-number">100</span>) {
        <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;complete&quot;</span> });
      }
    });
    <span class="hljs-comment">// initial이면 0으로</span>
    <span class="hljs-keyword">if</span> (state === <span class="hljs-string">&quot;initial&quot;</span>) {
      value.<span class="hljs-title function_">jump</span>(<span class="hljs-number">0</span>);
      <span class="hljs-comment">// completing이면 100으로 간다.</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state === <span class="hljs-string">&quot;completing&quot;</span>) {
      value.<span class="hljs-title function_">set</span>(<span class="hljs-number">100</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">unsubscribe</span>();
    };
    <span class="hljs-comment">// value가 변화할 때 latest가 100이면 complete 상태로 만든다.</span>
    <span class="hljs-comment">// value, state 변화, 컴포넌트 언마운트 시마다 value.on 이라는 이벤트 핸들러는 사라진다.</span>
  }, [value, state]);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleProgress</span> = (<span class="hljs-params"><span class="hljs-attr">func</span>: () =&gt; <span class="hljs-built_in">void</span></span>) =&gt; {
    <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;start&quot;</span> });
    <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">func</span>();
      <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;done&quot;</span> });
    });
  };

  <span class="hljs-keyword">return</span> {
    state,
    value,
    <span class="hljs-attr">reset</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;reset&quot;</span> }),
    <span class="hljs-attr">progress</span>: handleProgress,
  };
}
</code></pre>
<p>정리하자면 다음과 같다.</p>
<ol>
<li>Progress Bar처럼 로딩을 표시하는 view 컴포넌트에 내려줄 useProgress 훅은 useReducer를 이용한 flux 패턴으로 세부 상태 관리는 감추어서 가독성을 높였다.</li>
<li>start, done으로 나누어져 사용하는 쪽에서 startTransition을 직접 구현해야했던 패턴에서 useProgress 훅으로 해당 훅을 숨기게 되었다.</li>
</ol>
<p>사용하는 쪽에서는</p>
<pre><code class="hljs language-tsx"><span class="hljs-string">&quot;use client&quot;</span>;

<span class="hljs-keyword">import</span> <span class="hljs-title class_">Link</span>, { <span class="hljs-title class_">LinkProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/link&quot;</span>;
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/navigation&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MouseEventHandler</span>, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-keyword">import</span> { useProgressBar } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../progress-bar/progress-bar&quot;</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LinkWithProgressProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">LinkProps</span> {
  <span class="hljs-attr">className</span>?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">LinkWithProgress</span>(<span class="hljs-params">{
  href,
  className,
  children,
  ...props
}: <span class="hljs-title class_">React</span>.<span class="hljs-title class_">PropsWithChildren</span>&lt;<span class="hljs-title class_">LinkWithProgressProps</span>&gt;</span>) {
  <span class="hljs-keyword">const</span> { progress } = <span class="hljs-title function_">useProgressBar</span>();
  <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();

  <span class="hljs-keyword">const</span> <span class="hljs-attr">handleClick</span>: <span class="hljs-title class_">MouseEventHandler</span>&lt;<span class="hljs-title class_">HTMLAnchorElement</span>&gt; = <span class="hljs-title function_">useCallback</span>(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      e.<span class="hljs-title function_">preventDefault</span>();
      <span class="hljs-title function_">progress</span>(<span class="hljs-function">() =&gt;</span> router.<span class="hljs-title function_">push</span>(href.<span class="hljs-title function_">toString</span>()));
    },
    [href, progress, router],
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{href}</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> {<span class="hljs-attr">...props</span>}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
  );
}
</code></pre>
<p>progress에 콜백을 넘기는 것 만으로도 progress Bar와 연결될 수 있게 되었다.</p>
<p>기존 LinkButton 에 progress를 추가해보면 다음과 같다.</p>
<pre><code class="hljs language-tsx"><span class="hljs-string">&quot;use client&quot;</span>;
<span class="hljs-comment">//...</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">LinkButton</span>(<span class="hljs-params">{
  href,
  children,
  btnStyle,
  btnSize,
  className,
  ...rest
}: <span class="hljs-title class_">LinkButtonProps</span></span>) {
  <span class="hljs-keyword">const</span> { progress } = <span class="hljs-title function_">useProgressBar</span>();
  <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();

  <span class="hljs-keyword">const</span> <span class="hljs-attr">handleClick</span>: <span class="hljs-title class_">MouseEventHandler</span>&lt;<span class="hljs-title class_">HTMLAnchorElement</span>&gt; = <span class="hljs-title function_">useCallback</span>(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      e.<span class="hljs-title function_">preventDefault</span>();
      <span class="hljs-title function_">progress</span>(<span class="hljs-function">() =&gt;</span> router.<span class="hljs-title function_">push</span>(href.<span class="hljs-title function_">toString</span>()));
    },
    [href, progress, router],
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span>
      <span class="hljs-attr">href</span>=<span class="hljs-string">{href}</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">{cn(buttonVariants({</span> <span class="hljs-attr">className</span>, <span class="hljs-attr">btnStyle</span>, <span class="hljs-attr">btnSize</span> }))}
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>
      {<span class="hljs-attr">...rest</span>}
    &gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
  );
}
</code></pre>
<p>상태 변화를 다른 함수와 함께 진행시킬 수 있는 startTransition으로 async await 처럼 사용하는 기법을 처음 보게 되었는데 자주 사용하게 될 것 같다!</p>
<p>useReducer를 활용한 flux 패턴으로 상태 관리를 처리하는 리팩토링을 진행하면서 코드가 간결해지는 것을 느꼈고 직접 느껴보니</p>
<p>복잡한 로직이 나올 때 useReducer나 zustand 같은 flux 패턴을 사용하여 구현된 기법을 사용하는 이유를 알게 되었다.</p>
<p>늘 느끼지만 모든 기술이 자신의 문제를 해결하기 위해 찾아볼 때 기억에 잘 새겨지는 것 같다. 이번에도 많이 배웠다.</p>
<h3 id="7" class="hltr-yellow">끝이 아니었다...</h3>
<p><img src="/images/2024-09-14/progress%20bar%20%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81%20%EC%97%90%EB%9F%AC.gif" alt=""/></p>
<p>리렌더링 에러 ㅎㅎ... 너무 느려서 확인해봤더니..</p>
<p><img src="/images/2024-09-14/Pasted%20image%2020240818002733.png" alt=""/></p>
<p>progress라는 함수를 받는 컴포넌트도 progress bar로 인해서 리렌더링 되는 상황이다</p>
<p>useContext는 상태를 주입하는 훅이기에 상태와 연결된 것 이외에도 하위 컴포넌트들을 리렌더링 시킨다.</p>
<p>progress bar라는 상태가 빈번하게 변화하는 컴포넌트가 최상위에 있어서 리렌더링이 발생하는 것.</p>
<p>zustand를 이용해서 상태를 &quot;관리&quot;하여 이를 해결해보려고 했지만</p>
<p><a href="https://github.com/pmndrs/zustand/discussions/885">https://github.com/pmndrs/zustand/discussions/885</a></p>
<p>useSyncExternalStore를 활용하는 zustand는 별도의 추가 없이는 startTransition과 함께 호환되지 않는다고 한다.</p>
<p><img src="/images/2024-09-14/Pasted%20image%2020240828114258.png" alt=""/></p>
<p>찾아보니 zustand 개발자가 커스텀 훅을 만들어놨다.</p>
<p><a href="https://www.npmjs.com/package/use-zustand">https://www.npmjs.com/package/use-zustand</a></p>
<p>이걸 사용했지만 next.js와 context api를 활용해서 연결된 방식과 결합하는 것이다 보니 개발자가 구상했었던 예외처리가 아닌 것 같았다.</p>
<p>구조적으로 context api를 활용해서 리렌더링을 만드는 것, zustand로 불완전한 로딩바를 만드는 것보다는 다른 방법을 생각하게 되었다.</p>
<p>그러다 기존 next.js를 활용한 사이트들에서 next-nprogress-bar 라는 라이브러리를 확인했다.</p>
<p>이는startTransition을 활용하는 방식이 아니었다. 시도해보기로 한다.</p>
<h2 id="8" class="hltr-orange">next-nprogress-bar</h2>
<pre><code class="hljs language-terminal">pnpm install next-nprogress-bar
</code></pre>
<pre><code class="hljs language-tsx"><span class="hljs-string">&quot;use client&quot;</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppProgressBar</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">ProgressBar</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next-nprogress-bar&quot;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Providers</span> = (<span class="hljs-params">{ children }: { children: React.ReactNode }</span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {children}
      <span class="hljs-tag">&lt;<span class="hljs-name">ProgressBar</span>
        <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;4px&quot;</span>
        <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#fffd00&quot;</span>
        <span class="hljs-attr">options</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">showSpinner:</span> <span class="hljs-attr">false</span> }}
        <span class="hljs-attr">shallowRouting</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Providers</span>;
</code></pre>
<s>진짜 억울할 정도로 너무 쉽다 ㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠ</s>
<p>html 자체에 스타일링을 줘서 작동하는 방식인 것 같았다. 여기에 시간을 너무 많이 쏟은 것 같아 라이브러리 분석은 다음에 꼭 해봐야겠다.</p>
<p>이제 Link 자체에 특별한 옵션을 안 넣으면 자동으로 progress bar가 동작한다고 한다.</p>
<h3 id="9" class="hltr-yellow">트러블 슈팅</h3>
<p>Next.js에서는 SearchParams에 따른 컴포넌트 렌더링이 많다.</p>
<p><img src="/images/2024-09-14/Pasted%20image%2020240914151931.png" alt=""/>
(searchParams에 따라서 정렬을 다르게 하는 자유게시판 페이지의 예시)</p>
<p>인기순에서 최신순으로 정렬기준을 바꿨을 때도 progress bar가 나오는데 좀더 자연스러울 것이다.</p>
<p>하지만 next-nprogress-bar에서는 이를 구현하지 않고 있었다.</p>
<p>따라서 useEffect를 활용하여 이 문제를 해결하였다.</p>
<pre><code class="hljs language-ts"><span class="hljs-string">&quot;use client&quot;</span>;

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppProgressBar</span>, startProgress } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next-nprogress-bar&quot;</span>;
<span class="hljs-keyword">import</span> { useSearchParams } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;next/navigation&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ReactNode</span>, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProgressBarProvider</span>(<span class="hljs-params">{
  children,
}: {
  children: ReactNode;
}</span>) {
  <span class="hljs-keyword">const</span> searchParams = <span class="hljs-title function_">useSearchParams</span>();

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">startProgress</span>();
  }, [searchParams]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {children}
      <span class="hljs-tag">&lt;<span class="hljs-name">AppProgressBar</span>
        <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;4px&quot;</span>
        <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#10b981&quot;</span>
        <span class="hljs-attr">options</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">showSpinner:</span> <span class="hljs-attr">false</span>,
          <span class="hljs-attr">minimum:</span> <span class="hljs-attr">0.15</span>,
          <span class="hljs-attr">easing:</span> &quot;<span class="hljs-attr">ease</span>&quot;,
          <span class="hljs-attr">speed:</span> <span class="hljs-attr">500</span>,
        }}
        <span class="hljs-attr">shallowRouting</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}

</code></pre>
<p>이제 정렬을 해도 progress bar가 움직이는 것을 확인할 수 있다.</p>
<p><img src="/images/2024-09-14/progressbar%EA%B2%8C%EC%8B%9C%ED%8C%90.gif" alt=""/></p>
<h2 id="10" class="hltr-orange">후기</h2>
<p>progress bar를 구현하기 위한 아이디어는 무엇이고 next.js에서는 그것을 어떻게 구현하는지를 알아보았다.</p>
<p>비록 프로젝트에는 라이브러리를 활용하는 쪽으로 적용되었지만 그 과정에서 동시성 렌더링을 통해서 구현한 코드를 분석하면서 많은 것을 배웠다.</p>
<p>더 성장해보자.</p>
<blockquote>
<p>꼼꼼 프로젝트 진행 중에 겪은 경험들입니다. 오늘도 많이 성장한 것 같아요!</p>
<p>읽어주셔서 감사합니다! 지켜봐주세요!</p>
<p>감사합니다.</p>
</blockquote></section></section></section><!--$--><!--/$--><section></section></div></div><script>$RB=[];$RV=function(b){$RT=performance.now();for(var a=0;a<b.length;a+=2){var c=b[a],e=b[a+1];null!==e.parentNode&&e.parentNode.removeChild(e);var f=c.parentNode;if(f){var g=c.previousSibling,h=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d||"/&"===d)if(0===h)break;else h--;else"$"!==d&&"$?"!==d&&"$~"!==d&&"$!"!==d&&"&"!==d||h++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;e.firstChild;)f.insertBefore(e.firstChild,c);g.data="$";g._reactRetry&&g._reactRetry()}}b.length=0};
$RC=function(b,a){if(a=document.getElementById(a))(b=document.getElementById(b))?(b.previousSibling.data="$~",$RB.push(b,a),2===$RB.length&&(b="number"!==typeof $RT?0:$RT,a=performance.now(),setTimeout($RV.bind(null,$RB),2300>a&&2E3<a?2300-a:b+300-a))):a.parentNode.removeChild(a)};$RC("B:0","S:0")</script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[2658,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"464\",\"static/chunks/464-cfefa5bf5f0e766b.js\",\"559\",\"static/chunks/559-04b70e00e58d5c4b.js\",\"177\",\"static/chunks/app/layout-ab4602898f2b74c8.js\"],\"GoogleTagManager\"]\n3:I[438,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"464\",\"static/chunks/464-cfefa5bf5f0e766b.js\",\"559\",\"static/chunks/559-04b70e00e58d5c4b.js\",\"177\",\"static/chunks/app/layout-ab4602898f2b74c8.js\"],\"default\"]\n4:I[6148,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"464\",\"static/chunks/464-cfefa5bf5f0e766b.js\",\"559\",\"static/chunks/559-04b70e00e58d5c4b.js\",\"177\",\"static/chunks/app/layout-ab4602898f2b74c8.js\"],\"SidebarProvider\"]\n5:I[8491,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"464\",\"static/chunks/464-cfefa5bf5f0e766b.js\",\"559\",\"static/chunks/559-04b70e00e58d5c4b.js\",\"177\",\"static/chunks/app/layout-ab4602898f2b74c8.js\"],\"default\"]\nc:I[6664,[\"219\",\"static/chunks/app/global-error-b0d0eb5f8d1d5f85.js\"],\"default\"]\n:HL[\"https://codefug.github.io/_next/static/media/518331124efecf5c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"https://codefug.github.io/_next/static/css/96413cdc35608d81.css\",\"style\"]\n:HL[\"https://codefug.github.io/_next/static/css/0944061766e538e2.css\",\"style\"]\n:HL[\"https://codefug.github.io/_next/static/css/fc37ac2b1a278e8c.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"SidpDY09K3KAz3NqdkUP0\",\"p\":\"https://codefug.github.io\",\"c\":[\"\",\"posts\",\"2024-09-14-2\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2024-09-14-2\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://codefug.github.io/_next/static/css/96413cdc35608d81.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"https://codefug.github.io/_next/static/css/0944061766e538e2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"$L2\",null,{\"gtmId\":\"$undefined\"}],[\"$\",\"body\",null,{\"className\":\"__className_75a1fa antialiased\",\"children\":[\"$\",\"$L3\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L4\",null,{\"defaultOpen\":false,\"children\":[[\"$\",\"$L5\",null,{\"totalFrontMatterList\":[{\"id\":\"2025-07-20\",\"title\":\"집합\",\"excerpt\":\"JS의 집합에 대해서 알아보자.\",\"date\":\"2025-07-20\",\"categories\":[\"data-structure\",\"javascript\"],\"header\":{\"teaser\":\"/images/2025-07-20/Pasted image 20250720151432.png\"}},{\"id\":\"2025-06-21\",\"title\":\"트리\",\"excerpt\":\"JS의 트리에 대해서 알아보자.\",\"date\":\"2025-06-21\",\"categories\":[\"data-structure\",\"javascript\"],\"header\":{\"teaser\":\"/images/2025-06-21/Pasted image 20250621101921.png\"}},{\"id\":\"2025-06-14\",\"title\":\"해시\",\"excerpt\":\"JS의 해시에 대해서 알아보자.\",\"date\":\"2025-06-14\",\"categories\":[\"data-structure\",\"javascript\"],\"header\":{\"teaser\":\"/images/2025-06-14/Pasted image 20250617224108.png\"}},{\"id\":\"2025-06-07\",\"title\":\"큐\",\"excerpt\":\"JS의 큐에 대해서 알아보자.\",\"date\":\"2025-06-07\",\"categories\":[\"data-structure\",\"javascript\"],\"header\":{\"teaser\":\"/images/2025-06-07/Pasted image 20250617212028.png\"}},{\"id\":\"2025-05-31\",\"title\":\"스택\",\"excerpt\":\"JS의 스택에 대해서 알아보자.\",\"date\":\"2025-05-31\",\"categories\":[\"data-structure\",\"javascript\"],\"header\":{\"teaser\":\"/images/2025-05-31/Pasted image 20250617080823.png\"}},{\"id\":\"2025-05-24\",\"title\":\"배열\",\"excerpt\":\"JS의 배열에 대해서 알아보자.\",\"date\":\"2025-05-24\",\"categories\":[\"data-structure\",\"javascript\"],\"header\":{\"teaser\":\"/images/2025-05-24/Pasted image 20250615181200.png\"}},{\"id\":\"2024-11-10\",\"title\":\"Asynchronous JavaScript\",\"excerpt\":\"microtask queue, macrotask queue, call stack, web api와 관련된 비동기 동작 방식, 비동기 관련 역사와 비동기 코드의 다양한 활용법들을 알아보자.\",\"date\":\"2024-11-10\",\"categories\":[\"javascript\"],\"header\":{\"teaser\":\"/images/logos/JS.svg\"}},{\"id\":\"2024-09-14-4\",\"title\":\"(꼼꼼 프로젝트) streaming 방식의 tanstack query\",\"excerpt\":\"infinite scroll, optimistic update 그리고 streaming 방식이 결합된 쿼리 처리 ( useSuspenseQuery, useSuspenseInfiniteQuery )\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/tanstackQuery.png\"}},{\"id\":\"2024-09-14-3\",\"title\":\"(꼼꼼 프로젝트) 클라이언트와 서버 둘다 호환되는 fetch 구현\",\"excerpt\":\"서버 액션을 활용한 refresh token rotation, 커링 함수를 이용한 리팩토링\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/fetch.png\"}},{\"id\":\"2024-09-14-2\",\"title\":\"(꼼꼼 프로젝트) startTransition, progress bar 구현에 대한 고민\",\"excerpt\":\"progress bar 로직 연구하기(startTransition), next-nprogress-bar\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/nprogress.png\"}},{\"id\":\"2024-09-14-1\",\"title\":\"(꼼꼼 프로젝트) toss slash 분석, zustand와 연결된 커스텀 overlay 훅 구현\",\"excerpt\":\"stacking context, compound pattern, 전역 상태를 활용한다는 것의 의미, 토스 개발자 실력 흡수하기\",\"date\":\"2024-09-14\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/toss.png\"}},{\"id\":\"2024-09-11\",\"title\":\"(꼼꼼 프로젝트) 공통 버튼 컴포넌트의 종류를 쉽게 관리하고 누구나 쉽게 확인할 수 있게 하는 방법\",\"excerpt\":\"tailwind로 조건부 처리를 간편하게 하는 방법, 비개발자도 스타일을 쉽게 확인할 수 있도록 storybook 연동\",\"date\":\"2024-09-11\",\"categories\":[\"kkom-kkom\"],\"header\":{\"teaser\":\"/images/logos/storybook.png\"}},{\"id\":\"2024-07-22-2\",\"title\":\"(급페이 프로젝트) 개발환경에만 집중하기 위한 여정\",\"excerpt\":\"접근 제한을 위한 미들웨어 처리, vercel CLI을 이용한 organization 무료 자동 배포, 프리뷰\",\"date\":\"2024-07-22\",\"categories\":[\"gheuppay\"],\"header\":{\"teaser\":\"/images/logos/vercel.png\"}},{\"id\":\"2024-07-22-1\",\"title\":\"(급페이 프로젝트) 알림창 무한 스크롤을 위한 여정 (mock fetching을 위한 MSW 도입기)\",\"excerpt\":\"msw를 활용해서 프론트엔드 개발이 다 되어있지 않은 상태에서도 무한 스크롤 구현을 확인할 수 있게 되었습니다.\",\"date\":\"2024-07-22\",\"categories\":[\"gheuppay\"],\"header\":{\"teaser\":\"/images/logos/msw.png\"}},{\"id\":\"2024-07-21\",\"title\":\"(급페이 프로젝트) 카드 렌더링을 최적화하여 UX를 향상시키기 위한 머나먼 여정\",\"excerpt\":\"server component 설계를 이용한 suspense 적극 활용, 이를 위해서 next cookie를 사용하면서 겪은 문제들을 적은 글입니다.\",\"date\":\"2024-07-21\",\"categories\":[\"gheuppay\"],\"header\":{\"teaser\":\"/images/logos/next-cookie.png\"}},{\"id\":\"2024-06-18\",\"title\":\"React Testing\",\"excerpt\":\"React Testing Library, Vitest, Jest\",\"date\":\"2024-06-18\",\"categories\":[\"reactdeepdive\"],\"header\":{\"teaser\":\"/images/logos/reactdeepdive.jpg\"}},{\"id\":\"2024-06-17\",\"title\":\"로그인 구현 (zustand, zod + react-hook-form, RTR)\",\"excerpt\":\"zustand를 이용한 로그인 상태 전역 관리, zod를 이용한 간단한 스키마 전개, react-hook-form을 이용한 간단한 validation, axios를 이용한 간단한 api 요청 처리\",\"date\":\"2024-06-17\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/zod.png\"}},{\"id\":\"2024-06-15\",\"title\":\"Dev tool\",\"excerpt\":\"리액트 과거, 현재, 미래\",\"date\":\"2024-06-15\",\"categories\":[\"web\"],\"header\":{\"teaser\":\"/images/logos/reactdeepdive.jpg\"}},{\"id\":\"2024-06-14\",\"title\":\"마이그레이션 중 발생한 Vite 환경 변수 처리\",\"excerpt\":\"Vite_ENV\",\"date\":\"2024-06-14\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/react.png\"}},{\"id\":\"2024-06-10\",\"title\":\"React Debugging\",\"excerpt\":\"react-dev-tools 정리, 실습\",\"date\":\"2024-06-10\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/react.png\"}},{\"id\":\"2024-06-08\",\"title\":\"자잘한 Next.js 트러블 슈팅들\",\"excerpt\":\"react-responsive를 사용하지 못하는 상황, dotenv 사용시 문제 발생\",\"date\":\"2024-06-08\",\"categories\":[\"nextjs\"],\"header\":{\"teaser\":\"/images/logos/Nextjs.png\"}},{\"id\":\"2024-05-31\",\"title\":\"Next는 왜 쓸까\",\"excerpt\":\"CSR SSG SSR\",\"date\":\"2024-05-31\",\"categories\":[\"nextjs\"],\"header\":{\"teaser\":\"/images/logos/Nextjs.png\"}},{\"id\":\"2024-05-23\",\"title\":\"리액트는 왜 쓸까\",\"excerpt\":\"리액트 과거, 현재, 미래\",\"date\":\"2024-05-23\",\"categories\":[\"react\"],\"header\":{\"teaser\":\"/images/logos/reactdeepdive.jpg\"}},{\"id\":\"2024-05-22\",\"title\":\"TS는 왜 쓸까 (위대한 TS)\",\"excerpt\":\"JS를 완벽하게 하기 위한 여정\",\"date\":\"2024-05-22\",\"categories\":[\"typescript\"],\"header\":{\"teaser\":\"/images/logos/TS.png\"}},{\"id\":\"2024-05-20\",\"title\":\"Fandom-k 프로젝트 회고3\",\"excerpt\":\"Github Actions, 최종 결과\",\"date\":\"2024-05-20\",\"categories\":[\"fandomk\"],\"header\":{\"teaser\":\"/images/logos/githubActions.png\"}},{\"id\":\"2024-05-19\",\"title\":\"Fandom-k 프로젝트 회고2\",\"excerpt\":\"fetch, scroll to Top, infinite scroll 라이브러리 제거\",\"date\":\"2024-05-19\",\"categories\":[\"fandomk\"],\"header\":{\"teaser\":\"/images/logos/fetch.png\"}},{\"id\":\"2024-05-18\",\"title\":\"Fandom-k 프로젝트 회고1\",\"excerpt\":\"팀 프로젝트 세팅, infinite scroll, skeleton\",\"date\":\"2024-05-18\",\"categories\":[\"fandomk\"],\"header\":{\"teaser\":\"/images/logos/infinite-scroll.png\"}}]}],\"$L6\"]}]}]}]]}]]}],{\"children\":[\"posts\",\"$L7\",{\"children\":[[\"id\",\"2024-09-14-2\",\"d\"],\"$L8\",{\"children\":[\"__PAGE__\",\"$L9\",{},null,false]},null,false]},null,false]},[\"$La\",[],[]],false],\"$Lb\",false]],\"m\":\"$undefined\",\"G\":[\"$c\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"d:I[1655,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"464\",\"static/chunks/464-cfefa5bf5f0e766b.js\",\"559\",\"static/chunks/559-04b70e00e58d5c4b.js\",\"177\",\"static/chunks/app/layout-ab4602898f2b74c8.js\"],\"default\"]\ne:I[4483,[],\"\"]\nf:I[9503,[],\"\"]\n10:I[762,[\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"345\",\"static/chunks/app/not-found-8cae470c11fa9853.js\"],\"\"]\n11:I[8792,[\"507\",\"static/chunks/app/posts/%5Bid%5D/layout-09cee8bbecb3ba10.js\"],\"default\"]\n13:I[2481,[],\"OutletBoundary\"]\n15:I[9055,[],\"AsyncMetadataOutlet\"]\n17:I[2487,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-9b07e941c08849ec.js\"],\"Image\"]\n18:I[2481,[],\"ViewportBoundary\"]\n1a:I[2481,[],\"MetadataBoundary\"]\n1b:\"$Sreact.suspense\"\n6:[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h2\",null,{\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"잘못된 페이지에요!\"}],[\"$\",\"$L10\",null,{\"href\":\"/\",\"children\":\"홈으로 돌아가기\"}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]\n7:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n8:[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://codefug.github.io/_next/static/css/fc37ac2b1a278e8c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"prose mx-auto mb-10 overflow-auto dark:"])</script><script>self.__next_f.push([1,"prose-invert\",\"children\":[[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"$L11\",null,{}]]}]]}]\n9:[\"$\",\"$1\",\"c\",{\"children\":[\"$L12\",null,[\"$\",\"$L13\",null,{\"children\":[\"$L14\",[\"$\",\"$L15\",null,{\"promise\":\"$@16\"}]]}]]}]\na:[\"$\",\"div\",\"l\",{\"className\":\"flex h-full items-center justify-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"scale-[1.15] animate-pulse transition-transform\",\"children\":[\"$\",\"$L17\",null,{\"src\":\"/images/main-logo.png\",\"alt\":\"로딩 중...\",\"width\":120,\"height\":120,\"className\":\"drop-shadow-lg\"}]}],[\"$\",\"p\",null,{\"className\":\"mt-6 animate-pulse text-lg font-bold text-gray-600\",\"children\":\"Codefug Blog\"}]]}]}]\nb:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L18\",null,{\"children\":\"$L19\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L1a\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$1b\",null,{\"fallback\":null,\"children\":\"$L1c\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"19:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n14:null\n"])</script><script>self.__next_f.push([1,"1d:I[7071,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"16:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Codefug Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"프로젝트 경험과 개발 노트를 공유하는 블로그\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Codefug\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"개발,프로그래밍,React,Next.js,JavaScript,TypeScript,블로그\"}],[\"$\",\"meta\",\"4\",{\"name\":\"creator\",\"content\":\"Codefug\"}],[\"$\",\"meta\",\"5\",{\"name\":\"publisher\",\"content\":\"Codefug\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"Codefug Blog\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"project experiences and development notes\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://codefug-blog.vercel.app\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://codefug.github.io/images/main-logo.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image:alt\",\"content\":\"Codefug Blog\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\"Codefug Blog\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"project experiences and development notes\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image\",\"content\":\"https://codefug.github.io/images/main-logo.png\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image:alt\",\"content\":\"Codefug Blog\"}],[\"$\",\"link\",\"17\",{\"rel\":\"icon\",\"href\":\"/icon.ico?f00882ffa3186f37\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"$L1d\",\"18\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"1c:\"$16:metadata\"\n"])</script><script>self.__next_f.push([1,"1e:I[1457,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-9b07e941c08849ec.js\"],\"GtmPageView\"]\n1f:I[4662,[\"487\",\"static/chunks/487-d14c2623a9f3fdfd.js\",\"45\",\"static/chunks/45-a3006a7b4d051491.js\",\"762\",\"static/chunks/762-fb8a01463e9bf4fd.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-9b07e941c08849ec.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"section\",null,{\"children\":[[\"$\",\"$L1e\",null,{\"slug\":\"2024-09-14-2\"}],[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"relative mb-6 h-[300px] w-full overflow-hidden rounded-xl sm:h-[400px] md:h-[450px]\",\"children\":[[\"$\",\"$L17\",null,{\"src\":\"/images/logos/nprogress.png\",\"alt\":\"(꼼꼼 프로젝트) startTransition, progress bar 구현에 대한 고민\",\"fill\":true,\"sizes\":\"(max-width: 768px) 100vw, 1200px\",\"priority\":true,\"className\":\"object-cover object-center transition-transform duration-500 hover:scale-105\"}],[\"$\",\"div\",null,{\"className\":\"absolute inset-0 bg-gradient-to-b from-transparent to-black/70\"}],[\"$\",\"div\",null,{\"className\":\"absolute left-4 top-4 flex flex-wrap gap-2 sm:left-6 sm:top-6\",\"children\":[[\"$\",\"div\",\"kkom-kkom\",{\"className\":\"inline-flex items-center rounded-md border px-2.5 py-0.5 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-white/90 text-xs font-medium text-gray-800 hover:bg-white sm:text-sm\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-tag mr-1 h-3 w-3\",\"children\":[[\"$\",\"path\",\"vktsd0\",{\"d\":\"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z\"}],[\"$\",\"circle\",\"kqv944\",{\"cx\":\"7.5\",\"cy\":\"7.5\",\"r\":\".5\",\"fill\":\"currentColor\"}],\"$undefined\"]}],\" \",\"kkom-kkom\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mb-6 space-y-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-0 text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-50 sm:text-4xl md:text-5xl\",\"children\":\"(꼼꼼 프로젝트) startTransition, progress bar 구현에 대한 고민\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center justify-end gap-4 text-sm text-gray-600 dark:text-gray-400\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-calendar-days mr-2 h-4 w-4\",\"children\":[[\"$\",\"path\",\"1cmpym\",{\"d\":\"M8 2v4\"}],[\"$\",\"path\",\"4m81vk\",{\"d\":\"M16 2v4\"}],[\"$\",\"rect\",\"1hopcy\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"4\",\"rx\":\"2\"}],[\"$\",\"path\",\"8toen8\",{\"d\":\"M3 10h18\"}],[\"$\",\"path\",\"6423bh\",{\"d\":\"M8 14h.01\"}],[\"$\",\"path\",\"1etili\",{\"d\":\"M12 14h.01\"}],[\"$\",\"path\",\"1gbofw\",{\"d\":\"M16 14h.01\"}],[\"$\",\"path\",\"lrp35t\",{\"d\":\"M8 18h.01\"}],[\"$\",\"path\",\"mhygvu\",{\"d\":\"M12 18h.01\"}],[\"$\",\"path\",\"kzsmim\",{\"d\":\"M16 18h.01\"}],\"$undefined\"]}],[\"$\",\"time\",null,{\"dateTime\":\"2024-09-14\",\"children\":\"2024-09-14\"}]]}]}],[\"$\",\"p\",null,{\"className\":\"text-lg leading-relaxed text-gray-600 dark:text-gray-300 md:text-xl\",\"children\":\"progress bar 로직 연구하기(startTransition), next-nprogress-bar\"}]]}],[\"$\",\"div\",null,{\"className\":\"border-b border-gray-200 dark:border-gray-800\"}]]}],[\"$\",\"section\",null,{\"className\":\"lg:flex lg:items-baseline\",\"children\":[[\"$\",\"$L1f\",null,{}],[\"$\",\"section\",null,{\"className\":\"max-w-full\",\"children\":[[\"$\",\"h1\",null,{\"id\":0,\"className\":\"hltr-red\",\"children\":\"배경\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/progressbar%20%EC%98%88%EC%8B%9C.gif\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"위의 사진은 Next.js로 만든 코드잇 사이트이다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Link 컴포넌트인 탭 요소를 누르면 주소가 바뀌면서 progress bar가 동작하는 것을 확인할 수 있다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"꼼꼼 프로젝트는 Next.js로 만들어졌기 때문에 url이 변경되면서 렌더링이 일어나는 경우가 많다. (searchParams와 관련된 렌더링도 많다.)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이때 progress bar를 추가하면 UX가 크게 향상될 것이라고 생각하고 고민을 시작했다.\"}],\"\\n\",[\"$\",\"h1\",null,{\"id\":1,\"className\":\"hltr-red\",\"children\":\"구현\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Next는 router event를 외부에 노출시키지 않아서 페이지 바꿀 때 로딩 생기는 걸 구현하는게 매우 어렵다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이를 해결한 간단한 라이브러리도 찾았으나 실제 동작 과정을 알고 싶어서 실제로 구현된 코드를 위주로 연구를 시작했다.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":2,\"className\":\"hltr-orange\",\"children\":\"코드 분석\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://buildui.com/posts/global-progress-in-nextjs\",\"children\":\"https://buildui.com/posts/global-progress-in-nextjs\"}]}],\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"p\",null,{\"children\":\"위의 포스팅을 분석해보았다.\"}]\n21:[\"$\",\"h3\",null,{\"id\":3,\"className\":\"hltr-yellow\",\"children\":\"layout.tsx\"}]\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// layout.tsx\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ProgressBarLink\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ProgressBar\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./progress-bar\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"Layout\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"{ children }: { children: ReactNode }\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\"\u003e\"]}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBar\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"fixed top-0 h-1 bg-sky-500\\\"\"}],\" /\u003e\"]}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"header\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"border-b border-gray-700\\\"\"}],\"\u003e\"]}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"nav\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"m-4 flex gap-4\\\"\"}],\"\u003e\"]}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"/demo-1\\\"\"}],\"\u003e\"]}],\"Home\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\"\u003e\"]}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"/demo-1/posts/1\\\"\"}],\"\u003e\"]}],\"Post 1\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\"\u003e\"]}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"/demo-1/posts/2\\\"\"}],\"\u003e\"]}],\"Post 2\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\"\u003e\"]}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"/demo-1/posts/3\\\"\"}],\"\u003e\"]}],\"Post 3\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarLink\"}],\"\u003e\"]}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"nav\"}],\"\u003e\"]}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"header\"}],\"\u003e\"]}],\"\\n\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"m-4\\\"\"}],\"\u003e\"]}],\"{children}\",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",\"$L5e\",\"\u003e\"]}],\"\\n      \",\"$L5f\"]}],\"\\n    \u003c/div\u003e\\n  );\\n}\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"h3\",null,{\"id\":4,\"className\":\"hltr-yellow\",\"children\":\"progress-bar\"}]\n"])</script><script>self.__next_f.push([1,"24:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// progress-bar\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"AnimatePresence\"}],\",\\n  motion,\\n  useMotionTemplate,\\n  useSpring,\\n} \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"framer-motion\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Link\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next/link\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useRouter } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next/navigation\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ComponentProps\"}],\",\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\",\\n  createContext,\\n  startTransition,\\n  useContext,\\n  useEffect,\\n  useRef,\\n  useState,\\n} \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// createContext로 전역 상태 지정\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ProgressBarContext\"}],\" = createContext\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReturnType\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"typeof\"}],\" useProgress\u003e | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\"\u003e(\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\",\\n);\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useProgressBar 라는 훅으로 useProgress와 연결해서 사용하고자 함.\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgressBar\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}],\" progress = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useContext\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ProgressBarContext\"}],\");\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (progress === \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"throw\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Error\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"Need to be inside provider\\\"\"}],\");\\n  }\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" progress;\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Progress Bar 컴포넌트 그 자체\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"ProgressBar\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{\\n  className,\\n  children,\\n}: {\\n  className: \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\";\\n  children: ReactNode;\\n}\"]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useProgress 사용\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}],\" progress = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgress\"}],\"();\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useMotionTemplate: 여러 motion value를 하나의 motion value로 만드는 훅\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 여기서는 width: ~% 이런식으로 길어지게 만들어 놓음. 내부적으로 progress.value가 100이 되면 complete임\"}],\"\\n  \",\"$L60\",\" width = useMotionTemplate\",\"$L61\",\";\\n\\n  \",\"$L62\",\" (\\n    \",\"$L63\",\"\\n  );\\n}\\n\\n\",\"$L64\",\"\\n\",\"$L65\",\" \",\"$L66\",\" \",\"$L67\",\"(\",\"$L68\",\") {\\n  \",\"$L69\",\"\\n  \",\"$L6a\",\" progress = \",\"$L6b\",\"();\\n  \",\"$L6c\",\" router = \",\"$L6d\",\"();\\n\\n  \",\"$L6e\",\" (\\n    \",\"$L6f\",\"\\n  );\\n}\\n\\n\",\"$L70\",\"\\n\",\"$L71\",\" \",\"$L72\",\"(\",\"$L73\",\") {\\n  \",\"$L74\",\"\\n  \",\"$L75\",\" [state, setState] = useState\u003c\\n    \",\"$L76\",\" | \",\"$L77\",\" | \",\"$L78\",\" | \",\"$L79\",\"\\n  \u003e(\",\"$L7a\",\");\\n\\n  \",\"$L7b\",\"\\n  \",\"$L7c\",\" value = \",\"$L7d\",\"(\",\"$L7e\",\", {\\n    \",\"$L7f\",\"\\n    \",\"$L80\",\": \",\"$L81\",\",\\n    \",\"$L82\",\"\\n    \",\"$L83\",\": \",\"$L84\",\",\\n    \",\"$L85\",\"\\n    \",\"$L86\",\": \",\"$L87\",\",\\n    \",\"$L88\",\"\\n    \",\"$L89\",\": \",\"$L8a\",\",\\n  });\\n\\n  \",\"$L8b\",\"\\n  \",\"$L8c\",\"(\\n    \",\"$L8d\",\" {\\n      \",\"$L8e\",\"\\n      \",\"$L8f\",\" (value.\",\"$L90\",\"() === \",\"$L91\",\") {\\n        \",\"$L92\",\"\\n        value.\",\"$L93\",\"(\",\"$L94\",\");\\n      }\\n\\n      \",\"$L95\",\"\\n      \",\"$L96\",\" current = value.\",\"$L97\",\"();\\n\\n      \",\"$L98\",\"\\n      \",\"$L99\",\" diff;\\n\\n      \",\"$L9a\",\"\\n      \",\"$L9b\",\" (current === \",\"$L9c\",\") {\\n        diff = \",\"$L9d\",\";\\n        \",\"$L9e\",\"\\n      } \",\"$L9f\",\" \",\"$La0\",\" (current \u003c \",\"$La1\",\") {\\n        diff = \",\"$La2\",\"(\",\"$La3\",\", \",\"$La4\",\");\\n        \",\"$La5\",\"\\n      } \",\"$La6\",\" {\\n        diff = \",\"$La7\",\"(\",\"$La8\",\", \",\"$La9\",\");\\n      }\\n\\n      \",\"$Laa\",\"\\n      value.\",\"$Lab\",\"(\",\"$Lac\",\".\",\"$Lad\",\"(current + diff, \",\"$Lae\",\"));\\n    },\\n    \",\"$Laf\",\"\\n    state === \",\"$Lb0\",\" ? \",\"$Lb1\",\" : \",\"$Lb2\",\",\\n  );\\n\\n  \",\"$Lb3\",\"(\",\"$Lb4\",\" {\\n    \",\"$Lb5\",\"\\n    \",\"$Lb6\",\" (state === \",\"$Lb7\",\") {\\n      value.\",\"$Lb8\",\"(\",\"$Lb9\",\");\\n      \",\"$Lba\",\"\\n    } \",\"$Lbb\",\" \",\"$Lbc\",\" (state === \",\"$Lbd\",\") {\\n      value.\",\"$Lbe\",\"(\",\"$Lbf\",\");\\n    }\\n\\n    \",\"$Lc0\",\"\\n    \",\"$Lc1\",\" value.\",\"$Lc2\",\"(\",\"$Lc3\",\", \",\"$Lc4\",\" {\\n      \",\"$Lc5\",\"\\n      \",\"$Lc6\",\" (latest === \",\"$Lc7\",\") {\\n        \",\"$Lc8\",\"(\",\"$Lc9\",\");\\n      }\\n    });\\n    \",\"$Lca\",\"\\n  }, [value, state]);\\n\\n  \",\"$Lcb\",\" \",\"$Lcc\",\"(\",\"$Lcd\",\") {\\n    \",\"$Lce\",\"\\n    \",\"$Lcf\",\"(\",\"$Ld0\",\");\\n  }\\n\\n  \",\"$Ld1\",\" \",\"$Ld2\",\"(\",\"$Ld3\",\") {\\n    \",\"$Ld4\",\"\\n    \",\"$Ld5\",\"(\",\"$Ld6\",\");\\n  }\\n\\n  \",\"$Ld7\",\" \",\"$Ld8\",\"(\",\"$Ld9\",\") {\\n    \",\"$Lda\",\"\\n    \",\"$Ldb\",\"(\",\"$Ldc\",\"\\n      state === \",\"$Ldd\",\" || state === \",\"$Lde\",\" ? \",\"$Ldf\",\" : state,\\n    );\\n  }\\n  \",\"$Le0\",\" { state, value, start, done, reset };\\n}\\n\\n\",\"$Le1\",\"\\n\",\"$Le2\",\" \",\"$Le3\",\"(\",\"$Le4\",\") {\\n  \",\"$Le5\",\" \",\"$Le6\",\".\",\"$Le7\",\"(\",\"$Le8\",\".\",\"$Le9\",\"() * (max - min + \",\"$Lea\",\")) + min;\\n}\\n\\n\",\"$Leb\",\"\\n\",\"$Lec\",\" \",\"$Led\",\"(\",\"$Lee\",\") {\\n  \",\"$Lef\",\"\\n  \",\"$Lf0\",\" savedCallback = \",\"$Lf1\",\"(callback);\\n\\n  \",\"$Lf2\",\"(\",\"$Lf3\",\" {\\n    \",\"$Lf4\",\"\\n    savedCallback.\",\"$Lf5\",\" = callback;\\n  }, [callback]);\\n\\n  \",\"$Lf6\",\"(\",\"$Lf7\",\" {\\n    \",\"$Lf8\",\"\\n    \",\"$Lf9\",\" \",\"$Lfa\",\"(\",\"$Lfb\",\") {\\n      savedCallback.\",\"$Lfc\",\"();\\n    }\\n\\n    \",\"$Lfd\",\" (delay !== \",\"$Lfe\",\") {\\n      \",\"$Lff\",\"\\n      \",\"$L100\",\"();\\n\\n      \",\"$L101\",\"\\n      \",\"$L102\",\" id = \",\"$L103\",\"(tick, delay);\\n      \",\"$L104\",\"\\n      \",\"$L105\",\" \",\"$L106\",\" \",\"$L107\",\"(id);\\n    }\\n  }, [delay]);\\n}\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"25:[\"$\",\"h3\",null,{\"id\":5,\"className\":\"hltr-yellow\",\"children\":\"분석 결과\"}]\n26:[\"$\",\"p\",null,{\"children\":\"굉장히 복잡한 코드가 나왔지만 결론적으로는 progress bar가 실제 로딩 퍼센트와 관련이 없어도 된다는 아이디어로 시작되는 것 같다.\"}]\n27:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"progress bar는 동작시 바로 15로 간다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"이후 progress bar는 15 부터 99까지 랜덤으로 채워진다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"99가 되었을 때 startTransition을 이용해서 router.push와 progress bar의 언마운트가 동시에 된다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"progress bar의 언마운트 시에 Framer-Motion의 AnimatePresense를 이용해서 언마운트되더라도 컴포넌트가 애니메이션 종료까지 남아있게 된다. \u003e 부드러운 언마운트가 이루어 진다.\"}],\"\\n\"]}]\n28:[\"$\",\"p\",null,{\"children\":\"여기서 startTransition을 이용한 동시성 렌더링으로 progress bar가 언마운트 되는 로직을 router.push와 함께 넣어둔 부분이 굉장히 인상 깊었다.\"}]\n29:[\"$\",\"p\",null,{\"children\":\"분석은 끝났으니 이제 활용할 방법을 찾아보자.\"}]\n2a:[\"$\",\"p\",null,{\"children\":\"우리 프로젝트를 리팩토링할만한 것들은 다음과 같다.\"}]\n2b:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"우리 만의 LinkButton이 있기 때문에 Link를 따로 만들지 않고 훅에서 로직을 받아와서 내려주는 방식으로 리팩토링이 쉽게 해줘야 한다. =\u003e 훅으로 따로 생성, 내부 로직은 감춤\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"useReducer를 이용해서 state 관리를 가독성 있게 하자.\"}],\"\\n\"]}]\n2c:[\"$\",\"h2\",null,{\"id\":6,\"className\":\"hltr-orange\",\"children\":\"리팩토링 결과\"}]\n"])</script><script>self.__next_f.push([1,"2d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { rand } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"@/utils/get-rand\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useSpring } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"framer-motion\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { startTransition, useEffect, useReducer, useRef } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" useInterval \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"./use-interval\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"StateType\"}],\" = \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"completing\\\"\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ActionType\"}],\" =\\n  | { \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"start\\\"\"}],\" }\\n  | { \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"done\\\"\"}],\" }\\n  | { \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"reset\\\"\"}],\" }\\n  | { \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}],\" };\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"reducer\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"state\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"StateType\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"action\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ActionType\"}]]}],\"): \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"StateType\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"switch\"}],\" (action.\",[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"type\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"start\\\"\"}],\":\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}],\";\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"done\\\"\"}],\":\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" state === \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}],\" || state === \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}],\"\\n        ? \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"completing\\\"\"}],\"\\n        : state;\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"reset\\\"\"}],\":\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}],\";\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"case\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}],\":\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}],\";\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"default\"}],\":\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"throw\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",\"$L108\",\"(\",\"$L109\",\");\\n  }\\n}\\n\\n\",\"$L10a\",\"\\n\",\"$L10b\",\" \",\"$L10c\",\" \",\"$L10d\",\"(\",\"$L10e\",\") {\\n  \",\"$L10f\",\"\\n  \",\"$L110\",\" [state, dispatch] = \",\"$L111\",\"(reducer, \",\"$L112\",\");\\n\\n  \",\"$L113\",\"\\n  \",\"$L114\",\" value = \",\"$L115\",\"(\",\"$L116\",\", {\\n    \",\"$L117\",\"\\n    \",\"$L118\",\": \",\"$L119\",\",\\n    \",\"$L11a\",\"\\n    \",\"$L11b\",\": \",\"$L11c\",\",\\n    \",\"$L11d\",\"\\n    \",\"$L11e\",\": \",\"$L11f\",\",\\n    \",\"$L120\",\"\\n    \",\"$L121\",\": \",\"$L122\",\",\\n  });\\n\\n  \",\"$L123\",\"\\n  \",\"$L124\",\"(\\n    \",\"$L125\",\" {\\n      \",\"$L126\",\"\\n      \",\"$L127\",\" (value.\",\"$L128\",\"() === \",\"$L129\",\") {\\n        \",\"$L12a\",\"\\n        value.\",\"$L12b\",\"(\",\"$L12c\",\");\\n      }\\n      \",\"$L12d\",\"\\n      \",\"$L12e\",\" current = value.\",\"$L12f\",\"();\\n      \",\"$L130\",\"\\n      \",\"$L131\",\" diff;\\n      \",\"$L132\",\"\\n      \",\"$L133\",\" (current === \",\"$L134\",\") {\\n        diff = \",\"$L135\",\";\\n        \",\"$L136\",\"\\n      } \",\"$L137\",\" \",\"$L138\",\" (current \u003c \",\"$L139\",\") {\\n        diff = \",\"$L13a\",\"(\",\"$L13b\",\", \",\"$L13c\",\");\\n        \",\"$L13d\",\"\\n      } \",\"$L13e\",\" {\\n        diff = \",\"$L13f\",\"(\",\"$L140\",\", \",\"$L141\",\");\\n      }\\n      \",\"$L142\",\"\\n      value.\",\"$L143\",\"(\",\"$L144\",\".\",\"$L145\",\"(current + diff, \",\"$L146\",\"));\\n    },\\n    \",\"$L147\",\"\\n    state === \",\"$L148\",\" ? \",\"$L149\",\" : \",\"$L14a\",\",\\n  );\\n\\n  \",\"$L14b\",\"(\",\"$L14c\",\" {\\n    \",\"$L14d\",\" unsubscribe = value.\",\"$L14e\",\"(\",\"$L14f\",\", \",\"$L150\",\" {\\n      \",\"$L151\",\" (latest === \",\"$L152\",\") {\\n        \",\"$L153\",\"({ \",\"$L154\",\": \",\"$L155\",\" });\\n      }\\n    });\\n    \",\"$L156\",\"\\n    \",\"$L157\",\" (state === \",\"$L158\",\") {\\n      value.\",\"$L159\",\"(\",\"$L15a\",\");\\n      \",\"$L15b\",\"\\n    } \",\"$L15c\",\" \",\"$L15d\",\" (state === \",\"$L15e\",\") {\\n      value.\",\"$L15f\",\"(\",\"$L160\",\");\\n    }\\n    \",\"$L161\",\" \",\"$L162\",\" {\\n      \",\"$L163\",\"();\\n    };\\n    \",\"$L164\",\"\\n    \",\"$L165\",\"\\n  }, [value, state]);\\n\\n  \",\"$L166\",\" \",\"$L167\",\" = (\",\"$L168\",\") =\u003e {\\n    \",\"$L169\",\"({ \",\"$L16a\",\": \",\"$L16b\",\" });\\n    \",\"$L16c\",\"(\",\"$L16d\",\" {\\n      \",\"$L16e\",\"();\\n      \",\"$L16f\",\"({ \",\"$L170\",\": \",\"$L171\",\" });\\n    });\\n  };\\n\\n  \",\"$L172\",\" {\\n    state,\\n    value,\\n    \",\"$L173\",\": \",\"$L174\",\" \",\"$L175\",\"({ \",\"$L176\",\": \",\"$L177\",\" }),\\n    \",\"$L178\",\": handleProgress,\\n  };\\n}\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"2e:[\"$\",\"p\",null,{\"children\":\"정리하자면 다음과 같다.\"}]\n2f:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Progress Bar처럼 로딩을 표시하는 view 컴포넌트에 내려줄 useProgress 훅은 useReducer를 이용한 flux 패턴으로 세부 상태 관리는 감추어서 가독성을 높였다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"start, done으로 나누어져 사용하는 쪽에서 startTransition을 직접 구현해야했던 패턴에서 useProgress 훅으로 해당 훅을 숨기게 되었다.\"}],\"\\n\"]}]\n30:[\"$\",\"p\",null,{\"children\":\"사용하는 쪽에서는\"}]\n"])</script><script>self.__next_f.push([1,"31:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Link\"}],\", { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"LinkProps\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next/link\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useRouter } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next/navigation\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"MouseEventHandler\"}],\", useCallback } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useProgressBar } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"../progress-bar/progress-bar\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"LinkWithProgressProps\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"extends\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"LinkProps\"}],\" {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"?: \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"string\"}],\";\\n}\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"LinkWithProgress\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{\\n  href,\\n  className,\\n  children,\\n  ...props\\n}: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"React\"}],\".\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"PropsWithChildren\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"LinkWithProgressProps\"}],\"\u003e\"]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" { progress } = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgressBar\"}],\"();\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" router = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useRouter\"}],\"();\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handleClick\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"MouseEventHandler\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"HTMLAnchorElement\"}],\"\u003e = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"e\"}],\") =\u003e\"]}],\" {\\n      e.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"preventDefault\"}],\"();\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"progress\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" router.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"push\"}],\"(href.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"toString\"}],\"()));\\n    },\\n    [href, progress, router],\\n  );\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Link\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{href}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onClick\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handleClick}\"}],\" {\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"...props\"}],\"}\u003e\"]}],\"\\n      {children}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",\"$L179\",\"\u003e\"]}]]}],\"\\n  );\\n}\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"32:[\"$\",\"p\",null,{\"children\":\"progress에 콜백을 넘기는 것 만으로도 progress Bar와 연결될 수 있게 되었다.\"}]\n33:[\"$\",\"p\",null,{\"children\":\"기존 LinkButton 에 progress를 추가해보면 다음과 같다.\"}]\n"])</script><script>self.__next_f.push([1,"34:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"//...\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"LinkButton\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{\\n  href,\\n  children,\\n  btnStyle,\\n  btnSize,\\n  className,\\n  ...rest\\n}: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"LinkButtonProps\"}]]}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" { progress } = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgressBar\"}],\"();\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" router = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useRouter\"}],\"();\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"handleClick\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"MouseEventHandler\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"HTMLAnchorElement\"}],\"\u003e = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useCallback\"}],\"(\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"e\"}],\") =\u003e\"]}],\" {\\n      e.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"preventDefault\"}],\"();\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"progress\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" router.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"push\"}],\"(href.\",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"toString\"}],\"()));\\n    },\\n    [href, progress, router],\\n  );\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Link\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{href}\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{cn(buttonVariants({\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"btnStyle\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"btnSize\"}],\" }))}\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onClick\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{handleClick}\"}],\"\\n      {\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"...rest\"}],\"}\\n    \u003e\"]}],\"\\n      {children}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Link\"}],\"\u003e\"]}]]}],\"\\n  );\\n}\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"35:[\"$\",\"p\",null,{\"children\":\"상태 변화를 다른 함수와 함께 진행시킬 수 있는 startTransition으로 async await 처럼 사용하는 기법을 처음 보게 되었는데 자주 사용하게 될 것 같다!\"}]\n36:[\"$\",\"p\",null,{\"children\":\"useReducer를 활용한 flux 패턴으로 상태 관리를 처리하는 리팩토링을 진행하면서 코드가 간결해지는 것을 느꼈고 직접 느껴보니\"}]\n37:[\"$\",\"p\",null,{\"children\":\"복잡한 로직이 나올 때 useReducer나 zustand 같은 flux 패턴을 사용하여 구현된 기법을 사용하는 이유를 알게 되었다.\"}]\n38:[\"$\",\"p\",null,{\"children\":\"늘 느끼지만 모든 기술이 자신의 문제를 해결하기 위해 찾아볼 때 기억에 잘 새겨지는 것 같다. 이번에도 많이 배웠다.\"}]\n39:[\"$\",\"h3\",null,{\"id\":7,\"className\":\"hltr-yellow\",\"children\":\"끝이 아니었다...\"}]\n3a:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/progress%20bar%20%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81%20%EC%97%90%EB%9F%AC.gif\",\"alt\":\"\"}]}]\n3b:[\"$\",\"p\",null,{\"children\":\"리렌더링 에러 ㅎㅎ... 너무 느려서 확인해봤더니..\"}]\n3c:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240818002733.png\",\"alt\":\"\"}]}]\n3d:[\"$\",\"p\",null,{\"children\":\"progress라는 함수를 받는 컴포넌트도 progress bar로 인해서 리렌더링 되는 상황이다\"}]\n3e:[\"$\",\"p\",null,{\"children\":\"useContext는 상태를 주입하는 훅이기에 상태와 연결된 것 이외에도 하위 컴포넌트들을 리렌더링 시킨다.\"}]\n3f:[\"$\",\"p\",null,{\"children\":\"progress bar라는 상태가 빈번하게 변화하는 컴포넌트가 최상위에 있어서 리렌더링이 발생하는 것.\"}]\n40:[\"$\",\"p\",null,{\"children\":\"zustand를 이용해서 상태를 \\\"관리\\\"하여 이를 해결해보려고 했지만\"}]\n41:[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/pmndrs/zustand/discussions/885\",\"children\":\"https://github.com/pmndrs/zustand/discussions/885\"}]}]\n42:[\"$\",\"p\""])</script><script>self.__next_f.push([1,",null,{\"children\":\"useSyncExternalStore를 활용하는 zustand는 별도의 추가 없이는 startTransition과 함께 호환되지 않는다고 한다.\"}]\n43:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240828114258.png\",\"alt\":\"\"}]}]\n44:[\"$\",\"p\",null,{\"children\":\"찾아보니 zustand 개발자가 커스텀 훅을 만들어놨다.\"}]\n45:[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.npmjs.com/package/use-zustand\",\"children\":\"https://www.npmjs.com/package/use-zustand\"}]}]\n46:[\"$\",\"p\",null,{\"children\":\"이걸 사용했지만 next.js와 context api를 활용해서 연결된 방식과 결합하는 것이다 보니 개발자가 구상했었던 예외처리가 아닌 것 같았다.\"}]\n47:[\"$\",\"p\",null,{\"children\":\"구조적으로 context api를 활용해서 리렌더링을 만드는 것, zustand로 불완전한 로딩바를 만드는 것보다는 다른 방법을 생각하게 되었다.\"}]\n48:[\"$\",\"p\",null,{\"children\":\"그러다 기존 next.js를 활용한 사이트들에서 next-nprogress-bar 라는 라이브러리를 확인했다.\"}]\n49:[\"$\",\"p\",null,{\"children\":\"이는startTransition을 활용하는 방식이 아니었다. 시도해보기로 한다.\"}]\n4a:[\"$\",\"h2\",null,{\"id\":8,\"className\":\"hltr-orange\",\"children\":\"next-nprogress-bar\"}]\n4b:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-terminal\",\"children\":\"pnpm install next-nprogress-bar\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"4c:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-tsx\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"AppProgressBar\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"as\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ProgressBar\"}],\" } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next-nprogress-bar\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"Providers\"}],\" = (\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"{ children }: { children: React.ReactNode }\"}],\") =\u003e {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":\"\u003c\u003e\"}],\"\\n      {children}\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBar\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"height\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"4px\\\"\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"color\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"#fffd00\\\"\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"options\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"showSpinner:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"false\"}],\" }}\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"shallowRouting\"}],\"\\n      /\u003e\"]}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":\"\u003c/\u003e\"}]]}],\"\\n  );\\n};\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Providers\"}],\";\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"4d:[\"$\",\"s\",null,{\"children\":\"진짜 억울할 정도로 너무 쉽다 ㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠ\"}]\n4e:[\"$\",\"p\",null,{\"children\":\"html 자체에 스타일링을 줘서 작동하는 방식인 것 같았다. 여기에 시간을 너무 많이 쏟은 것 같아 라이브러리 분석은 다음에 꼭 해봐야겠다.\"}]\n4f:[\"$\",\"p\",null,{\"children\":\"이제 Link 자체에 특별한 옵션을 안 넣으면 자동으로 progress bar가 동작한다고 한다.\"}]\n50:[\"$\",\"h3\",null,{\"id\":9,\"className\":\"hltr-yellow\",\"children\":\"트러블 슈팅\"}]\n51:[\"$\",\"p\",null,{\"children\":\"Next.js에서는 SearchParams에 따른 컴포넌트 렌더링이 많다.\"}]\n52:[\"$\",\"p\",null,{\"children\":[[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/Pasted%20image%2020240914151931.png\",\"alt\":\"\"}],\"\\n(searchParams에 따라서 정렬을 다르게 하는 자유게시판 페이지의 예시)\"]}]\n53:[\"$\",\"p\",null,{\"children\":\"인기순에서 최신순으로 정렬기준을 바꿨을 때도 progress bar가 나오는데 좀더 자연스러울 것이다.\"}]\n54:[\"$\",\"p\",null,{\"children\":\"하지만 next-nprogress-bar에서는 이를 구현하지 않고 있었다.\"}]\n55:[\"$\",\"p\",null,{\"children\":\"따라서 useEffect를 활용하여 이 문제를 해결하였다.\"}]\n"])</script><script>self.__next_f.push([1,"56:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-ts\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"use client\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"AppProgressBar\"}],\", startProgress } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next-nprogress-bar\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { useSearchParams } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"next/navigation\\\"\"}],\";\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"import\"}],\" { \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ReactNode\"}],\", useEffect } \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"react\\\"\"}],\";\\n\\n\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"ProgressBarProvider\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"{\\n  children,\\n}: {\\n  children: ReactNode;\\n}\"}],\") {\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" searchParams = \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useSearchParams\"}],\"();\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"startProgress\"}],\"();\\n  }, [searchParams]);\\n\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" (\\n    \",[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":\"\u003c\u003e\"}],\"\\n      {children}\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"AppProgressBar\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"height\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"4px\\\"\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"color\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"#10b981\\\"\"}],\"\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"options\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\"\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"showSpinner:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"false\"}],\",\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"minimum:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"0.15\"}],\",\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"easing:\"}],\" \\\"\",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"ease\"}],\"\\\",\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"speed:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"500\"}],\",\\n        }}\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"shallowRouting\"}],\"\\n      /\u003e\"]}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":\"\u003c/\u003e\"}]]}],\"\\n  );\\n}\\n\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"57:[\"$\",\"p\",null,{\"children\":\"이제 정렬을 해도 progress bar가 움직이는 것을 확인할 수 있다.\"}]\n58:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/2024-09-14/progressbar%EA%B2%8C%EC%8B%9C%ED%8C%90.gif\",\"alt\":\"\"}]}]\n59:[\"$\",\"h2\",null,{\"id\":10,\"className\":\"hltr-orange\",\"children\":\"후기\"}]\n5a:[\"$\",\"p\",null,{\"children\":\"progress bar를 구현하기 위한 아이디어는 무엇이고 next.js에서는 그것을 어떻게 구현하는지를 알아보았다.\"}]\n5b:[\"$\",\"p\",null,{\"children\":\"비록 프로젝트에는 라이브러리를 활용하는 쪽으로 적용되었지만 그 과정에서 동시성 렌더링을 통해서 구현한 코드를 분석하면서 많은 것을 배웠다.\"}]\n5c:[\"$\",\"p\",null,{\"children\":\"더 성장해보자.\"}]\n5d:[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"꼼꼼 프로젝트 진행 중에 겪은 경험들입니다. 오늘도 많이 성장한 것 같아요!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"읽어주셔서 감사합니다! 지켜봐주세요!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"감사합니다.\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"5e:[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"div\"}]\n5f:[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBar\"}],\"\u003e\"]}]\n60:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n61:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":[\"`\",[\"$\",\"span\",null,{\"className\":\"hljs-subst\",\"children\":\"$${progress.value}\"}],\"%`\"]}]\n62:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\n"])</script><script>self.__next_f.push([1,"63:[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarContext.Provider\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"value\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{progress}\"}],\"\u003e\"]}],\"\\n      // 존재하는 모든 노드의 애니메이션이 완료되면 progress.reset //\\n      AnimatePresence가 progress.state가 complete된걸 감지해서 exit 애니메이션을\\n      실행시킬 수 있게 해주고 // 이후에 reset 함수가 실행된다.\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"AnimatePresence\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onExitComplete\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{progress.reset}\"}],\"\u003e\"]}],\"\\n        // 마운트시키는 상태를 progress에서 가져옴\\n        {progress.state !== \\\"complete\\\" \u0026\u0026 (\\n          \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"motion.div\"}],\"\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"style\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"width\"}],\" }}\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"exit\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"opacity:\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"0\"}],\" }}\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"className\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{className}\"}],\"\\n          /\u003e\"]}],\"\\n        )}\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"AnimatePresence\"}],\"\u003e\"]}],\"\\n      {children}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"ProgressBarContext.Provider\"}],\"\u003e\"]}]]}]\n"])</script><script>self.__next_f.push([1,"64:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// ProgressBar와 연동될 링크 컴포넌트\"}]\n65:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}]\n66:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\n67:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"ProgressBarLink\"}]\n68:[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[\"{\\n  href,\\n  children,\\n  ...rest\\n}: \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"ComponentProps\"}],\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"typeof\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Link\"}],\"\u003e\"]}]\n69:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useProgress를 context에서 꺼낸다.\"}]\n6a:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n6b:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgressBar\"}]\n6c:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n6d:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useRouter\"}]\n6e:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\n"])</script><script>self.__next_f.push([1,"6f:[\"$\",\"span\",null,{\"className\":\"xml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Link\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"href\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{href}\"}],\"\\n      \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"onClick\"}],\"=\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"{(e)\"}],\" =\u003e\"]}],\" {\\n        // 기본 동작을 삭제한다.\\n        e.preventDefault();\\n        // progress를 in-progress 상태로 만듬.\\n        progress.start();\\n        startTransition(() =\u003e {\\n          // router.push를 가장 나중 렌더링으로 바꾼다. 중간에 다른거 누르면 즉시 취소될 수 있다.\\n          router.push(href.toString());\\n          // router.push는 void가 리턴값이며 함수가 진행중인지 알 수 있는 방법이 없다. 이를 위해 transition을 사용한다.\\n          // startTransition은 내부의 함수들이 UI 렌더링 없이 한번에 업데이트 되게 해준다.\\n          // 이를 통해 router.push와 progress.done은 한번에 업데이트 되게 된다.\\n\\n          // 클릭시 progress.start라는 상태 변화는 바로 일어나지만 progress.done이라는 상태 변화는 router.push가 끝나야 진행된다.\\n          // 상태 계의 async라고 보면 될 것 같다.\\n\\n          // push가 끝나면 done으로 progress를 끝낸다. (initial이거나 in-progress면 complete으로 만듬.)\\n          progress.done();\\n        });\\n      }}\\n      {...rest}\\n    \u003e\\n      {children}\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-tag\",\"children\":[\"\u003c/\",[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Link\"}],\"\u003e\"]}]]}]\n"])</script><script>self.__next_f.push([1,"70:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useProgress (본체)\"}]\n71:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\n72:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgress\"}]\n73:[\"$\",\"span\",null,{\"className\":\"hljs-params\"}]\n74:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 현재 상태\"}]\n75:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}]\n76:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\n77:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}]\n78:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"completing\\\"\"}]\n79:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}]\n7a:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\n7b:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Spring으로 애니메이션 value 넣음.\"}]\n7c:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n7d:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useSpring\"}]\n7e:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n7f:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 반대쪽에 가해지는 힘\"}]\n80:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"damping\"}]\n81:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"25\"}]\n82:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 무기력해지는 정도\"}]\n83:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"mass\"}]\n84:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0.5\"}]\n85:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// sudden movement 정도\"}]\n86:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"stiffness\"}]\n87:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"300\"}]\n88:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 거리가 이것보다 낮아지면 애니메이션을 끝낸다.\"}]\n89:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"restDelta\"}]\n8a:[\"$\",\"span\",null,{\"classNam"])</script><script>self.__next_f.push([1,"e\":\"hljs-number\",\"children\":\"0.1\"}]\n8b:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// interval로 콜백함수를 실행시켜주는 훅\"}]\n8c:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useInterval\"}]\n8d:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n8e:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// progress를 시작하는데 bar가 complete 상태면 reset부터 한다.\"}]\n8f:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n90:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"get\"}]\n91:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"100\"}]\n92:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// motionValue를 0으로 만들어서 멈춘다.\"}]\n93:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"jump\"}]\n94:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n95:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// motionValue를 가져와서\"}]\n96:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n97:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"get\"}]\n98:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 바뀌는 정도인듯?\"}]\n99:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n9a:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 0이면 한번에 15움직이고\"}]\n9b:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n9c:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n9d:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"15\"}]\n9e:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 50 이하일때는 빠르게 움직이고\"}]\n9f:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}]\na0:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\na1:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"50\"}]\na2:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"rand\"}]\na3:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}]\na4:[\"$\","])</script><script>self.__next_f.push([1,"\"span\",null,{\"className\":\"hljs-number\",\"children\":\"10\"}]\na5:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 초과하면 1 ~ 5까지 움직인다.\"}]\na6:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}]\na7:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"rand\"}]\na8:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}]\na9:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"5\"}]\naa:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// motionValue에 추가 (최대 99)\"}]\nab:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}]\nac:[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Math\"}]\nad:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"min\"}]\nae:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"99\"}]\naf:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// in-progress 상태이면 delay (시간텀) 을 750 (0.75s) 아니면 없앰\"}]\nb0:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}]\nb1:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"750\"}]\nb2:[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}]\nb3:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}]\nb4:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\nb5:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// initia이면 0으로\"}]\nb6:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\nb7:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\nb8:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"jump\"}]\nb9:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\nba:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// completing이면 100으로 간다.\"}]\nbb:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}]\nbc:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\nbd:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"completing\\\"\"}]\nbe:[\"$\",\"span\",null,{\"className\":\"hljs-tit"])</script><script>self.__next_f.push([1,"le function_\",\"children\":\"set\"}]\nbf:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"100\"}]\nc0:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// value가 변화할 때 latest가 100이면 complete 상태로 만든다.\"}]\nc1:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\nc2:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"on\"}]\nc3:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"change\\\"\"}]\nc4:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"latest\"}],\") =\u003e\"]}]\nc5:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// on 이벤트는 motionValue를 가져올 수 있다. lastest가 motionValue임\"}]\nc6:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\nc7:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"100\"}]\nc8:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setState\"}]\nc9:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}]\nca:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// value, state, 컴포넌트 언마운트 시마다 value.on 이라는 이벤트 핸들러는 사라진다.\"}]\ncb:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\ncc:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"reset\"}]\ncd:[\"$\",\"span\",null,{\"className\":\"hljs-params\"}]\nce:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// initial로 만듬\"}]\ncf:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setState\"}]\nd0:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\nd1:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\nd2:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"start\"}]\nd3:[\"$\",\"span\",null,{\"className\":\"hljs-params\"}]\nd4:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// start로 만듬\"}]\nd5:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setState\"}]\nd6:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"chil"])</script><script>self.__next_f.push([1,"dren\":\"\\\"in-progress\\\"\"}]\nd7:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\nd8:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"done\"}]\nd9:[\"$\",\"span\",null,{\"className\":\"hljs-params\"}]\nda:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// initial이거나 in-progress면 completing아니면 원상태로 돌리는 함수\"}]\ndb:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"setState\"}]\ndc:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"state\"}],\") =\u003e\"]}]\ndd:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\nde:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}]\ndf:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"completing\\\"\"}]\ne0:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\ne1:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 랜덤하게 max와 min 사이에서 양수 하나를 꺼내는 함수\"}]\ne2:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\ne3:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"rand\"}]\ne4:[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"min\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"number\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"max\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"number\"}]]}]\ne5:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\ne6:[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Math\"}]\ne7:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"floor\"}]\ne8:[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Math\"}]\ne9:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"random\"}]\nea:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}]\neb:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// useInterval: callback과 delay를 받으"])</script><script>self.__next_f.push([1,"면 interval을 주는 함수\"}]\nec:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\ned:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useInterval\"}]\nee:[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"callback\"}],\": () =\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"delay\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"number\"}],\" | \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}]]}]\nef:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// callback을 저장하는 클로저\"}]\nf0:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}]\nf1:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useRef\"}]\nf2:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}]\nf3:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\nf4:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// callback을 변경하는 함수\"}]\nf5:[\"$\",\"span\",null,{\"className\":\"hljs-property\",\"children\":\"current\"}]\nf6:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}]\nf7:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\nf8:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// ref에 담긴 callback 실행하는 함수\"}]\nf9:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\nfa:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"tick\"}]\nfb:[\"$\",\"span\",null,{\"className\":\"hljs-params\"}]\nfc:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"current\"}]\nfd:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\nfe:[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}]\nff:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 일단 실행\"}]\n100:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"tick\"}]\n101:[\"$\",\"span\",null,{\"className\":\"hljs-comment"])</script><script>self.__next_f.push([1,"\",\"children\":\"// 타이머 켜라\"}]\n102:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n103:[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"setInterval\"}]\n104:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 언마운트 될 때 타이머 지워라\"}]\n105:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\n106:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n107:[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"clearInterval\"}]\n108:[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Error\"}]\n109:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"Unhandled action type\\\"\"}]\n"])</script><script>self.__next_f.push([1,"10a:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":[\"/**\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@author\"}],\" 이승현\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@description\"}],\"\\n * progress 내부 로직이 담긴 훅입니다.\\n *\\n * progress bar와 같이 표시해주는 컴포넌트(view)를 만드시려면 state, value, reset 를 사용하시면 됩니다.\\n * 자세한 구현 사항은 progress bar를 참고해주세요\\n *\\n * progress bar와 같은 컴포넌트와 연결되어 있는 컴포넌트를 만드시고 싶으시면 이 훅이 아닌 \\\"useProgressBar\\\"의\\n * progress 함수를 사용하시면 됩니다.\\n *\\n * \",[\"$\",\"span\",null,{\"className\":\"hljs-doctag\",\"children\":\"@example\"}],\"\\n * export function ProgressBar({\\n  className,\\n  children,\\n}: {\\n  className: string;\\n  children: ReactNode;\\n}) {\\n  // useProgress 사용\\n  let progress = useProgress();\\n  // useMotionTemplate: 여러 motion value를 하나의 motion value로 만드는 훅\\n  // 여기서는 width: ~% 이런식으로 길어지게 만들어 놓음. 내부적으로 progress.value가 100이 되면 complete임\\n  let width = useMotionTemplate`${progress.value}%`;\\n\\n  return (\\n    \u003cProgressBarContext.Provider value={progress}\u003e\\n      \u003cAnimatePresence onExitComplete={progress.reset}\u003e\\n        {progress.state !== \\\"complete\\\" \u0026\u0026 (\\n          \u003cmotion.div\\n            style={{ width }}\\n            exit={{ opacity: 0 }}\\n            className={className}\\n          /\u003e\\n        )}\\n      \u003c/AnimatePresence\u003e\\n      {children}\\n    \u003c/ProgressBarContext.Provider\u003e\\n  );\\n}\\n *\\n */\"]}]\n"])</script><script>self.__next_f.push([1,"10b:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"export\"}]\n10c:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}]\n10d:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useProgress\"}]\n10e:[\"$\",\"span\",null,{\"className\":\"hljs-params\"}]\n10f:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 현재 상태\"}]\n110:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}]\n111:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useReducer\"}]\n112:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\n113:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// Spring으로 애니메이션 value 넣음.\"}]\n114:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n115:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useSpring\"}]\n116:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n117:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 반대쪽에 가해지는 힘\"}]\n118:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"damping\"}]\n119:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"25\"}]\n11a:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 무기력해지는 정도\"}]\n11b:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"mass\"}]\n11c:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0.5\"}]\n11d:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// sudden movement 정도\"}]\n11e:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"stiffness\"}]\n11f:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"300\"}]\n120:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 거리가 이것보다 낮아지면 애니메이션을 끝낸다.\"}]\n121:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"restDelta\"}]\n122:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0.1\"}]\n123:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// interval로 콜백함수를 실행시켜주는 훅\"}]\n124:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"chi"])</script><script>self.__next_f.push([1,"ldren\":\"useInterval\"}]\n125:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n126:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// progress를 시작하는데 bar가 complete 상태면 reset부터 한다.\"}]\n127:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n128:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"get\"}]\n129:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"100\"}]\n12a:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// motionValue를 0으로 만들어서 멈춘다.\"}]\n12b:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"jump\"}]\n12c:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n12d:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// motionValue를 가져와서\"}]\n12e:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n12f:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"get\"}]\n130:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 바뀌는 정도인듯?\"}]\n131:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"let\"}]\n132:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 0이면 한번에 15움직이고\"}]\n133:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n134:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n135:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"15\"}]\n136:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 50 이하일때는 빠르게 움직이고\"}]\n137:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}]\n138:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n139:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"50\"}]\n13a:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"rand\"}]\n13b:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}]\n13c:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"10\"}]\n13d:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// 초과하면 1 ~ 5까지 움직인다.\"}]\n13e:[\"$\",\"span\",null,{\"cla"])</script><script>self.__next_f.push([1,"ssName\":\"hljs-keyword\",\"children\":\"else\"}]\n13f:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"rand\"}]\n140:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}]\n141:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"5\"}]\n142:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// motionValue에 추가 (최대 99)\"}]\n143:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}]\n144:[\"$\",\"span\",null,{\"className\":\"hljs-title class_\",\"children\":\"Math\"}]\n145:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"min\"}]\n146:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"99\"}]\n147:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// in-progress 상태이면 delay (시간텀) 을 750 (0.75s) 아니면 없앰\"}]\n148:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"in-progress\\\"\"}]\n149:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"750\"}]\n14a:[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"null\"}]\n14b:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"useEffect\"}]\n14c:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n14d:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}]\n14e:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"on\"}]\n14f:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"change\\\"\"}]\n150:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":[\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"latest\"}],\") =\u003e\"]}]\n151:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n152:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"100\"}]\n153:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"dispatch\"}]\n154:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}]\n155:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"complete\\\"\"}]\n156:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// initial이면 0으로\"}]\n157:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n158:[\"$\",\"span\",null"])</script><script>self.__next_f.push([1,",{\"className\":\"hljs-string\",\"children\":\"\\\"initial\\\"\"}]\n159:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"jump\"}]\n15a:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}]\n15b:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// completing이면 100으로 간다.\"}]\n15c:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"else\"}]\n15d:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}]\n15e:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"completing\\\"\"}]\n15f:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"set\"}]\n160:[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"100\"}]\n161:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\n162:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n163:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"unsubscribe\"}]\n164:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// value가 변화할 때 latest가 100이면 complete 상태로 만든다.\"}]\n165:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// value, state 변화, 컴포넌트 언마운트 시마다 value.on 이라는 이벤트 핸들러는 사라진다.\"}]\n166:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"const\"}]\n167:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"handleProgress\"}]\n168:[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"func\"}],\": () =\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-built_in\",\"children\":\"void\"}]]}]\n169:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"dispatch\"}]\n16a:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}]\n16b:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"start\\\"\"}]\n16c:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"startTransition\"}]\n16d:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n16e:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"func\"}]\n16f:[\"$\",\"span\",null,{\"classNam"])</script><script>self.__next_f.push([1,"e\":\"hljs-title function_\",\"children\":\"dispatch\"}]\n170:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}]\n171:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"done\\\"\"}]\n172:[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"return\"}]\n173:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"reset\"}]\n174:[\"$\",\"span\",null,{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}]\n175:[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"dispatch\"}]\n176:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"type\"}]\n177:[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"reset\\\"\"}]\n178:[\"$\",\"span\",null,{\"className\":\"hljs-attr\",\"children\":\"progress\"}]\n179:[\"$\",\"span\",null,{\"className\":\"hljs-name\",\"children\":\"Link\"}]\n"])</script></body></html>